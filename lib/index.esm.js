var t,e;!function(t){t[t.Pointer=0]="Pointer",t[t.Keyboard=1]="Keyboard"}(t||(t={}));class i{constructor(t,e,i){this.target=t,this.focusType=e,this.needsFocus=i}}class s extends i{constructor(t,e,i=null,s=null){super(i,s,!1),this.x=t,this.y=e}}class n extends s{constructor(e,i,s=null){super(e,i,s,t.Pointer)}correctOffset(t,e){return new n(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new n(this.x,this.y,t)}}class r extends s{constructor(t,e,i=null){super(t,e,i)}correctOffset(t,e){return new r(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new r(this.x,this.y,t)}}class l extends i{constructor(e=null){super(e,t.Pointer,!0)}cloneWithTarget(t){return new l(t)}}!function(t){t[t.Released=0]="Released",t[t.Hover=1]="Hover",t[t.Hold=2]="Hold"}(e||(e={}));class h{constructor(t){this.widget=t,this.lastClickState=e.Released,this.clickState=e.Released,this.clickStateChanged=!1,this.wasClick=!1,this.pointerPos=null,this.startingPointerPos=null}getNormalInRect(t,e,i,s,n,r){return[(t-i)/(s-i),(e-n)/(r-n)]}isPointInRect(t,e,i,s,n,r){return t>=i&&t<s&&e>=n&&e<r}isNormalInRect(t,e){return t>=0&&t<1&&e>=0&&e<1}setClickState(t,i){this.clickState!==t?(this.lastClickState=this.clickState,this.clickState=t,this.wasClick=i&&this.lastClickState===e.Hold,this.clickStateChanged=!0):this.clickStateChanged=!1}handleClickEvent(i,h,o){if(i instanceof l)return h.dropFocus(t.Pointer,this.widget),this.pointerPos=null,this.setClickState(e.Released,!1);if(i instanceof s){this.pointerPos=this.getNormalInRect(i.x,i.y,...o);const s=this.isNormalInRect(...this.pointerPos);if(s)h.pointerStyle="pointer";else if(null===i.target)return h.dropFocus(t.Pointer,this.widget),this.setClickState(e.Released,!1);return i instanceof r?(this.startingPointerPos=this.pointerPos,h.requestFocus(t.Pointer,this.widget),this.setClickState(e.Hold,s)):i instanceof n?(h.dropFocus(t.Pointer,this.widget),s?this.setClickState(e.Hover,s):this.setClickState(e.Released,s)):null===i.target?this.setClickState(e.Hover,s):this.setClickState(e.Hold,s)}this.clickStateChanged=!1}}let o=null;const a=new Map;function c(t,e){if(""===t)return[0,0,0];if(null===o){const t=document.createElement("canvas");if(o=t.getContext("2d"),null===o)throw"Failed to get canvas context"}let i;if(o.font=e,a.has(e))i=a.get(e);else{const t=o.measureText("-");i=Math.abs(t.actualBoundingBoxLeft)+Math.abs(t.actualBoundingBoxRight),a.set(e,i)}const s=o.measureText("-"+t+"-");return[Math.abs(s.actualBoundingBoxLeft)+Math.abs(s.actualBoundingBoxRight)-2*i,Math.abs(s.actualBoundingBoxAscent),Math.abs(s.actualBoundingBoxDescent)]}class u{constructor(){this._text="",this._font="",this._minWidth=0,this._minAscent=0,this._minDescent=0,this._width=0,this._ascent=0,this._descent=0,this.measureDirty=!0,this._dirty=!1}get dirty(){const t=this._dirty;return this._dirty=!1,t}updateTextDims(){if(!this.measureDirty)return;const[t,e,i]=c(this._text,this._font);this._width=Math.max(t,this._minWidth),this._ascent=Math.max(e,this._minAscent),this._descent=Math.max(i,this._minDescent),this.measureDirty=!1}findOffsetFromIndex(t){return t<=0?0:c(this._text.substring(0,t),this._font)[0]}findIndexOffsetFromOffset(t){if(t<=0)return[0,0];let e=0,i="",s=0;for(const n of this._text){i+=n;const r=c(i,this._font)[0];if(t<(r+s)/2)return[e,s];e++,s=r}return[this._text.length,s]}setDirty(){this._dirty=!0,this.measureDirty=!0}get width(){return this.updateTextDims(),this._width}get ascent(){return this.updateTextDims(),this._ascent}get descent(){return this.updateTextDims(),this._descent}get height(){return this.updateTextDims(),this._ascent+this._descent}set text(t){this._text!==t&&(this._text=t,this.setDirty())}get text(){return this._text}set font(t){this._font!==t&&(this._font=t,this.setDirty())}get font(){return this._font}set minWidth(t){this._minWidth!==t&&(this._minWidth=t,this.setDirty())}get minWidth(){return this._minWidth}set minAscent(t){this._minAscent!==t&&(this._minAscent=t,this.setDirty())}get minAscent(){return this._minAscent}set minDescent(t){this._minDescent!==t&&(this._minDescent=t,this.setDirty())}get minDescent(){return this._minDescent}}class d{constructor(t,e=null){this.callback=e,this._dirty=!1,this._value=t}get value(){return this._value}set value(t){this.setValue(t)}get dirty(){const t=this._dirty;return this._dirty=!1,t}setValue(t,e=!0){if(this._value!==t&&(this._value=t,this._dirty=!0,e&&null!==this.callback))try{this.callback(t)}catch(t){console.error("Exception in Variable callback",t)}}}function p(t){return new Promise(((e,i)=>{function s(){document.body.removeChild(l),document.body.removeChild(r)}function n(){s(),e(o.value)}const r=document.createElement("div");r.id="textInputHandlerOverlay";const l=document.createElement("div");l.id="textInputHandler";const h=document.createElement("p");h.textContent="Change text:";const o=document.createElement("input");o.addEventListener("keyup",(function(t){"Enter"==t.key&&(t.preventDefault(),n())})),o.value=t;const a=document.createElement("div"),c=document.createElement("button");c.addEventListener("click",(function(){s(),e(t)})),c.textContent="Cancel";const u=document.createElement("button");u.addEventListener("click",n),u.textContent="OK",a.appendChild(c),a.appendChild(u),l.appendChild(h),l.appendChild(o),l.appendChild(a),document.body.appendChild(r),document.body.appendChild(l),o.focus({preventScroll:!1})}))}var v,m;!function(t){t[t.CanvasFill=0]="CanvasFill",t[t.ContainerPadding=1]="ContainerPadding",t[t.ContainerSpacing=2]="ContainerSpacing",t[t.ContainerAlignment=3]="ContainerAlignment",t[t.PrimaryFill=4]="PrimaryFill",t[t.AccentFill=5]="AccentFill",t[t.BackgroundFill=6]="BackgroundFill",t[t.BackgroundGlowFill=7]="BackgroundGlowFill",t[t.SliderFlexRatio=8]="SliderFlexRatio",t[t.SliderMainBasis=9]="SliderMainBasis",t[t.SliderCrossBasis=10]="SliderCrossBasis",t[t.BodyTextFont=11]="BodyTextFont",t[t.BodyTextFill=12]="BodyTextFill",t[t.LabelMinWidth=13]="LabelMinWidth",t[t.LabelMinAscent=14]="LabelMinAscent",t[t.LabelMinDescent=15]="LabelMinDescent",t[t.CheckboxLength=16]="CheckboxLength",t[t.CheckboxInnerPadding=17]="CheckboxInnerPadding",t[t.InputBackgroundFill=18]="InputBackgroundFill",t[t.InputTextFont=19]="InputTextFont",t[t.InputTextFill=20]="InputTextFill",t[t.InputTextFillDisabled=21]="InputTextFillDisabled",t[t.InputTextFillInvalid=22]="InputTextFillInvalid",t[t.InputTextFlexRatio=23]="InputTextFlexRatio",t[t.InputTextMinWidth=24]="InputTextMinWidth",t[t.InputTextMinAscent=25]="InputTextMinAscent",t[t.InputTextMinDescent=26]="InputTextMinDescent",t[t.BlinkRate=27]="BlinkRate",t[t.CursorPadding=28]="CursorPadding",t[t.CursorThickness=29]="CursorThickness",t[t.ScrollBarThickness=30]="ScrollBarThickness"}(v||(v={})),function(t){t[t.Stretch=0]="Stretch",t[t.Start=1]="Start",t[t.Center=2]="Center",t[t.End=3]="End"}(m||(m={}));const g=new Map([[v.CanvasFill,"rgba(0,0,0,0.5)"],[v.ContainerPadding,{left:4,right:4,top:4,bottom:4}],[v.ContainerAlignment,{horizontal:m.Start,vertical:m.Start}],[v.ContainerSpacing,4],[v.PrimaryFill,"rgb(0,127,255)"],[v.AccentFill,"rgb(0,195,255)"],[v.BackgroundFill,"rgb(32,32,32)"],[v.BackgroundGlowFill,"rgb(48,48,48)"],[v.SliderFlexRatio,1],[v.SliderMainBasis,100],[v.SliderCrossBasis,10],[v.BodyTextFont,"16px sans"],[v.BodyTextFill,"white"],[v.LabelMinWidth,0],[v.LabelMinAscent,0],[v.LabelMinDescent,3],[v.CheckboxLength,12],[v.CheckboxInnerPadding,2],[v.InputBackgroundFill,"white"],[v.InputTextFont,"16px mono"],[v.InputTextFill,"black"],[v.InputTextFillDisabled,"grey"],[v.InputTextFillInvalid,"red"],[v.InputTextFlexRatio,1],[v.InputTextMinWidth,100],[v.InputTextMinAscent,16],[v.InputTextMinDescent,3],[v.BlinkRate,.8],[v.CursorPadding,2],[v.CursorThickness,2],[v.ScrollBarThickness,10]]);class f{constructor(t=null,e=null){this.properties=null===t?new Map(g):t,this.fallback=e}getProperty(t){let e=this.properties.get(t);if(void 0===e){if(null===this.fallback)throw new Error(`Theme property ${t} is not available`);e=this.fallback.getProperty(t)}return e}getString(t){const e=this.getProperty(t);if("string"!=typeof e)throw new Error(`Theme property ${t} is not a string`);return e}getNumber(t){const e=this.getProperty(t);if("number"!=typeof e)throw new Error(`Theme property ${t} is not a number`);return e}getPadding(t){return this.getProperty(t)}getAlignment(t){return this.getProperty(t)}getAlignment2D(t){return this.getProperty(t)}getFill(t){return this.getString(t)}getFont(t){return this.getString(t)}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function y(t,e,i,s){return new(i||(i=Promise))((function(n,r){function l(t){try{o(s.next(t))}catch(t){r(t)}}function h(t){try{o(s.throw(t))}catch(t){r(t)}}function o(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(l,h)}o((s=s.apply(t,e||[])).next())}))}function x(t,e=!0){const i=e?Math.ceil:Math.floor;return Math.pow(2,i(Math.log2(t)))}class _{constructor(t,e,i){this.hBasis=0,this.vBasis=0,this.hFlex=0,this.vFlex=0,this.sizeChanged=!1,this.maxWidth=t,this.maxHeight=e,this.vertical=i}clone(){const t=new _(this.maxWidth,this.maxHeight,this.vertical);return t.hBasis=this.hBasis,t.vBasis=this.vBasis,t.hFlex=this.hFlex,t.vFlex=this.vFlex,t}addBasis(t,e){this.vertical?(this.vBasis+=e,t>this.hBasis&&(this.hBasis=t)):(this.hBasis+=t,e>this.vBasis&&(this.vBasis=e))}}class b{constructor(t=64,e=64){this._maxDimensions=[0,0],this.forceLayout=!1,this.vertical=!0,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e;const i=this.canvas.getContext("2d",{alpha:!0});if(null===i)throw"Failed to get canvas context";this.context=i}get canvasDimensions(){return[this.canvas.width,this.canvas.height]}set maxDimensions(t){this._maxDimensions[0]===t[0]&&this._maxDimensions[1]===t[1]||(this._maxDimensions[0]=t[0],this._maxDimensions[1]=t[1],this.forceLayout=!0)}get maxDimensions(){return[this._maxDimensions[0],this._maxDimensions[1]]}populateChildsLayout(t){if(this.forceLayout&&(this.forceLayout=!1,t.forceLayoutDirty()),!t.layoutDirty)return null;const e=new _(this._maxDimensions[0],this._maxDimensions[1],this.vertical);return t.populateLayout(e),e}resolveChildsLayout(t,e){if(!t.layoutDirty||null===e)return!1;const[i,s]=t.dimensions;t.resolveLayout(e);const[n,r]=t.dimensions;let l=!1;if(n!==i||r!==s){const t=x(n);t>this.canvas.width&&(this.canvas.width=t);const e=x(r);e>this.canvas.height&&(this.canvas.height=e),l=!0}return(e.sizeChanged||l)&&t.forceLayoutDirty(),l}paintToCanvas(t){const e=t.dirty;return e&&t.paint(0,0,...t.dimensions,this.context),e}}class C{constructor(e,i=null,s=new f){this.drivers=new Set,this._enabled=!0,this.pointerStyle="default",this._currentPointerStyle="default",this._foci=new Map([[t.Keyboard,null],[t.Pointer,null]]),this._fociCapturers=new Map([[t.Keyboard,null],[t.Pointer,null]]),this.textInputHandler=null,this._mobileTextInUse=!1,this.viewport=new b,this.child=e,this.pointerStyleHandler=i,this.child.inheritedTheme=s}get maxDimensions(){return this.viewport.maxDimensions}set maxDimensions(t){this.viewport.maxDimensions=t}get canvasDimensions(){return this.viewport.canvasDimensions}get dimensions(){return this.child.dimensions}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t)if(this._enabled=t,t)for(const t of this.drivers)t.onEnable(this);else{for(const t of this.drivers)t.onDisable(this);this.updatePointerStyle("default");for(const t of this._foci.keys())this.clearFocus(t)}}get canvas(){return this.viewport.canvas}resolveLayout(){if(!this.enabled)return!1;const t=this.viewport.populateChildsLayout(this.child);return this.viewport.resolveChildsLayout(this.child,t)}paint(){return!!this.enabled&&this.viewport.paintToCanvas(this.child)}dispatchEvent(e){var i;if(!this.enabled)return;if(null!==e.focusType&&null===e.target){let t=this._foci.get(e.focusType);if(void 0===t&&(t=null),e.needsFocus&&null===t)return;e=e.cloneWithTarget(t)}this.pointerStyle="default";const[s,n]=this.dimensions,r=this.child.dispatchEvent(e,s,n,this);if(null===r&&null!==e.focusType&&this.clearFocus(e.focusType),null===e.focusType)return;const h=null!==(i=this._fociCapturers.get(e.focusType))&&void 0!==i?i:null;if(h!==r){e.focusType===t.Pointer&&null!==h&&this.child.dispatchEvent(new l(h),s,n,this),this._fociCapturers.set(e.focusType,r);for(const t of this.drivers)t.onFocusCapturerChanged(this,e.focusType,h,r)}}preLayoutUpdate(){if(this.enabled){for(const t of this.drivers)t.update(this);this.child.preLayoutUpdate(this)}}postLayoutUpdate(){this.enabled&&(this.child.postLayoutUpdate(this),this.updatePointerStyle())}updatePointerStyle(t=null){null!==t&&(this.pointerStyle=t),this.pointerStyle!==this._currentPointerStyle&&(this._currentPointerStyle=this.pointerStyle,null!==this.pointerStyleHandler&&this.pointerStyleHandler(this._currentPointerStyle))}requestFocus(t,e){if(null!==e){if(e!==this._foci.get(t)){this.clearFocus(t),this._foci.set(t,e);for(const i of this.drivers)i.onFocusChanged(this,t,e)}}}dropFocus(t,e){e===this._foci.get(t)&&this.clearFocus(t)}clearFocus(t){const e=this._foci.get(t);if(null!=e){e.onFocusDropped(t,this),this._foci.set(t,null);for(const e of this.drivers)e.onFocusChanged(this,t,null)}}getFocus(t){var e;return null!==(e=this._foci.get(t))&&void 0!==e?e:null}getFocusCapturer(t){var e;return null!==(e=this._fociCapturers.get(t))&&void 0!==e?e:null}registerDriver(t){this.drivers.has(t)||(this.drivers.add(t),this._enabled&&t.onEnable&&t.onEnable(this))}unregisterDriver(t){this.drivers.delete(t)&&this._enabled&&t.onDisable&&t.onDisable(this)}clearDrivers(){for(const t of this.drivers)this.unregisterDriver(t)}get hasMobileTextInput(){return null!==this.textInputHandler&&!this._mobileTextInUse}get usingMobileTextInput(){return this._mobileTextInUse}getTextInput(t=""){return y(this,void 0,void 0,(function*(){if(null!==this.textInputHandler&&!this._mobileTextInUse){this._mobileTextInUse=!0;const e=yield this.textInputHandler(t);return this._mobileTextInUse=!1,e}return null}))}}class w extends C{constructor(t,e=new f){super(t,null,e),this.domElem=document.createElement("canvas"),this.domElem.tabIndex=1,[this.domElem.width,this.domElem.height]=this.dimensions;const i=this.domElem.getContext("2d",{alpha:!0});if(null===i)throw"Failed to get DOM canvas context";this.domCanvasContext=i,this.pointerStyleHandler=t=>{this.domElem.style.cursor=t}}update(){this.enabled?(this.domElem.style.removeProperty("display"),this.preLayoutUpdate(),this.resolveLayout()&&([this.domElem.width,this.domElem.height]=this.dimensions),this.postLayoutUpdate(),this.paint()&&(this.domCanvasContext.globalCompositeOperation="copy",this.domCanvasContext.drawImage(this.canvas,0,0))):this.domElem.style.display="none"}}const k=(t,e,i=[])=>{const s=Object.getOwnPropertyDescriptors(e);for(let t of i)delete s[t];Object.defineProperties(t,s)},B=(t,e=[t])=>{const i=Object.getPrototypeOf(t);return null===i?e:B(i,[...e,i])},P=(t,e,i=[])=>{var s;const n=null!==(s=((...t)=>{if(0===t.length)return;let e;const i=t.map((t=>B(t)));for(;i.every((t=>t.length>0));){const t=i.map((t=>t.pop())),s=t[0];if(!t.every((t=>t===s)))break;e=s}return e})(...t))&&void 0!==s?s:Object.prototype,r=Object.create(n),l=B(n);for(let e of t){let t=B(e);for(let e=t.length-1;e>=0;e--){let s=t[e];-1===l.indexOf(s)&&(k(r,s,["constructor",...i]),l.push(s))}}return r.constructor=e,r},L=t=>t.filter(((e,i)=>t.indexOf(e)==i)),D=new Map,H=t=>D.get(t),F=(t,e)=>{var i,s;const n=L([...Object.getOwnPropertyNames(t),...Object.getOwnPropertyNames(e)]),r={};for(let l of n)r[l]=L([...null!==(i=null==t?void 0:t[l])&&void 0!==i?i:[],...null!==(s=null==e?void 0:e[l])&&void 0!==s?s:[]]);return r},T=(t,e)=>{var i,s,n,r;return{property:F(null!==(i=null==t?void 0:t.property)&&void 0!==i?i:{},null!==(s=null==e?void 0:e.property)&&void 0!==s?s:{}),method:F(null!==(n=null==t?void 0:t.method)&&void 0!==n?n:{},null!==(r=null==e?void 0:e.method)&&void 0!==r?r:{})}},S=new Map,M=(...t)=>{const e=((...t)=>{var e;const i=new Set,s=new Set([...t]);for(;s.size>0;)for(let t of s){const n=[...B(t.prototype).map((t=>t.constructor)),...null!==(e=H(t))&&void 0!==e?e:[]].filter((t=>!i.has(t)));for(let t of n)s.add(t);i.add(t),s.delete(t)}return[...i]})(...t).map((t=>S.get(t))).filter((t=>!!t));return 0==e.length?{}:1==e.length?e[0]:e.reduce(((t,e)=>((t,e)=>{var i,s,n,r,l,h;return{class:L([...null!==(i=null==t?void 0:t.class)&&void 0!==i?i:[],...null!==(s=null==e?void 0:e.class)&&void 0!==s?s:[]]),static:T(null!==(n=null==t?void 0:t.static)&&void 0!==n?n:{},null!==(r=null==e?void 0:e.static)&&void 0!==r?r:{}),instance:T(null!==(l=null==t?void 0:t.instance)&&void 0!==l?l:{},null!==(h=null==e?void 0:e.instance)&&void 0!==h?h:{})}})(t,e)))};function E(...t){var e,i,s;const n=t.map((t=>t.prototype));function r(...e){for(const i of t)k(this,new i(...e))}r.prototype=P(n,r),Object.setPrototypeOf(r,P(t,null,["prototype"]));let l=r;{const n=M(...t);for(let t of null!==(e=null==n?void 0:n.class)&&void 0!==e?e:[])l=t(l);I(null!==(i=null==n?void 0:n.static)&&void 0!==i?i:{},l),I(null!==(s=null==n?void 0:n.instance)&&void 0!==s?s:{},l.prototype)}var h,o;return h=l,o=t,D.set(h,o),l}const I=(t,e)=>{const i=t.property,s=t.method;if(i)for(let t in i)for(let s of i[t])s(e,t);if(s)for(let t in s)for(let i of s[t])i(e,t,Object.getOwnPropertyDescriptor(e,t))};class R{constructor(t,e,i){this._enabled=!0,this._dirty=!0,this._layoutDirty=!0,this._theme=null,this._inheritedTheme=null,this.resolvedWidth=0,this.resolvedHeight=0,this.needsClear=e,this.propagatesEvents=i,this._themeOverride=t}updateInheritedTheme(){}updateTheme(){null===this._themeOverride?this._theme=this._inheritedTheme:(this._themeOverride.fallback=this._inheritedTheme,this._theme=this._themeOverride)}get theme(){if(null===this._theme)throw"Widget theme is not ready";return this._theme}set enabled(t){t!==this._enabled&&(this._enabled=t,this._dirty=t,this._layoutDirty=!0)}get enabled(){return this._enabled}setThemeOverride(t){this._themeOverride!==t&&(this._themeOverride=t,this.updateTheme(),this._enabled&&(this._layoutDirty=!0,this._dirty=!0))}set themeOverride(t){this.setThemeOverride(t)}get themeOverride(){return this._themeOverride}inheritTheme(t){this._inheritedTheme!==t&&(this._inheritedTheme=t,this.updateInheritedTheme(),this.updateTheme(),this._enabled&&(this._layoutDirty=!0,this._dirty=!0))}set inheritedTheme(t){this.inheritTheme(t)}get inheritedTheme(){return this._inheritedTheme}get dimensions(){return[this.resolvedWidth,this.resolvedHeight]}get dirty(){return this._dirty}get layoutDirty(){return this._layoutDirty}onFocusDropped(t,e){}handleEvent(t,e,i,n){return t.target===this||t instanceof s&&null===t.target?this:null}dispatchEvent(t,e,i,n){if(!this._enabled)return null;if(null===t.target){if(t instanceof s&&(t.x<0||t.y<0||t.x>=e||t.y>=i))return null}else if(t.target!==this&&!this.propagatesEvents)return null;return this.handleEvent(t,e,i,n)}handlePreLayoutUpdate(t){}preLayoutUpdate(t){this._enabled&&this.handlePreLayoutUpdate(t)}handlePopulateLayout(t){throw"Widget.handlePopulateLayout must be implemented"}handleResolveLayout(t){throw"Widget.handleResolveLayout must be implemented"}populateLayout(t){this._enabled&&this.handlePopulateLayout(t)}resolveLayout(t){if(!this._enabled)return this.resolvedWidth=0,this.resolvedHeight=0,void(this._layoutDirty=!1);if(this._layoutDirty){const e=this.resolvedWidth,i=this.resolvedHeight;this.handleResolveLayout(t),this._layoutDirty=!1,e===this.resolvedWidth&&i===this.resolvedHeight||(this._dirty=!0)}}forceLayoutDirty(){this._layoutDirty=!0,this._dirty=!0}handlePostLayoutUpdate(t){}postLayoutUpdate(t){this._enabled&&this.handlePostLayoutUpdate(t)}clear(t,e,i,s,n){n.save(),n.globalCompositeOperation="copy",n.fillStyle=this.theme.getFill(v.CanvasFill),n.beginPath(),n.rect(Math.trunc(t),Math.trunc(e),Math.ceil(i),Math.ceil(s)),n.clip(),n.fill(),n.restore()}handlePainting(t,e,i,s,n){}paint(t,e,i,s,n){this._dirty&&(this._enabled&&(this.needsClear&&this.clear(t,e,i,s,n),n.save(),this.handlePainting(t,e,i,s,n),n.restore()),this._dirty=!1)}}class W extends R{constructor(t,e,i,s){super(e,i,s),this._children=[...t]}updateInheritedTheme(){const t=this.inheritedTheme;if(null!==t)for(const e of this.children)e.inheritedTheme=t}forceLayoutDirty(){if(super.forceLayoutDirty(),this.enabled&&null!==this._children)for(const t of this.children)t.forceLayoutDirty()}get childCount(){return this._children.length}get children(){return this._children.values()}}class O extends W{constructor(t,e,i,s){super([t],e,i,s)}get child(){return this._children[0]}}class U extends R{constructor(){super(...arguments),this._flexRatio=1,this._mainBasis=0,this._crossBasis=0,this._internalMainBasis=0,this._internalCrossBasis=0,this._effectiveMainBasis=0,this._effectiveCrossBasis=0,this._vertical=null,this.lastVertical=!0}get flexRatio(){return this._flexRatio}set flexRatio(t){this._flexRatio!==t&&(this._flexRatio=t,this._layoutDirty=!0)}get vertical(){return this._vertical}set vertical(t){this._vertical!==t&&(this._vertical=t,this._layoutDirty=!0)}get mainBasis(){return this._mainBasis}set mainBasis(t){this._mainBasis!==t&&(this._mainBasis=t,this.updateEffectiveMainBasis())}get crossBasis(){return this._crossBasis}set crossBasis(t){this._crossBasis!==t&&(this._crossBasis=t,this.updateEffectiveCrossBasis())}get internalMainBasis(){return this._internalMainBasis}set internalMainBasis(t){this._internalMainBasis!==t&&(this._internalMainBasis=t,this.updateEffectiveMainBasis())}get internalCrossBasis(){return this._internalCrossBasis}set internalCrossBasis(t){this._internalCrossBasis!==t&&(this._internalCrossBasis=t,this.updateEffectiveCrossBasis())}updateEffectiveMainBasis(){const t=Math.max(this._mainBasis,this._internalMainBasis);this._effectiveMainBasis!==t&&(this._effectiveMainBasis=t,this._layoutDirty=!0)}updateEffectiveCrossBasis(){const t=Math.max(this._crossBasis,this._internalCrossBasis);this._effectiveCrossBasis!==t&&(this._effectiveCrossBasis=t,this._layoutDirty=!0)}handlePopulateLayout(t){var e;const i=null!==(e=this.vertical)&&void 0!==e?e:t.vertical;this.lastVertical=i,t.vertical===i?i?(this._flexRatio>0&&(t.vFlex+=this._flexRatio),t.vBasis+=this._effectiveMainBasis,this._effectiveCrossBasis>t.hBasis&&(t.hBasis=this._effectiveCrossBasis)):(this._flexRatio>0&&(t.hFlex+=this._flexRatio),t.hBasis+=this._effectiveMainBasis,this._effectiveCrossBasis>t.vBasis&&(t.vBasis=this._effectiveCrossBasis)):i?(t.hBasis+=this._effectiveCrossBasis,this._effectiveMainBasis>t.vBasis&&(t.vBasis=this._effectiveMainBasis)):(t.vBasis+=this._effectiveCrossBasis,this._effectiveMainBasis>t.hBasis&&(t.hBasis=this._effectiveMainBasis))}handleResolveLayout(t){var e;let i;const s=null!==(e=this.vertical)&&void 0!==e?e:t.vertical;t.vertical!==s?this._flexRatio>0?(i=s?t.maxHeight:t.maxWidth,i=Math.max(i,this._effectiveMainBasis)):i=this._effectiveMainBasis:this._flexRatio>0?(i=s?(t.maxHeight-t.vBasis)*this._flexRatio/t.vFlex:(t.maxWidth-t.hBasis)*this._flexRatio/t.hFlex,i=this._effectiveMainBasis+Math.max(0,i)):i=this._effectiveMainBasis,s?(this.resolvedWidth=this._effectiveCrossBasis,this.resolvedHeight=i):(this.resolvedWidth=i,this.resolvedHeight=this._effectiveCrossBasis)}}class N extends(E(U,O)){constructor(t,e,i=1,s=0,n=0,r=null,l=null){super(t,l,!1,e),this._lastLayoutCtx=null,this.flexRatio=i,this.mainBasis=s,this.crossBasis=n,this.vertical=r}handleEvent(t,e,i,s){return this.child.dispatchEvent(t,e,i,s)}handlePreLayoutUpdate(t){const e=this.child;e.preLayoutUpdate(t),e.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(t){const e=this.child;e.postLayoutUpdate(t),e.dirty&&(this._dirty=!0)}handlePopulateLayout(t){var e;const i=null!==(e=this.vertical)&&void 0!==e?e:t.vertical;this._lastLayoutCtx=new _(0,0,i),this.child.populateLayout(this._lastLayoutCtx),i?(this.internalMainBasis=this._lastLayoutCtx.vBasis,this.internalCrossBasis=this._lastLayoutCtx.hBasis):(this.internalMainBasis=this._lastLayoutCtx.hBasis,this.internalCrossBasis=this._lastLayoutCtx.vBasis),super.handlePopulateLayout(t)}handleResolveLayout(t){if(super.handleResolveLayout(t),null===this._lastLayoutCtx)throw new Error("Unexpected null _lastLayoutCtx in FlexContainer.handleResolveLayout");this._lastLayoutCtx.maxWidth=this.resolvedWidth,this._lastLayoutCtx.maxHeight=this.resolvedHeight,this.child.resolveLayout(this._lastLayoutCtx),this._lastLayoutCtx.sizeChanged&&(t.sizeChanged=!0)}handlePainting(t,e,i,s,n){this.child.paint(t,e,i,s,n)}}class A extends N{constructor(t,e=null,i=1,s=0,n=0,r=null,l=null){super(t,!1,i,s,n,r,l),this.clickHelper=new h(this),this.callback=e}handleEvent(t,e,i,s){if(null===this.callback)return this.clickHelper.clickStateChanged=!1,this;if(this.clickHelper.handleClickEvent(t,s,[0,e,0,i]),this.clickHelper.clickStateChanged&&this.clickHelper.wasClick)try{this.callback()}catch(t){console.error("Exception in Icon callback",t)}return this}}class V extends A{constructor(){super(...arguments),this.backgroundProperty=v.BackgroundFill,this._forced=!1}updateBackground(){var t;if(this._forced)this.backgroundProperty=v.PrimaryFill;else switch(this.clickHelper.clickState){case e.Hold:this.backgroundProperty=v.AccentFill;break;case e.Hover:this.backgroundProperty=v.BackgroundGlowFill;break;default:this.backgroundProperty=v.BackgroundFill}const i=this.theme.getFill(this.backgroundProperty),s=new f(new Map([[v.CanvasFill,i]]),null===(t=this.inheritedTheme)||void 0===t?void 0:t.fallback);super.inheritTheme(s)}set forced(t){t!==this._forced&&(this._forced=t,this.updateBackground())}get forced(){return this._forced}setThemeOverride(t){if(null===t)return super.setThemeOverride(null);try{const e=t.getFill(this.backgroundProperty),i=new f(new Map([[v.CanvasFill,e]]));super.setThemeOverride(i)}catch(t){return super.setThemeOverride(null)}}inheritTheme(t){const e=t.getFill(this.backgroundProperty),i=new f(new Map([[v.CanvasFill,e]]),t);super.inheritTheme(i)}handleEvent(t,e,i,s){const n=super.handleEvent(t,e,i,s);return this.clickHelper.clickStateChanged&&this.updateBackground(),n}}class z extends O{constructor(t,e,i=null){super(t,i,!1,e),this._backgroundDirty=!0}handleEvent(t,e,i,n){const[r,l,h,o]=this.calcChildViewport(0,0,e,i);return t instanceof s&&(t=t.correctOffset(r,h)),this.child.dispatchEvent(t,l-r,o-h,n)}handlePreLayoutUpdate(t){const e=this.child;e.preLayoutUpdate(t),e.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(t){const e=this.child;e.postLayoutUpdate(t),e.dirty&&(this._dirty=!0)}forceLayoutDirty(){this._backgroundDirty=!0,super.forceLayoutDirty()}handlePopulateLayout(t){const e=this.theme.getPadding(v.ContainerPadding);let i=t.maxWidth;const s=e.left+e.right;t.vertical&&(i-=s);let n=t.maxHeight;const r=e.top+e.bottom;t.vertical||(n-=r);const l=new _(i,n,t.vertical);this.child.populateLayout(l),t.addBasis(l.hBasis+s,l.vBasis+r),t.hFlex+=l.hFlex,t.vFlex+=l.vFlex;const h=l.hBasis+s;h>t.maxWidth&&(t.maxWidth=h);const o=l.vBasis+r;o>t.maxHeight&&(t.maxHeight=o)}handleResolveLayout(t){const e=this.theme.getPadding(v.ContainerPadding),i=e.left+e.right;let s=t.maxWidth;t.vertical&&(s-=i);const n=e.top+e.bottom;let r=t.maxHeight;t.vertical||(r-=n);const l=t.clone();l.maxWidth=s,l.maxHeight=r;const h=this.child;h.resolveLayout(l);const[o,a]=h.dimensions;if(isNaN(o)||isNaN(a)||o<0||a<0)throw console.error("Child resolved to invalid dimensions:",o,a,h),new Error("Child resolved to invalid dimensions");l.sizeChanged&&(t.sizeChanged=!0);const c=this.resolvedWidth,u=this.resolvedHeight;this.resolvedWidth=o+i,this.resolvedHeight=a+n,c===this.resolvedWidth&&u===this.resolvedHeight||(this._backgroundDirty=!0)}handlePainting(t,e,i,s,n){this._backgroundDirty&&this.clear(t,e,i,s,n),this._backgroundDirty=!1;const[r,l,h,o]=this.calcChildViewport(t,e,i,s);this.child.paint(r,h,l-r,o-h,n)}calcChildViewport(t,e,i,s){const n=this.theme.getPadding(v.ContainerPadding);let r=t+n.left,l=t+i-n.right,h=e+n.top,o=e+s-n.bottom;if(r>l||h>o)return console.warn("Not enough space for padding in Container widget! Falling back to using no padding"),[t,e,i,s];const a=this.theme.getAlignment2D(v.ContainerAlignment);if(a.horizontal!==m.Stretch){const t=l-r-this.child.dimensions[0];if(t>0)switch(a.horizontal){case m.Start:l-=t;break;case m.Center:r+=t/2,l-=t/2;break;case m.End:r+=t}}if(a.vertical!==m.Stretch){const t=o-h-this.child.dimensions[1];if(t>0)switch(a.vertical){case m.Start:o-=t;break;case m.Center:h+=t/2,o-=t/2;break;case m.End:h+=t}}return[r,l,h,o]}}class Q extends z{constructor(t,e=null){super(t,!0,e)}}class K extends Q{constructor(t){super(t,new f(new Map([[v.ContainerAlignment,{horizontal:m.Center,vertical:m.Stretch}]])))}}class G extends U{constructor(t,e=null){super(e,!0,!1),this.textGetter=null,this.textHelper=new u,this.source=t,this.flexRatio=0,this.vertical=!1}set source(t){t instanceof Function?this.textGetter=t:(this.textGetter=null,this.textHelper.text=t)}get source(){return null!==this.textGetter?this.textGetter:this.textHelper.text}set minWidth(t){this.textHelper.minWidth=t}get minWidth(){return this.textHelper.minWidth}set minAscent(t){this.textHelper.minAscent=t}get minAscent(){return this.textHelper.minAscent}set minDescent(t){this.textHelper.minDescent=t}get minDescent(){return this.textHelper.minDescent}get text(){return this.textHelper.text}handlePreLayoutUpdate(t){null!==this.textGetter&&(this.textHelper.text=this.textGetter()),this.textHelper.font=this.theme.getFont(v.BodyTextFont),this.textHelper.minWidth=this.theme.getNumber(v.LabelMinWidth),this.textHelper.minAscent=this.theme.getNumber(v.LabelMinAscent),this.textHelper.minDescent=this.theme.getNumber(v.LabelMinDescent),this.internalMainBasis=this.textHelper.width,this.internalCrossBasis=this.textHelper.height,this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handlePainting(t,e,i,s,n){n.font=this.textHelper.font,n.fillStyle=this.theme.getFill(v.BodyTextFill),n.fillText(this.text,t,e+s-this.textHelper.descent)}}class j extends V{constructor(t,e=null,i=1,s=0,n=0,r=!1,l=null){super(new K(new G(t,l)),e,i,s,n,r,l)}}class $ extends j{constructor(t,e,i,s=0,n=24,r=24,l=null){super(t,(()=>i.callback(e)),s,n,r,!1,l)}}class q extends ${constructor(t,e=0,i=60,s=24,n=null){super("Backspace","Backspace",t,e,i,s,n)}}class X extends ${constructor(t,e=0,i=24,s=24,n=null){super("Esc","Escape",t,e,i,s,n)}}class Y extends ${constructor(t,e=0,i=72,s=24,n=null){super("Enter","Enter",t,e,i,s,n)}}class J extends j{constructor(t,e=0,i=84,s=24,n=null){super("Shift",(()=>{t.shift=!t.shift,this.forced=t.shift,t.callback("Shift")}),e,i,s,!1,n),this.forced=t.shift}}class Z extends ${constructor(t,e=1,i=84,s=24,n=null){super("Space"," ",t,e,i,s,n)}}class tt extends W{add(t){if(Array.isArray(t))for(const e of t)this._children.push(e);else this._children.push(t);return this.updateInheritedTheme(),this._layoutDirty=!0,this._dirty=!0,this}remove(t){if(Array.isArray(t))for(const e of t){const t=this._children.indexOf(e);-1!==t&&this._children.splice(t,1)}else{const e=this._children.indexOf(t);-1!==e&&this._children.splice(e,1)}return this.updateInheritedTheme(),this._layoutDirty=!0,this._dirty=!0,this}clearChildren(){return this._children.length=0,this._layoutDirty=!0,this._dirty=!0,this}}class et extends tt{constructor(t,e=null){super([],e,!1,!0),this.backgroundDirty=!0,this.innerContext=null,this.vertical=t}handleEvent(t,e,i,n){const r=this.theme.getNumber(v.ContainerSpacing);for(const l of this.children){if(!l.enabled)continue;const h=this.vertical?l.dimensions[1]:l.dimensions[0];let o,a;this.vertical?(o=e,a=h):(o=h,a=i);const c=l.dispatchEvent(t,o,a,n);if(null!==c)return c;t instanceof s&&(t=this.vertical?t.correctOffset(0,h+r):t.correctOffset(h+r,0))}return null}handlePreLayoutUpdate(t){let e=!1;for(const i of this.children)i.preLayoutUpdate(t),i.layoutDirty&&(e=!0);e&&this.forceLayoutDirty()}handlePostLayoutUpdate(t){for(const e of this.children)e.postLayoutUpdate(t),e.dirty&&(this._dirty=!0)}forceLayoutDirty(){this.backgroundDirty=!0,super.forceLayoutDirty()}handlePopulateLayout(t){const e=this.vertical===t.vertical;let i;e?i=t:(this.innerContext=new _(t.maxWidth,t.maxHeight,this.vertical),i=this.innerContext);for(const t of this.children)t.populateLayout(i);const s=this.childCount,n=this.theme.getNumber(v.ContainerSpacing);if(s>1&&n>0){const t=n*(s-1);i.vertical?i.vBasis+=t:i.hBasis+=t}e||t.addBasis(i.hBasis,i.vBasis),i.hBasis>t.maxWidth&&(t.maxWidth=i.hBasis),i.vBasis>t.maxHeight&&(t.maxHeight=i.vBasis)}handleResolveLayout(t){const e=this.vertical===t.vertical;let i;if(e)i=t;else{if(i=this.innerContext,null===i)throw"Unexpected null innerContext";t.maxWidth>i.maxWidth&&(i.maxWidth=t.maxWidth),t.maxHeight>i.maxHeight&&(i.maxHeight=t.maxHeight)}let s=0,n=0,r=0,l=0,h=0;for(const t of this.children){if(!t.enabled){t.resolveLayout(i);continue}h++;const[e,o]=t.dimensions;t.resolveLayout(i);const[a,c]=t.dimensions;if(isNaN(a)||isNaN(c)||a<0||c<0)throw console.error("Child resolved to invalid dimensions:",a,c,t),new Error("Child resolved to invalid dimensions");this.vertical?c!==o&&(i.sizeChanged=!0):a!==e&&(i.sizeChanged=!0),r+=a,a>s&&(s=a),l+=c,c>n&&(n=c)}!e&&i.sizeChanged&&(t.sizeChanged=!0),this.innerContext=null;const o=this.theme.getNumber(v.ContainerSpacing);let a=0;h>1&&o>0&&(a=o*(h-1)),this.vertical?(this.resolvedWidth=s,this.resolvedHeight=l+a):(this.resolvedWidth=r+a,this.resolvedHeight=n)}handlePainting(t,e,i,s,n){const r=this.theme.getNumber(v.ContainerSpacing);this.backgroundDirty&&r>0&&this.clear(t,e,i,s,n),this.backgroundDirty=!1;const l=this.vertical?e+s:t+i;for(const h of this.children){if(!h.enabled)continue;let o,a,c=!1;this.vertical?(o=i,a=h.dimensions[1],e+a>l&&(c=!0,a=l-e)):(o=h.dimensions[0],a=s,t+o>l&&(c=!0,o=l-t)),h.paint(t,e,o,a,n),c&&console.warn("MultiContainer overflow, children may be painted with 0 length"),this.vertical?e+=a+r:t+=o+r}}}class it extends et{constructor(t=null){super(!0,t)}}class st extends j{constructor(t,e=null,i,s=0,n=24,r=24,l=null){function h(){return i.shift?null===e?t:e:t}null===e&&(e=t),super(h,(()=>i.callback(h())),s,n,r,!1,l)}}class nt extends U{constructor(t=1,e=0,i=0,s=null,n=null){super(n,!0,!1),this.flexRatio=t,this.mainBasis=e,this.crossBasis=i,this.vertical=s}}class rt extends et{constructor(t=null){super(!1,t)}}class lt extends rt{constructor(t,e,i=0,s=24,n=24,r=.01,l=4,h=null){super(new f(new Map([[v.ContainerSpacing,0]])));let o=!0;const a=()=>{o?o=!1:this.add(new nt(r,l,n,!1))};for(const r of t)if("function"==typeof r){a();const t=r;this.add(t(e,h))}else{if("string"!=typeof r[0]||"string"!=typeof r[1])throw new Error(`Unknown virtual key row template format for entry: ${r}`);{const t=r[0],l=r[1];for(let r=0;r<t.length;r++){a();let o=null;r<l.length&&(o=l[r]),this.add(new st(t[r],o,e,i,s,n,h))}}}}}const ht=[[["`1234567890-=","~!@#$%^&*()_+"]],[["qwertyuiop[]\\","QWERTYUIOP{}|"]],[["asdfghjkl;'",'ASDFGHJKL:"'],function(t,e){return new Y(t,void 0,void 0,void 0,e)}],[function(t,e){return new J(t,void 0,void 0,void 0,e)},["zxcvbnm,./","ZXCVBNM<>?"]],[function(t,e){return new q(t,void 0,void 0,void 0,e)},function(t,e){return new Z(t,void 0,void 0,void 0,e)},function(t,e){return new X(t,void 0,void 0,void 0,e)}]];class ot extends it{constructor(t,e=ht,i=0,s=24,n=24,r=.01,l=4,h=null){super(h);const o={callback:e=>{t.keyPress(e)},shift:!1};for(const t of e)this.add(new lt(t,o,i,s,n,r,l,h))}}class at extends Q{constructor(t){super(t,new f(new Map([[v.ContainerAlignment,{horizontal:m.Center,vertical:m.Center}]])))}}class ct extends w{constructor(t,e=ht,i=new f){super(new at(new ot(t,e)),i),this.keyboardDriver=t}update(){this.enabled=null!==this.keyboardDriver.getFocusedRoot(),super.update()}}class ut extends C{constructor(t,e=ht,i=null,s=new f){super(new at(new ot(t,e)),i,s),this.keyboardDriver=t}updateVisibility(){this.enabled=null!==this.keyboardDriver.getFocusedRoot()}}class dt extends i{constructor(e,i){super(i,t.Keyboard,!0),this.key=e}}class pt extends dt{cloneWithTarget(t){return new pt(this.key,t)}}class vt extends dt{cloneWithTarget(t){return new vt(this.key,t)}}class mt{constructor(){this.eventQueues=new Map,this.keysDown=new Set,this.focus=null}getEventQueue(t){if(null===t)return null;const e=this.eventQueues.get(t);return void 0===e?null:e}changeFocusedRoot(e){null!==this.focus&&this.focus.clearFocus(t.Keyboard),this.focus=e,this.keysDown.clear()}getFocusedRoot(){return this.focus}clearFocus(){this.changeFocusedRoot(null)}keyDown(t){this.keysDown.add(t);const e=this.getEventQueue(this.focus);null!==e&&e.push(new vt(t,null))}keyUp(t){if(this.keysDown.delete(t)){const e=this.getEventQueue(this.focus);null!==e&&e.push(new pt(t,null))}}keyPress(t){const e=this.isKeyDown(t);this.keyDown(t),e||this.keyUp(t)}isKeyDown(t){return this.keysDown.has(t)}onEnable(t){this.eventQueues.has(t)||this.eventQueues.set(t,[])}onDisable(t){this.eventQueues.has(t)&&(this.eventQueues.delete(t),t===this.focus&&this.clearFocus())}update(t){const e=this.getEventQueue(t);if(null!==e){for(const i of e)t.dispatchEvent(i);e.length=0}}onFocusChanged(e,i,s){i===t.Keyboard&&(e==this.focus?null===s&&this.clearFocus():null!==s&&this.changeFocusedRoot(e))}onFocusCapturerChanged(t,e,i,s){}}class gt extends mt{constructor(){super(...arguments),this.domElems=new Set}bindDOMElem(t,e=!0){this.domElems.has(t)||(this.domElems.add(t),e&&(t.addEventListener("keydown",(t=>{this.keyDown(t.key)})),t.addEventListener("keyup",(t=>{this.keyUp(t.key)}))),t.addEventListener("blur",(t=>{this.shouldClearFocus(t.relatedTarget)&&this.clearFocus()})))}shouldClearFocus(t){return null===t||!this.domElems.has(t)}}function ft(t,e){const i=e.getBoundingClientRect();return[(t.clientX-i.left)/i.width,(t.clientY-i.top)/i.height]}class yt extends s{constructor(e,i,s=null){super(e,i,s,t.Pointer)}correctOffset(t,e){return new yt(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new yt(this.x,this.y,t)}}var xt;!function(t){t[t.None=0]="None",t[t.Hovering=1]="Hovering",t[t.Pressing=2]="Pressing"}(xt||(xt={}));class _t{constructor(){this.states=new Map,this.nextPointerID=0,this.hints=new Map}unassignPointer(e,i){null!==i.pointer&&this.setPointerHint(i.pointer,xt.None),i.pointer=null,i.hovering&&i.eventQueue.push(new l(e.getFocusCapturer(t.Pointer))),i.hovering=!1,i.pressing=!1}registerPointer(){const t=this.nextPointerID++;return this.setPointerHint(t,xt.None),t}unregisterPointer(t){for(const[e,i]of this.states)i.pointer===t&&this.unassignPointer(e,i);this.hints.delete(t)}movePointer(e,i,s,h,o=null){const a=this.states.get(e);if(void 0===a)return;const c=null===a.pointer;c&&(a.pointer=i),null===o&&(o=a.pressing);const u=a.pointer===i;if(!u||c)for(const[t,s]of this.states)t!==e&&s.pointer===i&&this.unassignPointer(t,s);if(!u&&(!o||a.pressing))return;const[d,p]=e.dimensions,v=s*d,m=h*p;let g;o!==a.pressing?(g=o?new r(v,m):new n(v,m),a.pressing=o,o&&a.pointer!==i&&null!==a.pointer&&(a.eventQueue.push(new l(e.getFocusCapturer(t.Pointer))),this.setPointerHint(a.pointer,xt.None),a.pointer=i)):g=new yt(v,m),a.eventQueue.push(g),a.hovering=!0,a.pressing?this.setPointerHint(i,xt.Pressing):this.setPointerHint(i,xt.Hovering)}leavePointer(e,i){const s=this.states.get(e);void 0!==s&&s.hovering&&s.pointer==i&&(s.hovering=!1,s.pressing=!1,s.eventQueue.push(new l(e.getFocusCapturer(t.Pointer))),this.setPointerHint(i,xt.None))}leaveAnyPointer(t){for(const e of this.states.keys())this.leavePointer(e,t)}setPointerHint(t,e){return this.hints.get(t)!==e&&(this.hints.set(t,e),!0)}getPointerHint(t){var e;return null!==(e=this.hints.get(t))&&void 0!==e?e:xt.None}onEnable(t){this.states.set(t,{eventQueue:[],pointer:null,pressing:!1,hovering:!1})}onDisable(t){t.dispatchEvent(new l);const e=this.states.get(t);void 0!==e&&null!==e.pointer&&this.setPointerHint(e.pointer,xt.None),this.states.delete(t)}update(t){const e=this.states.get(t);if(void 0!==e){for(const i of e.eventQueue)t.dispatchEvent(i);e.eventQueue.length=0}}onFocusChanged(t,e,i){}onFocusCapturerChanged(t,e,i,s){}}class bt extends _t{constructor(){super(),this.domElems=new WeakMap,this.mousePointerID=this.registerPointer()}bindDOMElem(t,e){let i=this.domElems.get(t);void 0!==i?this.removeListeners(i):(i={domElem:e,pointermoveListen:null,pointerdownListen:null,pointerupListen:null,pointerleaveListen:null},this.domElems.set(t,i)),t.enabled&&this.addListeners(t,i)}addListeners(t,e){const i=e.domElem;e.pointermoveListen=e=>{e.isPrimary&&this.movePointer(t,this.mousePointerID,...ft(e,i))},e.pointerdownListen=e=>{e.isPrimary&&this.movePointer(t,this.mousePointerID,...ft(e,i),!0)},e.pointerupListen=e=>{e.isPrimary&&this.movePointer(t,this.mousePointerID,...ft(e,i),!1)},e.pointerleaveListen=e=>{e.isPrimary&&this.leavePointer(t,this.mousePointerID)},i.addEventListener("pointermove",e.pointermoveListen),i.addEventListener("pointerdown",e.pointerdownListen),i.addEventListener("pointerup",e.pointerupListen),i.addEventListener("pointerleave",e.pointerleaveListen)}removeListeners(t){null!==t.pointermoveListen&&(t.domElem.removeEventListener("pointermove",t.pointermoveListen),t.pointermoveListen=null),null!==t.pointerdownListen&&(t.domElem.removeEventListener("pointerdown",t.pointerdownListen),t.pointerdownListen=null),null!==t.pointerupListen&&(t.domElem.removeEventListener("pointerup",t.pointerupListen),t.pointerupListen=null),null!==t.pointerleaveListen&&(t.domElem.removeEventListener("pointerleave",t.pointerleaveListen),t.pointerleaveListen=null)}onEnable(t){super.onEnable(t);const e=this.domElems.get(t);void 0!==e&&this.addListeners(t,e)}onDisable(t){super.onDisable(t);const e=this.domElems.get(t);void 0!==e&&this.removeListeners(e)}}class Ct extends _t{constructor(){super(...arguments),this.sources=new Set}handlePointerRay(t,e,i,s){const[n,r,l]=this.castRay(i,s);null===n?this.leaveAnyPointer(t):this.movePointer(n,t,r,l,e)}addSource(t){this.sources.has(t)||(t.setRayPointerDriver(this),this.sources.add(t))}setPointerHint(t,e){const i=super.setPointerHint(t,e);for(const i of this.sources)i.onPointerHintChanged(t,e);return i}}class wt extends R{constructor(){super(...arguments),this._boxWidth=0,this._boxHeight=0}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth!==t&&(this._boxWidth=t,this._layoutDirty=!0)}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight!==t&&(this._boxHeight=t,this._layoutDirty=!0)}handlePopulateLayout(t){t.addBasis(this._boxWidth,this._boxHeight)}handleResolveLayout(t){this.resolvedWidth=this._boxWidth,this.resolvedHeight=this._boxHeight}}class kt extends f{constructor(t=new f){super(new Map,t)}getFill(t){return super.getFill(t),"#"+Math.floor(16777215*Math.random()).toString(16)}}function Bt(t,e,i=null){return s=>{let n=!0,r=s;for(const i of t)if([n,r]=i(r),!n)return[!1,e];if(null!==i)try{i(r)}catch(t){console.warn("Exception in CompositeValidator callback:",t)}return[!0,r]}}function Pt(t){return[!0,t]}function Lt(t=null){return null===t?Pt:e=>(t(e),[!0,e])}const Dt=/^-?(\.\d+|\d+(\.(\d+)?)?)(e\d+)?$/;function Ht(t){return Dt.test(t)?[!0,parseFloat(t)]:[!1,NaN]}const Ft=/^-?\d+$/;function Tt(t){return Ft.test(t)?[!0,parseInt(t)]:[!1,NaN]}function St(t,e){return i=>i<t||i>e?[!1,i]:[!0,i]}class Mt extends U{constructor(t,e="",i=null){super(i,!1,!1),this.blinkStart=0,this.blinkWasOn=null,this.cursorPos=0,this.cursorOffset=0,this.cursorOffsetDirty=!1,this._editingEnabled=!0,this._hideText=!1,this.textHelper=new u,this.variable=new d(e,(e=>{const[i,s]=t(e);i&&(this._validValue=s),i!==this._valid&&(this._valid=i,this._dirty=!0)})),[this._valid,this._validValue]=t(e),this.vertical=!1}get blinkOn(){if(0===this.blinkStart)return null;const t=this.theme.getNumber(v.BlinkRate);return 0===Math.trunc((Date.now()-this.blinkStart)/(500*t)%2)}get editingEnabled(){return this._editingEnabled}set editingEnabled(t){this._editingEnabled!==t&&(this._editingEnabled=t,t||(this.blinkStart=0,this.moveCursorTo(0)),this._dirty=!0)}get hideText(){return this._hideText}set hideText(t){this._hideText!==t&&(this._hideText=t,this.cursorOffsetDirty=!0,this._dirty=!0)}set text(t){this.variable.value=t}get text(){return this.variable.value}get displayedText(){return this._hideText?"●".repeat(this.variable.value.length):this.variable.value}get valid(){return this._valid}get validValue(){return this._validValue}set minWidth(t){this.textHelper.minWidth=t}get minWidth(){return this.textHelper.minWidth}set minAscent(t){this.textHelper.minAscent=t}get minAscent(){return this.textHelper.minAscent}set minDescent(t){this.textHelper.minDescent=t}get minDescent(){return this.textHelper.minDescent}moveCursorTo(t){this.cursorPos=Math.min(Math.max(t,0),this.text.length),this.cursorOffsetDirty=!0,this._dirty=!0}moveCursor(t){this.moveCursorTo(this.cursorPos+t)}insertText(t){this.text=this.text.substring(0,this.cursorPos)+t+this.text.substring(this.cursorPos),this.moveCursor(t.length)}deleteText(t){t>0?this.text=this.text.substring(0,this.cursorPos)+this.text.substring(this.cursorPos+t):t<0&&(this.text=this.text.substring(0,this.cursorPos+t)+this.text.substring(this.cursorPos),this.moveCursor(t))}onFocusDropped(e,i){e===t.Keyboard&&(this.blinkStart=0)}handleEvent(e,i,l,h){if(!this._editingEnabled)return this;if(e instanceof s)return h.pointerStyle="text",e instanceof r?([this.cursorPos,this.cursorOffset]=this.textHelper.findIndexOffsetFromOffset(e.x),this.blinkStart=Date.now(),this._dirty=!0,h.requestFocus(t.Keyboard,this)):e instanceof n&&h.hasMobileTextInput&&h.getTextInput(this.text).then((t=>{null!==t&&this.text!==t&&(this.text=t,this.moveCursorTo(t.length))})),this;if(e instanceof vt){if(1===e.key.length)this.insertText(e.key);else if("Backspace"===e.key)this.deleteText(-1);else if("Delete"===e.key)this.deleteText(1);else if("ArrowLeft"===e.key)this.moveCursor(-1);else if("ArrowRight"===e.key)this.moveCursor(1);else if("Home"===e.key)this.moveCursorTo(0);else{if("End"!==e.key)return"Escape"===e.key?(h.dropFocus(t.Keyboard,this),this):this;this.moveCursorTo(this.text.length)}this.blinkStart=Date.now()}return this}handlePreLayoutUpdate(e){this.editingEnabled||e.dropFocus(t.Keyboard,this),this.blinkOn!==this.blinkWasOn&&(this._dirty=!0);const i=this.theme.getNumber(v.CursorPadding)+this.theme.getNumber(v.CursorThickness);this.textHelper.text=this.displayedText,this.textHelper.font=this.theme.getFont(v.InputTextFont),this.textHelper.minWidth=this.theme.getNumber(v.InputTextMinWidth)-i,this.textHelper.minAscent=this.theme.getNumber(v.InputTextMinAscent),this.textHelper.minDescent=this.theme.getNumber(v.InputTextMinDescent),this.cursorOffsetDirty&&(this.cursorOffset=this.textHelper.findOffsetFromIndex(this.cursorPos),this.cursorOffsetDirty=!1),this.flexRatio=this.theme.getNumber(v.InputTextFlexRatio),this.internalMainBasis=this.textHelper.width+i,this.internalCrossBasis=this.textHelper.height,this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handlePainting(t,e,i,s,n){n.fillStyle=this.theme.getFill(v.InputBackgroundFill),n.fillRect(t,e,i,s),n.font=this.theme.getFont(v.InputTextFont),this._editingEnabled?this._valid?n.fillStyle=this.theme.getFill(v.InputTextFill):n.fillStyle=this.theme.getFill(v.InputTextFillInvalid):n.fillStyle=this.theme.getFill(v.InputTextFillDisabled),n.fillText(this.displayedText,t,e+s-this.textHelper.descent);const r=this.blinkOn;if(this.blinkWasOn=r,!r)return;const l=this.theme.getNumber(v.CursorPadding),h=this.theme.getNumber(v.CursorThickness);n.fillRect(t+this.cursorOffset,e+l,h,s-2*l)}}class Et extends Mt{constructor(t=null,e="",i=null){super(Lt(t),e,i)}}class It extends Q{constructor(t){super(t,new f(new Map([[v.ContainerAlignment,{horizontal:m.Center,vertical:m.Center}],[v.ContainerPadding,{left:0,right:0,top:0,bottom:0}]])))}}class Rt extends wt{constructor(t=null,e=!1,i=null){super(i,!0,!1),this.variable=new d(e,t),this.clickHelper=new h(this)}set checked(t){this.variable.value=t}get checked(){return this.variable.value}getBoxRect(t,e,i,s){const n=this.theme.getNumber(v.CheckboxLength),r=Math.min(n,i,s),l=t+(i-r)/2,h=e+(s-r)/2;return[l,l+r,h,h+r]}handleEvent(t,e,i,s){const n=this.getBoxRect(0,0,e,i);return this.clickHelper.handleClickEvent(t,s,n),this.clickHelper.clickStateChanged&&this.clickHelper.wasClick&&(this.checked=!this.checked),this}handlePreLayoutUpdate(t){const e=this.theme.getNumber(v.CheckboxLength);this.boxWidth=e,this.boxHeight=e,this.variable.dirty&&(this._dirty=!0)}handlePainting(t,i,s,n,r){const[l,h,o,a]=this.getBoxRect(t,i,s,n),c=h-l,u=this.clickHelper.clickState===e.Hover||this.clickHelper.clickState===e.Hold;if(r.fillStyle=u?this.theme.getFill(v.BackgroundGlowFill):this.theme.getFill(v.BackgroundFill),r.fillRect(l,o,c,c),this.checked){r.fillStyle=u?this.theme.getFill(v.AccentFill):this.theme.getFill(v.PrimaryFill);const t=this.theme.getNumber(v.CheckboxInnerPadding),e=c-2*t;e<=0?r.fillRect(l,o,c,c):r.fillRect(l+t,o+t,e,e)}}}class Wt extends wt{constructor(t,e=null,i=null,s=null,n=null){super(n,!0,!1),this.lastSrc=null,this._rotation=0,this._image=t,this.width=e,this.height=i,this.viewBox=s,this.updateDimensions()}updateDimensions(){let t=this.width;null===t&&(t=null===this.viewBox?this._image.width:this.viewBox[2]),this.boxWidth!==t&&(this.boxWidth=t);let e=this.height;null===e&&(e=null===this.viewBox?this._image.height:this.viewBox[3]),this.boxHeight!==e&&(this.boxHeight=e)}set image(t){t!==this._image&&(this._image=t,this.lastSrc=null)}get image(){return this._image}getIconRect(t,e,i,s){const n=i/this.boxWidth,r=s/this.boxHeight,l=Math.min(n,r),h=this.boxWidth*l,o=this.boxHeight*l;return[t+(i-h)/2,e+(s-o)/2,h,o]}handlePreLayoutUpdate(t){var e,i;(null===(e=this._image)||void 0===e?void 0:e.src)!==this.lastSrc&&(null===(i=this._image)||void 0===i?void 0:i.complete)&&(this._dirty=!0),this.updateDimensions()}set rotation(t){t!==this._rotation&&(this._rotation=t,this._dirty=!0)}get rotation(){return this._rotation}handlePainting(t,e,i,s,n){var r;if(!(null===(r=this._image)||void 0===r?void 0:r.complete))return void(this.lastSrc=null);this.lastSrc=this._image.src;const[l,h,o,a]=this.getIconRect(t,e,i,s);let c=l,u=h;0!==this.rotation&&(n.save(),n.translate(l+o/2,h+a/2),c=-o/2,u=-a/2,n.rotate(this.rotation)),null===this.viewBox?n.drawImage(this._image,c,u,o,a):n.drawImage(this._image,...this.viewBox,c,u,o,a),0!==this.rotation&&n.restore()}}class Ot extends A{constructor(t,e=null,i=null,s=null,n=null,r=0,l=0,h=0,o=null,a=null){super(new at(new Wt(t,e,i,s,a)),n,r,l,h,o,a)}}class Ut extends rt{constructor(t,e=null,i=!1,s=null){super(s),this.add([new G(t,s),new nt(1,0,0,!1,s),new Rt(e,i,s)])}}class Nt extends O{constructor(t,e=null){super(t,e,!1,!0)}handleEvent(t,e,i,s){return this.child.dispatchEvent(t,e,i,s)}handlePreLayoutUpdate(t){const e=this.child;e.preLayoutUpdate(t),e.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(t){const e=this.child;e.postLayoutUpdate(t),e.dirty&&(this._dirty=!0)}handlePopulateLayout(t){this.child.populateLayout(t)}handleResolveLayout(t){const e=this.child;e.resolveLayout(t),[this.resolvedWidth,this.resolvedHeight]=e.dimensions}handlePainting(t,e,i,s,n){this.child.paint(t,e,i,s,n)}}class At extends(E(U,O)){constructor(t,e=!1,i=!1,s=null){super(t,s,!1,!0),this._offset=[0,0],this.lastChildLayoutCtx=null,this.maxDimensions=[0,0],this.lastViewportDims=[0,0],this.viewport=new b,this.mainBasisTied=e,this.crossBasisTied=i}get canvasDimensions(){return this.viewport.canvasDimensions}get offset(){return[...this._offset]}set offset(t){this._offset[0]===t[0]&&this._offset[1]===t[1]||(this._offset[0]=t[0],this._offset[1]=t[1],this._dirty=!0)}getChildMainBasis(t){if(null===this.lastChildLayoutCtx)return 0;const e=t?this.lastChildLayoutCtx.vBasis:this.lastChildLayoutCtx.hBasis;return isNaN(e)?0:e}getChildCrossBasis(t){return this.getChildMainBasis(!t)}getMaxMainBasis(t){return t?this.maxDimensions[1]:this.maxDimensions[0]}getMaxCrossBasis(t){return this.getMaxMainBasis(!t)}handleEvent(t,e,i,n){if(null===t.target&&!(t instanceof s))return null;const[r,l]=this.child.dimensions,h=this.offset[0],o=h+r,a=this.offset[1],c=a+l;if(t instanceof s){if(null===t.target){if(t.x<h)return null;if(t.x>=o)return null;if(t.y<a)return null;if(t.y>=c)return null}t=t.correctOffset(h,a)}return this.child.dispatchEvent(t,o-h,c-a,n)}handlePreLayoutUpdate(t){let e=this.vertical;null===e&&(e=!0);const i=this.child;if(e!==this.viewport.vertical&&(this.viewport.vertical=e,i.forceLayoutDirty()),i.preLayoutUpdate(t),i.layoutDirty){if(this._layoutDirty=!0,this.lastChildLayoutCtx=this.viewport.populateChildsLayout(i),this.mainBasisTied){let t=this.getChildMainBasis(e);const i=this.getMaxMainBasis(e);0!==i&&t>i&&(t=i),this.internalMainBasis=t}else this.internalMainBasis=0;if(this.crossBasisTied){let t=this.getChildCrossBasis(e);const i=this.getMaxCrossBasis(e);0!==i&&t>i&&(t=i),this.internalCrossBasis=t}else this.internalCrossBasis=0}}handlePostLayoutUpdate(t){const e=this.child;if(null!==this.lastChildLayoutCtx){let[t,i]=[...this.maxDimensions];(this.viewport.vertical?this.crossBasisTied:this.mainBasisTied)&&(0===t||this.resolvedWidth<t)&&(t=this.resolvedWidth),(this.viewport.vertical?this.mainBasisTied:this.crossBasisTied)&&(0===i||this.resolvedHeight<i)&&(i=this.resolvedHeight),this.viewport.maxDimensions=[t,i],this.lastChildLayoutCtx.maxWidth=t,this.lastChildLayoutCtx.maxHeight=i,this.viewport.resolveChildsLayout(e,this.lastChildLayoutCtx),this.lastChildLayoutCtx=null}e.postLayoutUpdate(t),e.dirty&&(this._dirty=!0)}handlePainting(t,e,i,s,n){this.lastViewportDims=[i,s],this.viewport.paintToCanvas(this.child),n.save();const r=new Path2D;r.rect(Math.trunc(t),Math.trunc(e),Math.ceil(i),Math.ceil(s)),n.clip(r),n.globalCompositeOperation="copy",n.fillStyle=this.theme.getFill(v.CanvasFill),n.fill(r);const[l,h]=this.child.dimensions,[o,a]=this.offset,c=t+o,u=e+a,d=new Path2D;d.rect(Math.trunc(c),Math.trunc(u),Math.ceil(l),Math.ceil(h)),n.clip(d),n.drawImage(this.viewport.canvas,0,0,l,h,c,u,l,h),n.restore()}}class Vt extends U{constructor(t=null,e=100,i=100,s=0,n=null){super(n,!0,!1),this.clickHelper=new h(this),this.variable=new d(s,t),this._end=e,this._barLength=i,this.dragValue=s}set scroll(t){this.variable.value=Math.max(Math.min(this._end-this._barLength,t),0)}get scroll(){return this.variable.value}get end(){return this._end}set end(t){this._end!==t&&(this._end=t,this._dirty=!0)}get barLength(){return this._barLength}set barLength(t){this._barLength!==t&&(this._barLength=t,this._dirty=!0)}getBarRect(t,e,i,s){if(this.lastVertical){const n=Math.min(this.crossBasis,i),r=t+(i-n)/2;return[r,r+n,e,e+s]}{const n=Math.min(this.crossBasis,s),r=e+(s-n)/2;return[t,t+i,r,r+n]}}handleEvent(t,i,s,n){if(this.clickHelper.handleClickEvent(t,n,this.getBarRect(0,0,i,s)),this.clickHelper.clickState==e.Hold&&null!==this.clickHelper.pointerPos)if(this.clickHelper.clickStateChanged){let t;t=this.lastVertical?this.clickHelper.pointerPos[1]*this._end:this.clickHelper.pointerPos[0]*this._end;let e=this.scroll;(t<e||t>=e+this._barLength)&&(e=t-this._barLength/2,this.scroll=e),this.dragValue=e}else if(null!==this.clickHelper.startingPointerPos){let t;t=this.lastVertical?this.clickHelper.pointerPos[1]-this.clickHelper.startingPointerPos[1]:this.clickHelper.pointerPos[0]-this.clickHelper.startingPointerPos[0],this.scroll=this.dragValue+t*this._end}return this.clickHelper.clickStateChanged&&(this._dirty=!0),this}handlePreLayoutUpdate(t){this.flexRatio=0,this.crossBasis=this.theme.getNumber(v.ScrollBarThickness),this.variable.dirty&&(this._dirty=!0)}handlePainting(t,i,s,n,r){const[l,h,o,a]=this.getBarRect(t,i,s,n),[c,u]=[h-l,a-o],d=this.scroll/this._end,p=this._barLength/this._end;r.fillStyle=this.theme.getFill(v.BackgroundFill),r.fillRect(l,o,c,u);if([e.Hover,e.Hold].includes(this.clickHelper.clickState)?r.fillStyle=this.theme.getFill(v.AccentFill):r.fillStyle=this.theme.getFill(v.PrimaryFill),this.lastVertical){let t=p*u;t>u&&(t=u),r.fillRect(l,o+d*u,c,t)}else{let t=p*c;t>c&&(t=c),r.fillRect(l+d*c,o,t,u)}}}class zt extends Nt{constructor(t,e,i=!1,s=!1,n=null){super(new it(n),n),this.viewport=new At(t,i,s,n),this.viewport.vertical=e,this.vScrollHide=!1,this.hScrollHide=!1,this.vScroll=new Vt((t=>{null===t&&(t=0),this.viewport.offset=[this.viewport.offset[0],-t]}),0,0,0,n),this.vScroll.vertical=!0;const r=new rt(n).add([this.viewport,this.vScroll]);this.hScroll=new Vt((t=>{null===t&&(t=0),this.viewport.offset=[-t,this.viewport.offset[1]]}),0,0,0,n),this.hScroll.vertical=!1;this.child.add([r,this.hScroll])}get maxDimensions(){return this.viewport.maxDimensions}set maxDimensions(t){this.viewport.maxDimensions=t}get flexRatio(){return this.viewport.flexRatio}set flexRatio(t){this.viewport.flexRatio=t}get mainBasis(){return this.viewport.mainBasis}set mainBasis(t){this.viewport.mainBasis=t}get crossBasis(){return this.viewport.crossBasis}set crossBasis(t){this.viewport.crossBasis=t}get containedChild(){return this.viewport.child}resetScroll(){this.hScroll.scroll=0,this.vScroll.scroll=0}handlePreLayoutUpdate(t){const[e,i]=this.viewport.child.dimensions,[s,n]=this.viewport.dimensions;s<e&&!this.hScrollHide?this.hScroll.enabled=!0:(this.hScroll.scroll=0,this.hScroll.enabled=!1),n<i&&!this.vScrollHide?this.vScroll.enabled=!0:(this.vScroll.scroll=0,this.vScroll.enabled=!1),super.handlePreLayoutUpdate(t)}handlePostLayoutUpdate(t){[this.hScroll.end,this.vScroll.end]=this.viewport.child.dimensions,this.hScroll.barLength=this.viewport.lastViewportDims[0],this.vScroll.barLength=this.viewport.lastViewportDims[1],super.handlePostLayoutUpdate(t)}}class Qt extends U{constructor(t=null,e=0,i=1,s=0,n=0,r=null){super(r,!0,!1),this.clickHelper=new h(this),this.variable=new d(n,t),this.minValue=e,this.maxValue=i,this.snapIncrement=s,this.vertical=!1}set value(t){this.snapIncrement>0&&(t=Math.round(t/this.snapIncrement)*this.snapIncrement),t<this.minValue?t=this.minValue:t>this.maxValue&&(t=this.maxValue),this.variable.value=t}get value(){return this.variable.value}getSliderRect(t,e,i,s){const n=Math.min(this.crossBasis,s),r=e+(s-n)/2;return[t,t+i,r,r+n]}handleEvent(t,i,s,n){if(this.clickHelper.handleClickEvent(t,n,this.getSliderRect(0,0,i,s)),(this.clickHelper.clickStateChanged&&this.clickHelper.wasClick||this.clickHelper.clickState==e.Hold)&&null!==this.clickHelper.pointerPos){const t=this.clickHelper.pointerPos[0];this.value=this.minValue+t*(this.maxValue-this.minValue)}return this.clickHelper.clickStateChanged&&(this._dirty=!0),this}handlePreLayoutUpdate(t){this.flexRatio=this.theme.getNumber(v.SliderFlexRatio),this.mainBasis=this.theme.getNumber(v.SliderMainBasis),this.crossBasis=this.theme.getNumber(v.SliderCrossBasis)}handlePainting(t,i,s,n,r){const[l,h,o,a]=this.getSliderRect(t,i,s,n),[c,u]=[h-l,a-o],d=(this.value-this.minValue)/(this.maxValue-this.minValue);[e.Hover,e.Hold].includes(this.clickHelper.clickState)?r.fillStyle=this.theme.getFill(v.AccentFill):r.fillStyle=this.theme.getFill(v.PrimaryFill);const p=d*c;r.fillRect(l,o,p,u),r.fillStyle=this.theme.getFill(v.BackgroundFill);const m=c-p;r.fillRect(l+p,o,m,u)}}class Kt extends Nt{constructor(t,e){super(t,null),this.scopeTheme=e}setThemeOverride(t){this.scopeTheme=t,super.inheritTheme(this.scopeTheme)}inheritTheme(t){super.inheritTheme(this.scopeTheme)}}export{m as Alignment,q as BackspaceKey,z as BaseContainer,$ as BasicKey,Et as BasicTextInput,wt as BoxLayout,A as Button,It as Center,Rt as Checkbox,h as ClickHelper,e as ClickState,it as Column,Q as Container,gt as DOMKeyboardDriver,bt as DOMPointerDriver,w as DOMRoot,ct as DOMVirtualKeyboardRoot,kt as DebugTheme,p as DefaultTextInputHandler,Pt as DefaultTextValidator,Y as EnterKey,X as EscapeKey,i as Event,V as FilledButton,U as FlexLayout,Ht as FloatValidator,t as FocusType,st as GlyphKey,Wt as Icon,Ot as IconButton,Tt as IntValidator,dt as KeyEvent,vt as KeyPress,pt as KeyRelease,lt as KeyRow,mt as KeyboardDriver,G as Label,Ut as LabelledCheckbox,_ as LayoutContext,l as Leave,Bt as MakeCompositeValidator,Lt as MakeDefaultTextValidatorWithCallback,St as MakeRangeValidator,at as Margin,et as MultiContainer,tt as MultiParent,W as Parent,Nt as PassthroughWidget,_t as PointerDriver,s as PointerEvent,xt as PointerHint,yt as PointerMove,r as PointerPress,n as PointerRelease,Ct as RayPointerDriver,C as Root,rt as Row,Vt as ScrollBar,zt as ScrollableViewportWidget,J as ShiftKey,O as SingleParent,Qt as Slider,Z as SpaceKey,nt as Spacing,j as TextButton,u as TextHelper,Mt as TextInput,K as TextMargin,f as Theme,v as ThemeProperty,Kt as ThemeScope,d as Variable,b as Viewport,At as ViewportWidget,ot as VirtualKeyboard,ut as VirtualKeyboardRoot,R as Widget,ht as defaultVirtualKeyboardTemplate,ft as getPointerEventNormPos,c as measureTextDims,x as roundToPower2};
