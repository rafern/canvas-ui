var Ne=Object.defineProperty;var lt=Object.getOwnPropertyDescriptor;var Qe=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;var ze=(a,e,t)=>e in a?Ne(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,K=(a,e)=>{for(var t in e||(e={}))at.call(e,t)&&ze(a,t,e[t]);if(Qe)for(var t of Qe(e))ht.call(e,t)&&ze(a,t,e[t]);return a};var b=(a,e,t,i)=>{for(var r=i>1?void 0:i?lt(e,t):e,n=a.length-1,s;n>=0;n--)(s=a[n])&&(r=(i?s(e,t,r):s(r))||r);return i&&r&&Ne(e,t,r),r};var $e=(a,e,t)=>new Promise((i,r)=>{var n=l=>{try{o(t.next(l))}catch(h){r(h)}},s=l=>{try{o(t.throw(l))}catch(h){r(h)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(n,s);o((t=t.apply(a,e)).next())});function It(a){return new Promise((e,t)=>{function i(){document.body.removeChild(l),document.body.removeChild(o)}function r(){i(),e(a)}function n(){i(),e(d.value)}function s(f){f.key=="Enter"&&(f.preventDefault(),n())}let o=document.createElement("div");o.id="textInputHandlerOverlay";let l=document.createElement("div");l.id="textInputHandler";let h=document.createElement("p");h.textContent="Change text:";let d=document.createElement("input");d.addEventListener("keyup",s),d.value=a;let u=document.createElement("div"),m=document.createElement("button");m.addEventListener("click",r),m.textContent="Cancel";let c=document.createElement("button");c.addEventListener("click",n),c.textContent="OK",u.appendChild(m),u.appendChild(c),l.appendChild(h),l.appendChild(d),l.appendChild(u),document.body.appendChild(o),document.body.appendChild(l),d.focus({preventScroll:!1})})}var p;(function(t){t[t.Pointer=0]="Pointer",t[t.Keyboard=1]="Keyboard"})(p||(p={}));var Q=class{constructor(e,t,i){this.target=e,this.focusType=t,this.needsFocus=i}};var z=class extends Q{constructor(e,t=null){super(t,p.Keyboard,!1);this.text=e}cloneWithTarget(e){return new z(this.text,e)}};var U;(function(n){n.SpaceBetween="between",n.SpaceAround="around",n[n.Start=0]="Start",n[n.Center=.5]="Center",n[n.End=1]="End"})(U||(U={}));var v;(function(r){r.Stretch="stretch",r[r.Start=0]="Start",r[r.Center=.5]="Center",r[r.End=1]="End"})(v||(v={}));var le=class{constructor(e,t){this.listener=null;this._fallbackTheme=t,typeof e!="undefined"&&(this._canvasFill=e.canvasFill,this._containerPadding=e.containerPadding,this._containerAlignment=e.containerAlignment,this._multiContainerSpacing=e.multiContainerSpacing,this._multiContainerAlignment=e.multiContainerAlignment,this._primaryFill=e.primaryFill,this._accentFill=e.accentFill,this._backgroundFill=e.backgroundFill,this._backgroundGlowFill=e.backgroundGlowFill,this._sliderMinLength=e.sliderMinLength,this._sliderThickness=e.sliderThickness,this._bodyTextFont=e.bodyTextFont,this._bodyTextFill=e.bodyTextFill,this._bodyTextHeight=e.bodyTextHeight,this._bodyTextSpacing=e.bodyTextSpacing,this._checkboxLength=e.checkboxLength,this._checkboxInnerPadding=e.checkboxInnerPadding,this._inputBackgroundFill=e.inputBackgroundFill,this._inputSelectBackgroundFill=e.inputSelectBackgroundFill,this._inputTextFont=e.inputTextFont,this._inputTextFill=e.inputTextFill,this._inputTextFillDisabled=e.inputTextFillDisabled,this._inputTextFillInvalid=e.inputTextFillInvalid,this._inputTextHeight=e.inputTextHeight,this._inputTextSpacing=e.inputTextSpacing,this._inputTextInnerPadding=e.inputTextInnerPadding,this._inputTextMinWidth=e.inputTextMinWidth,this._blinkRate=e.blinkRate,this._cursorThickness=e.cursorThickness,this._scrollBarThickness=e.scrollBarThickness,this._scrollBarMinPercent=e.scrollBarMinPercent,this._scrollBarMinPixels=e.scrollBarMinPixels)}get fallbackTheme(){return this._fallbackTheme}set fallbackTheme(e){if(this._fallbackTheme===e)return;let t=this._fallbackTheme;typeof t!="undefined"&&this.listener!==null&&t.unsubscribe(this.listener),typeof e!="undefined"&&(this.listener=i=>this.onThemeUpdated(i),e.subscribe(this.listener)),this._fallbackTheme=e,this.onThemeUpdated()}onThemeUpdated(e=null){}get canvasFill(){var e,t,i;return(i=(t=this._canvasFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.canvasFill)!=null?i:"rgba(0,0,0,0.5)"}set canvasFill(e){this._canvasFill!==e&&(this._canvasFill=e,this.onThemeUpdated("canvasFill"))}get containerPadding(){var e,t,i;return(i=(t=this._containerPadding)!=null?t:(e=this._fallbackTheme)==null?void 0:e.containerPadding)!=null?i:{left:4,right:4,top:4,bottom:4}}set containerPadding(e){this._containerPadding!==e&&(this._containerPadding=e,this.onThemeUpdated("containerPadding"))}get containerAlignment(){var e,t,i;return(i=(t=this._containerAlignment)!=null?t:(e=this._fallbackTheme)==null?void 0:e.containerAlignment)!=null?i:{horizontal:v.Start,vertical:v.Start}}set containerAlignment(e){this._containerAlignment!==e&&(this._containerAlignment=e,this.onThemeUpdated("containerAlignment"))}get multiContainerSpacing(){var e,t,i;return(i=(t=this._multiContainerSpacing)!=null?t:(e=this._fallbackTheme)==null?void 0:e.multiContainerSpacing)!=null?i:4}set multiContainerSpacing(e){this._multiContainerSpacing!==e&&(this._multiContainerSpacing=e,this.onThemeUpdated("multiContainerSpacing"))}get multiContainerAlignment(){var e,t,i;return(i=(t=this._multiContainerAlignment)!=null?t:(e=this._fallbackTheme)==null?void 0:e.multiContainerAlignment)!=null?i:{main:U.SpaceBetween,cross:v.Stretch}}set multiContainerAlignment(e){this._multiContainerAlignment!==e&&(this._multiContainerAlignment=e,this.onThemeUpdated("multiContainerAlignment"))}get primaryFill(){var e,t,i;return(i=(t=this._primaryFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.primaryFill)!=null?i:"rgb(0,127,255)"}set primaryFill(e){this._primaryFill!==e&&(this._primaryFill=e,this.onThemeUpdated("primaryFill"))}get accentFill(){var e,t,i;return(i=(t=this._accentFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.accentFill)!=null?i:"rgb(0,195,255)"}set accentFill(e){this._accentFill!==e&&(this._accentFill=e,this.onThemeUpdated("accentFill"))}get backgroundFill(){var e,t,i;return(i=(t=this._backgroundFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.backgroundFill)!=null?i:"rgb(32,32,32)"}set backgroundFill(e){this._backgroundFill!==e&&(this._backgroundFill=e,this.onThemeUpdated("backgroundFill"))}get backgroundGlowFill(){var e,t,i;return(i=(t=this._backgroundGlowFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.backgroundGlowFill)!=null?i:"rgb(48,48,48)"}set backgroundGlowFill(e){this._backgroundGlowFill!==e&&(this._backgroundGlowFill=e,this.onThemeUpdated("backgroundGlowFill"))}get sliderMinLength(){var e,t,i;return(i=(t=this._sliderMinLength)!=null?t:(e=this._fallbackTheme)==null?void 0:e.sliderMinLength)!=null?i:100}set sliderMinLength(e){this._sliderMinLength!==e&&(this._sliderMinLength=e,this.onThemeUpdated("sliderMinLength"))}get sliderThickness(){var e,t,i;return(i=(t=this._sliderThickness)!=null?t:(e=this._fallbackTheme)==null?void 0:e.sliderThickness)!=null?i:10}set sliderThickness(e){this._sliderThickness!==e&&(this._sliderThickness=e,this.onThemeUpdated("sliderThickness"))}get bodyTextFont(){var e,t,i;return(i=(t=this._bodyTextFont)!=null?t:(e=this._fallbackTheme)==null?void 0:e.bodyTextFont)!=null?i:"16px sans"}set bodyTextFont(e){this._bodyTextFont!==e&&(this._bodyTextFont=e,this.onThemeUpdated("bodyTextFont"))}get bodyTextFill(){var e,t,i;return(i=(t=this._bodyTextFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.bodyTextFill)!=null?i:"white"}set bodyTextFill(e){this._bodyTextFill!==e&&(this._bodyTextFill=e,this.onThemeUpdated("bodyTextFill"))}get bodyTextHeight(){var e,t,i;return(i=(t=this._bodyTextHeight)!=null?t:(e=this._fallbackTheme)==null?void 0:e.bodyTextHeight)!=null?i:null}set bodyTextHeight(e){this._bodyTextHeight!==e&&(this._bodyTextHeight=e,this.onThemeUpdated("bodyTextHeight"))}get bodyTextSpacing(){var e,t,i;return(i=(t=this._bodyTextSpacing)!=null?t:(e=this._fallbackTheme)==null?void 0:e.bodyTextSpacing)!=null?i:null}set bodyTextSpacing(e){this._bodyTextSpacing!==e&&(this._bodyTextSpacing=e,this.onThemeUpdated("bodyTextSpacing"))}get checkboxLength(){var e,t,i;return(i=(t=this._checkboxLength)!=null?t:(e=this._fallbackTheme)==null?void 0:e.checkboxLength)!=null?i:12}set checkboxLength(e){this._checkboxLength!==e&&(this._checkboxLength=e,this.onThemeUpdated("checkboxLength"))}get checkboxInnerPadding(){var e,t,i;return(i=(t=this._checkboxInnerPadding)!=null?t:(e=this._fallbackTheme)==null?void 0:e.checkboxInnerPadding)!=null?i:2}set checkboxInnerPadding(e){this._checkboxInnerPadding!==e&&(this._checkboxInnerPadding=e,this.onThemeUpdated("checkboxInnerPadding"))}get inputBackgroundFill(){var e,t,i;return(i=(t=this._inputBackgroundFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputBackgroundFill)!=null?i:"white"}set inputBackgroundFill(e){this._inputBackgroundFill!==e&&(this._inputBackgroundFill=e,this.onThemeUpdated("inputBackgroundFill"))}get inputSelectBackgroundFill(){var e,t,i;return(i=(t=this._inputSelectBackgroundFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputSelectBackgroundFill)!=null?i:"rgb(0,195,255)"}set inputSelectBackgroundFill(e){this._inputSelectBackgroundFill!==e&&(this._inputSelectBackgroundFill=e,this.onThemeUpdated("inputSelectBackgroundFill"))}get inputTextFont(){var e,t,i;return(i=(t=this._inputTextFont)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextFont)!=null?i:"16px mono"}set inputTextFont(e){this._inputTextFont!==e&&(this._inputTextFont=e,this.onThemeUpdated("inputTextFont"))}get inputTextFill(){var e,t,i;return(i=(t=this._inputTextFill)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextFill)!=null?i:"black"}set inputTextFill(e){this._inputTextFill!==e&&(this._inputTextFill=e,this.onThemeUpdated("inputTextFill"))}get inputTextFillDisabled(){var e,t,i;return(i=(t=this._inputTextFillDisabled)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextFillDisabled)!=null?i:"grey"}set inputTextFillDisabled(e){this._inputTextFillDisabled!==e&&(this._inputTextFillDisabled=e,this.onThemeUpdated("inputTextFillDisabled"))}get inputTextFillInvalid(){var e,t,i;return(i=(t=this._inputTextFillInvalid)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextFillInvalid)!=null?i:"red"}set inputTextFillInvalid(e){this._inputTextFillInvalid!==e&&(this._inputTextFillInvalid=e,this.onThemeUpdated("inputTextFillInvalid"))}get inputTextHeight(){var e,t,i;return(i=(t=this._inputTextHeight)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextHeight)!=null?i:null}set inputTextHeight(e){this._inputTextHeight!==e&&(this._inputTextHeight=e,this.onThemeUpdated("inputTextHeight"))}get inputTextSpacing(){var e,t,i;return(i=(t=this._inputTextSpacing)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextSpacing)!=null?i:null}set inputTextSpacing(e){this._inputTextSpacing!==e&&(this._inputTextSpacing=e,this.onThemeUpdated("inputTextSpacing"))}get inputTextInnerPadding(){var e,t,i;return(i=(t=this._inputTextInnerPadding)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextInnerPadding)!=null?i:2}set inputTextInnerPadding(e){this._inputTextInnerPadding!==e&&(this._inputTextInnerPadding=e,this.onThemeUpdated("inputTextInnerPadding"))}get inputTextMinWidth(){var e,t,i;return(i=(t=this._inputTextMinWidth)!=null?t:(e=this._fallbackTheme)==null?void 0:e.inputTextMinWidth)!=null?i:100}set inputTextMinWidth(e){this._inputTextMinWidth!==e&&(this._inputTextMinWidth=e,this.onThemeUpdated("inputTextMinWidth"))}get blinkRate(){var e,t,i;return(i=(t=this._blinkRate)!=null?t:(e=this._fallbackTheme)==null?void 0:e.blinkRate)!=null?i:.8}set blinkRate(e){this._blinkRate!==e&&(this._blinkRate=e,this.onThemeUpdated("blinkRate"))}get cursorThickness(){var e,t,i;return(i=(t=this._cursorThickness)!=null?t:(e=this._fallbackTheme)==null?void 0:e.cursorThickness)!=null?i:1}set cursorThickness(e){this._cursorThickness!==e&&(this._cursorThickness=e,this.onThemeUpdated("cursorThickness"))}get scrollBarThickness(){var e,t,i;return(i=(t=this._scrollBarThickness)!=null?t:(e=this._fallbackTheme)==null?void 0:e.scrollBarThickness)!=null?i:8}set scrollBarThickness(e){this._scrollBarThickness!==e&&(this._scrollBarThickness=e,this.onThemeUpdated("scrollBarThickness"))}get scrollBarMinPercent(){var e,t,i;return(i=(t=this._scrollBarMinPercent)!=null?t:(e=this._fallbackTheme)==null?void 0:e.scrollBarMinPercent)!=null?i:.1}set scrollBarMinPercent(e){this._scrollBarMinPercent!==e&&(this._scrollBarMinPercent=e,this.onThemeUpdated("scrollBarMinPercent"))}get scrollBarMinPixels(){var e,t,i;return(i=(t=this._scrollBarMinPixels)!=null?t:(e=this._fallbackTheme)==null?void 0:e.scrollBarMinPixels)!=null?i:20}set scrollBarMinPixels(e){this._scrollBarMinPixels!==e&&(this._scrollBarMinPixels=e,this.onThemeUpdated("scrollBarMinPixels"))}};var S=class extends le{constructor(e,t){super(e,t);this.subscribers=new Set}get fallbackTheme(){return super.fallbackTheme}set fallbackTheme(e){super.fallbackTheme=e}onThemeUpdated(e=null){for(let t of this.subscribers)t(e)}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}};var F=class extends Q{constructor(e=null){super(e,p.Pointer,!0)}cloneWithTarget(e){return new F(e)}};function Fe(a){return function(e,t){let i=new WeakMap;Object.defineProperty(e,t,{set:function(r){let n=i.get(this);r!==n&&(i.set(this,r),a.call(this,n))},get:function(){return i.get(this)},enumerable:!0,configurable:!0})}}function je(a){return Fe(function(){this[a]=!0})}var qe=je("_dirty"),V=je("_layoutDirty");function H(a){return Fe(function(){for(let e of a)this[e]=!0})}var ti=H(["_dirty","_layoutDirty"]);function Ze(a,e=!1){return function(t,i){let r=new WeakMap;Object.defineProperty(t,i,{set:function(n){if(Array.isArray(n)){let s=r.get(this);if(Array.isArray(s)){if(n.length!==s.length){s.length=n.length;for(let o=0;o<n.length;o++)s[o]=n[o];a.call(this)}else for(let o=0;o<n.length;o++)if(s[o]!==n[o]){for(let l=0;l<n.length;l++)s[l]=n[l];a.call(this);return}}else r.set(this,[...n]),a.call(this)}else if(e)r.set(this,n),a.call(this);else throw new Error("Value must be an array")},get:function(){let n=r.get(this);return Array.isArray(n)?[...n]:n},enumerable:!0,configurable:!0})}}function Je(a,e=!1){return Ze(function(){this[a]=!0},e)}function Ce(a=!1){return Je("_dirty",a)}function et(a=!1){return Je("_layoutDirty",a)}function dt(a,e=!1){return Ze(function(){for(let t of a)this[t]=!0},e)}function tt(a=!1){return dt(["_dirty","_layoutDirty"],a)}function De(a,e=!0){return Math.pow(2,(e?Math.ceil:Math.floor)(Math.log2(a)))}var te=class{constructor(e=64,t=64){this.constraints=[0,1/0,0,1/0];this._dirty=!0;this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=t;let i=this.canvas.getContext("2d",{alpha:!0});if(i===null)throw new Error("Failed to get canvas context");this.context=i}get canvasDimensions(){return[this.canvas.width,this.canvas.height]}resolveChildsLayout(e){if(!e.layoutDirty&&!this._dirty)return!1;this._dirty=!1;let[t,i]=e.dimensions,[r,n,s,o]=this.constraints;e.resolveDimensionsAsTop(r,n,s,o),e.resolvePosition(0,0);let[l,h]=e.dimensions;if(l!==t||h!==i){let d=Math.max(De(l),this.canvas.width),u=Math.max(De(h),this.canvas.height);if(d!==this.canvas.width||u!==this.canvas.height){let m=null;if(t!==0&&i!==0){m=document.createElement("canvas"),m.width=t,m.height=i;let c=m.getContext("2d");if(c===null)throw new Error("Failed to get context of temporary canvas for resizing original canvas");c.globalCompositeOperation="copy",c.drawImage(this.canvas,0,0,l,h,0,0,l,h)}this.canvas.width=d,this.canvas.height=u,m!==null&&(this.context.globalCompositeOperation="copy",this.context.drawImage(m,0,0,m.width,m.height,0,0,m.width,m.height),this.context.globalCompositeOperation="source-over")}return!0}else return!1}paintToCanvas(e,t){let i=e.dirty;return e.paint(this.context,t),i}};b([Ce()],te.prototype,"constraints",2);var ae=class{constructor(e,t=null,i=new S){this.drivers=new Set;this._enabled=!0;this.pointerStyle="default";this._currentPointerStyle="default";this._foci=new Map([[p.Keyboard,null],[p.Pointer,null]]);this._fociCapturers=new Map([[p.Keyboard,null],[p.Pointer,null]]);this.textInputHandler=null;this._mobileTextInUse=!1;this.viewport=new te,this.child=e,this.pointerStyleHandler=t,this.child.inheritedTheme=i}get constraints(){return this.viewport.constraints}set constraints(e){this.viewport.constraints=e}get canvasDimensions(){return this.viewport.canvasDimensions}get dimensions(){return this.child.dimensions}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e)if(this._enabled=e,e)for(let i of this.drivers)i.onEnable(this);else{for(let i of this.drivers)i.onDisable(this);this.updatePointerStyle("default");for(let i of this._foci.keys())this.clearFocus(i)}}get canvas(){return this.viewport.canvas}resolveLayout(){return this.enabled?this.viewport.resolveChildsLayout(this.child):!1}paint(){return this.enabled?this.viewport.paintToCanvas(this.child,!1):!1}dispatchEvent(e){var r;if(!this.enabled)return!1;if(e.focusType!==null&&e.target===null){let n=this._foci.get(e.focusType);if(typeof n=="undefined"&&(n=null),e.needsFocus&&n===null)return!1;e=e.cloneWithTarget(n)}this.pointerStyle="default";let t=this.child.dispatchEvent(e,this);if(t===null&&e.focusType!==null&&this.clearFocus(e.focusType),e.focusType===null)return t!==null;let i=(r=this._fociCapturers.get(e.focusType))!=null?r:null;if(i===t)return t!==null;e.focusType===p.Pointer&&i!==null&&this.child.dispatchEvent(new F(i),this),this._fociCapturers.set(e.focusType,t);for(let n of this.drivers)n.onFocusCapturerChanged(this,e.focusType,i,t);return t!==null}preLayoutUpdate(){if(!!this.enabled){for(let e of this.drivers)e.update(this);this.child.preLayoutUpdate(this)}}postLayoutUpdate(){!this.enabled||(this.child.postLayoutUpdate(this),this.updatePointerStyle())}updatePointerStyle(e=null){e!==null&&(this.pointerStyle=e),this.pointerStyle!==this._currentPointerStyle&&(this._currentPointerStyle=this.pointerStyle,this.pointerStyleHandler!==null&&this.pointerStyleHandler(this._currentPointerStyle))}requestFocus(e,t){if(t!==null){let i=this._foci.get(e);if(t!==i){this.clearFocus(e),this._foci.set(e,t);for(let r of this.drivers)r.onFocusChanged(this,e,t)}}}dropFocus(e,t){let i=this._foci.get(e);t===i&&this.clearFocus(e)}clearFocus(e){let t=this._foci.get(e);if(t!==null&&typeof t!="undefined"){t.onFocusDropped(e,this),this._foci.set(e,null);for(let i of this.drivers)i.onFocusChanged(this,e,null)}}getFocus(e){var t;return(t=this._foci.get(e))!=null?t:null}getFocusCapturer(e){var t;return(t=this._fociCapturers.get(e))!=null?t:null}registerDriver(e){this.drivers.has(e)||(this.drivers.add(e),this._enabled&&e.onEnable&&e.onEnable(this))}unregisterDriver(e){!this.drivers.delete(e)||this._enabled&&e.onDisable&&e.onDisable(this)}clearDrivers(){for(let e of this.drivers)this.unregisterDriver(e)}get hasMobileTextInput(){return this.textInputHandler!==null&&!this._mobileTextInUse}get usingMobileTextInput(){return this._mobileTextInUse}getTextInput(e=""){return $e(this,null,function*(){if(this.textInputHandler!==null&&!this._mobileTextInUse){this._mobileTextInUse=!0;let t=yield this.textInputHandler(e);return this._mobileTextInUse=!1,t}return null})}};var Re=class extends ae{constructor(e,t=new S){super(e,null,t);this.domElem=document.createElement("canvas"),this.domElem.tabIndex=1,[this.domElem.width,this.domElem.height]=this.dimensions;let i=this.domElem.getContext("2d",{alpha:!0});if(i===null)throw new Error("Failed to get DOM canvas context");this.domCanvasContext=i,this.pointerStyleHandler=r=>{this.domElem.style.cursor=r},this.domElem.addEventListener("paste",r=>{r.preventDefault(),r.clipboardData!==null&&this.dispatchEvent(new z(r.clipboardData.getData("text")))}),this.domElem.contentEditable="true",this.domElem.style.outline="0px solid transparent",this.domElem.style.cursor="default"}update(){if(this.enabled)this.domElem.style.removeProperty("display");else{this.domElem.style.display="none";return}this.preLayoutUpdate(),this.resolveLayout()&&([this.domElem.width,this.domElem.height]=this.dimensions),this.postLayoutUpdate(),this.paint()&&(this.domCanvasContext.globalCompositeOperation="copy",this.domCanvasContext.drawImage(this.canvas,0,0))}};var he=class extends Q{constructor(e,t,i,r,n,s){super(r,n,s);this.shift=e,this.ctrl=t,this.alt=i}};var w=class extends he{constructor(e,t,i,r,n,s=null,o=null){super(i,r,n,s,o,!1);this.x=e,this.y=t}};var C=class extends le{constructor(e,t,i){super(i);this._enabled=!0;this._dirty=!0;this._layoutDirty=!0;this.width=0;this.height=0;this.x=0;this.y=0;this._flex=0;this.needsClear=e,this.propagatesEvents=t}get flex(){return this._flex}set flex(e){e!==this._flex&&(this._flex=e,this._layoutDirty=!0)}set enabled(e){e!==this._enabled&&(this._enabled=e,this._dirty=e,this._layoutDirty=!0)}get enabled(){return this._enabled}set inheritedTheme(e){this.fallbackTheme=e}get inheritedTheme(){return this.fallbackTheme}onThemeUpdated(e=null){super.onThemeUpdated(e),this.needsClear&&(e===null||e==="canvasFill")&&(this._dirty=!0)}get dimensions(){return[this.width,this.height]}get position(){return[this.x,this.y]}get dirty(){return this._dirty&&!this.dimensionless}get layoutDirty(){return this._layoutDirty}get dimensionless(){return this.width==0||this.height==0}onFocusDropped(e,t){}handleEvent(e,t){return e.target===this?this:null}dispatchEvent(e,t){if(!this._enabled)return null;if(e.target===null){if(e instanceof w&&(e.x<this.x||e.y<this.y||e.x>=this.x+this.width||e.y>=this.y+this.height))return null}else if(e.target!==this&&!this.propagatesEvents)return null;return this.handleEvent(e,t)}handlePreLayoutUpdate(e){}preLayoutUpdate(e){this._enabled&&this.handlePreLayoutUpdate(e)}resolveDimensions(e,t,i,r){if(!this._enabled){this.width=0,this.height=0,this._layoutDirty=!1;return}if(e==1/0)throw new Error("minWidth must not be infinite");if(e>t&&(console.warn(`minWidth (${e}) must not be greater than maxWidth (${t}). Set minWidth to maxWidth. This may be caused by floating pointer precision errors`),e=t),e<0&&(console.warn(`minWidth (${e}) must not be lesser than 0. Set minWidth to 0. This may be caused by floating pointer precision errors`),e=0),i==1/0)throw new Error("minHeight must not be infinite");i>r&&(console.warn(`minHeight (${i}) must not be greater than maxHeight (${r}). Set minHeight to maxHeight. This may be caused by floating pointer precision errors`),i=r),i<0&&(console.warn(`minHeight (${i}) must not be lesser than 0. Set minHeight to 0. This may be caused by floating pointer precision errors`),i=0);let n=this.width,s=this.height;if(this.handleResolveDimensions(e,t,i,r),this.width<e?(this.width=e,console.error("Horizontal underflow in widget")):this.width>t&&(this.width=t,console.error("Horizontal overflow in widget")),this.width<0||!isFinite(this.width)||isNaN(this.width))throw new Error(`Disallowed width (${this.width}) in widget`);if(this.height<i?(this.height=i,console.error("Vertical underflow in widget")):this.height>r&&(this.height=r,console.error("Vertical overflow in widget")),this.height<0||!isFinite(this.height)||isNaN(this.height))throw new Error(`Disallowed height (${this.height}) in widget`);this._layoutDirty=!1,(n!==this.width||s!==this.height)&&(this._dirty=!0)}resolveDimensionsAsTop(e,t,i,r){this.resolveDimensions(e,t,i,r),(t===1/0||r===1/0)&&this.resolveDimensions(e,t===1/0?this.width:t,i,r===1/0?this.height:r)}afterPositionResolved(){}resolvePosition(e,t){(e!==this.x||t!==this.y)&&(this._dirty=!0),this.x=e,this.y=t,this.afterPositionResolved()}handlePostLayoutUpdate(e){}postLayoutUpdate(e){this._enabled&&this.handlePostLayoutUpdate(e)}clear(e,t,i,r,n,s=null){n.save(),n.globalCompositeOperation="copy",n.fillStyle=s!=null?s:this.canvasFill,n.beginPath(),n.rect(Math.trunc(e),Math.trunc(t),Math.ceil(i),Math.ceil(r)),n.clip(),n.fill(),n.restore()}clearStart(e,t=null){e.save(),e.globalCompositeOperation="copy",e.fillStyle=t!=null?t:this.canvasFill,e.beginPath()}clearEnd(e,t="nonzero"){e.clip(t),e.fill(),e.restore()}roundRect(e,t,i,r,n=!1){let s=n?Math.ceil:Math.floor,o=n?Math.floor:Math.ceil;return e=s(e),t=s(t),[e,t,o(e+i)-e,o(t+r)-t]}handlePainting(e,t){}paint(e,t=!1){if(this.dimensionless)return this.dryPaint();!this._dirty&&!t||(this._enabled&&(this.needsClear&&this.clear(this.x,this.y,this.width,this.height,e),e.save(),this.handlePainting(e,t),e.restore()),this._dirty=!1)}dryPaint(){this._dirty=!1}};var de=class extends C{constructor(e,t,i,r){super(t,i,r);this._children=[...e]}set inheritedTheme(e){super.inheritedTheme=e;for(let t of this.children)t.inheritedTheme=e}get inheritedTheme(){return super.inheritedTheme}dryPaint(){super.dryPaint();for(let e of this.children)e.dryPaint()}get childCount(){return this._children.length}get children(){return this._children.values()}};var $=class extends de{constructor(e,t,i,r){super([e],t,i,r)}get child(){return this._children[0]}};var ue=class extends ${constructor(e,t){super(e,!1,!0,t)}handleEvent(e,t){return this.child.dispatchEvent(e,t)}handlePreLayoutUpdate(e){let t=this.child;t.preLayoutUpdate(e),t.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(e){let t=this.child;t.postLayoutUpdate(e),t.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=this.child;n.resolveDimensions(e,t,i,r),[this.width,this.height]=n.dimensions}afterPositionResolved(){this.child.resolvePosition(this.x,this.y)}handlePainting(e,t){this.child.paint(e,t)}};var ie=class extends ue{constructor(e,t=[0,1/0,0,1/0],i){super(e,i);this._constraints=[0,1/0,0,1/0];this.constraints=[0,1/0,0,1/0];this._constraints=[...t]}handleResolveDimensions(e,t,i,r){let n=Math.min(Math.max(this._constraints[0],e),t),s=Math.min(Math.max(this._constraints[2],i),r),o=Math.min(Math.max(this._constraints[1],e),t),l=Math.min(Math.max(this._constraints[3],i),r);n>o&&(n=o),s>l&&(s=l),super.handleResolveDimensions(n,o,s,l)}};b([et()],ie.prototype,"constraints",2);var ce=class extends w{constructor(e,t,i,r,n,s,o=null,l=null){super(e,t,r,n,s,o,l);this.button=i}get isLeft(){return this.button===0}get isPrimary(){return this.isLeft}get isRight(){return this.button===1}get isSecondary(){return this.isRight}get isMiddle(){return this.button===2}get isTertiary(){return this.isMiddle}};var L=class extends ce{constructor(e,t,i,r,n,s,o=null){super(e,t,i,r,n,s,o,p.Pointer)}correctOffset(e,t){return new L(this.x-e,this.y-t,this.button,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(e){return new L(this.x,this.y,this.button,this.shift,this.ctrl,this.alt,e)}};var R=class extends ce{constructor(e,t,i,r,n,s,o=null){super(e,t,i,r,n,s,o)}correctOffset(e,t){return new R(this.x-e,this.y-t,this.button,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(e){return new R(this.x,this.y,this.button,this.shift,this.ctrl,this.alt,e)}};var x;(function(i){i[i.Released=0]="Released",i[i.Hover=1]="Hover",i[i.Hold=2]="Hold"})(x||(x={}));var I=class{constructor(e){this.lastClickState=0;this.clickState=0;this.clickStateChanged=!1;this.wasClick=!1;this.pointerPos=null;this.startingPointerPos=null;this.pointerButton=0;this.widget=e}getNormalInRect(e,t,i,r,n,s){return[(e-i)/(r-i),(t-n)/(s-n)]}isPointInRect(e,t,i,r,n,s){return e>=i&&e<r&&t>=n&&t<s}isNormalInRect(e,t){return e>=0&&e<1&&t>=0&&t<1}setClickState(e,t){this.clickState!==e?(this.lastClickState=this.clickState,this.clickState=e,this.wasClick=t&&this.lastClickState===2,this.clickStateChanged=!0):this.clickStateChanged=!1}handleClickEvent(e,t,i){if(e instanceof F)return t.dropFocus(p.Pointer,this.widget),this.pointerPos=null,this.setClickState(0,!1);if(e instanceof w){this.pointerPos=this.getNormalInRect(e.x,e.y,...i);let r=this.isNormalInRect(...this.pointerPos);if(r)t.pointerStyle="pointer";else if(e.target===null)return t.dropFocus(p.Pointer,this.widget),this.setClickState(0,!1);return e instanceof R&&e.button===this.pointerButton?(this.startingPointerPos=this.pointerPos,t.requestFocus(p.Pointer,this.widget),this.setClickState(2,r)):e instanceof L&&e.button===this.pointerButton?(t.dropFocus(p.Pointer,this.widget),r?this.setClickState(1,r):this.setClickState(0,r)):e.target===null?this.setClickState(1,r):this.setClickState(2,r)}else this.clickStateChanged=!1}};var k=class extends w{constructor(e,t,i,r,n,s,o,l,h=null){super(e,t,s,o,l,h,p.Pointer);this.deltaX=i,this.deltaY=r,this.fromDrag=n}correctOffset(e,t){return new k(this.x-e,this.y-t,this.deltaX,this.deltaY,this.fromDrag,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(e){return new k(this.x,this.y,this.deltaX,this.deltaY,this.fromDrag,this.shift,this.ctrl,this.alt,e)}};var me=class extends ${constructor(e,t,i){super(e,!1,t,i);this.backgroundDirty=!0}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this.backgroundDirty=!0):e==="canvasFill"?this.backgroundDirty=!0:e==="containerPadding"?this._layoutDirty=!0:e==="containerAlignment"&&(this._layoutDirty=!0)}handleEvent(e,t){return this.child.dispatchEvent(e,t)}handlePreLayoutUpdate(e){let t=this.child;t.preLayoutUpdate(e),t.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(e){let t=this.child;t.postLayoutUpdate(e),t.dirty&&(this._dirty=!0),this.backgroundDirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=this.containerPadding,s=n.left+n.right,o=n.top+n.bottom,l=t-s,h=r-o;l<0&&(l=0),h<0&&(h=0);let d=this.containerAlignment,u=0;d.horizontal===v.Stretch&&(l!==1/0?u=l:u=Math.max(e-s,0));let m=0;d.vertical===v.Stretch&&(h!==1/0?m=h:m=Math.max(i-o,0));let[c,f]=this.child.dimensions;this.child.resolveDimensions(u,l,m,h);let[g,T]=this.child.dimensions,[_,P]=[this.width,this.height];this.width=Math.max(e,g+s),this.height=Math.max(i,T+o),(this.width!==_||this.height!==P||g!==c||T!==f)&&(this.backgroundDirty=!0)}afterPositionResolved(){let e=this.containerPadding,t=this.containerAlignment,[i,r]=this.child.dimensions,n=i+e.left+e.right,s=r+e.top+e.bottom,o=this.x+e.left;if(t.horizontal!==v.Stretch){let u=this.width-n;u>0&&(o+=u*t.horizontal)}let l=this.y+e.top;if(t.vertical!==v.Stretch){let u=this.height-s;u>0&&(l+=u*t.vertical)}let[h,d]=this.child.position;this.child.resolvePosition(o,l),(h!==o||d!==l)&&(this.backgroundDirty=!0)}handleBaseContainerPainting(e,t,i=null){(this.backgroundDirty||t)&&(this.clearStart(e,i),e.rect(...this.roundRect(this.x,this.y,this.width,this.height)),e.rect(...this.roundRect(...this.child.position,...this.child.dimensions,!0)),this.clearEnd(e,"evenodd"),this.backgroundDirty=!1),this.child.paint(e,t)}handlePainting(e,t){this.handleBaseContainerPainting(e,t)}dryPaint(){this.backgroundDirty=!1,super.dryPaint()}};var pe=class extends me{constructor(e,t=null,i){super(e,!1,i);this.clickHelper=new I(this),this.callback=t}handleEvent(e,t){if(e instanceof k)return null;if(this.callback===null)return this.clickHelper.clickStateChanged=!1,this;if(this.clickHelper.handleClickEvent(e,t,[this.x,this.x+this.width,this.y,this.y+this.height]),this.clickHelper.clickStateChanged&&this.clickHelper.wasClick)try{this.callback()}catch(i){console.error("Exception in Icon callback",i)}return this}};var Ee=class extends pe{constructor(e,t=null,i){super(e,t,i);this.backgroundProperty="backgroundFill";this.forced=!1;this.childTheme=new S({canvasFill:this.getBackgroundFill()}),this.child.inheritedTheme=this.childTheme}updateBackground(){let e=this.backgroundProperty;if(this.forced)this.backgroundProperty="primaryFill";else switch(this.clickHelper.clickState){case x.Hold:this.backgroundProperty="accentFill";break;case x.Hover:this.backgroundProperty="backgroundGlowFill";break;default:this.backgroundProperty="backgroundFill";break}e!==this.backgroundProperty&&(this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill())}getBackgroundFill(){switch(this.backgroundProperty){case"primaryFill":return this.primaryFill;case"accentFill":return this.accentFill;case"backgroundGlowFill":return this.backgroundGlowFill;case"backgroundFill":return this.backgroundFill;default:throw new Error(`Unknown theme property: ${this.backgroundProperty}`)}}set inheritedTheme(e){e!==this.fallbackTheme&&(this.fallbackTheme=e,this.childTheme.fallbackTheme=e)}get inheritedTheme(){return this.fallbackTheme}onThemeUpdated(e=null){e===null?(this._layoutDirty=!0,this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill()):e===this.backgroundFill?(this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill()):e==="containerPadding"?this._layoutDirty=!0:e==="containerAlignment"&&(this._layoutDirty=!0)}handleEvent(e,t){let i=super.handleEvent(e,t);return this.clickHelper.clickStateChanged&&this.updateBackground(),i}handlePainting(e,t){this.handleBaseContainerPainting(e,t,this.getBackgroundFill())}},We=Ee;b([Fe(Ee.prototype.updateBackground)],We.prototype,"forced",2);var fe=null;function Se(a,e){if(fe===null&&(fe=document.createElement("canvas").getContext("2d"),fe===null))throw new Error("Failed to get canvas context");return fe.font=e,fe.measureText(a)}var ut=new Set([`
`,"	"]),re;(function(t){t[t.Normal=0]="Normal",t[t.Shrink=1]="Shrink"})(re||(re={}));var E=class{constructor(){this.text="";this.font="";this.maxWidth=1/0;this.lineHeight=null;this.lineSpacing=null;this.tabWidth=4;this.wrapMode=0;this._width=0;this._height=0;this._lineHeight=0;this._lineSpacing=0;this._tabWidth=0;this.measureDirty=!0;this.lineHeightSpacingDirty=!0;this.tabWidthDirty=!0;this._dirty=!1;this._lineRanges=[]}get dirty(){let e=this._dirty;return this._dirty=!1,e}measureTextSlice(e,t,i){let r=Se(this.text.slice(t,i),this.font);return e===0?r.width+Math.max(0,r.actualBoundingBoxLeft):e+r.width}getLineRangeWidthUntil(e,t){if(t<=e[0][0])return 0;let i=0;for(;i<e.length;i++){let s=e[i],o=s[1];if(t==o)return s[2];if(t>=s[0]&&t<o)break}if(i===e.length)return e[i-1][2];let r=0;i>0&&(r=e[i-1][2]);let n=e[i];return n[3]?r+n[2]*(t-n[0])/(n[1]-n[0]):this.measureTextSlice(r,n[0],t)}measureText(e,t,i,r){var u,m;let n=0;for(;n<r.length;n++){let c=r[n];if(e>=c[0]&&e<c[1]){e=c[0];break}}if(n>0){let c=r[n-1];c[1]!==e&&(e=c[1],--n>0?c=r[n]:c=null),c!==null&&!c[3]&&!ut.has(this.text[e])&&(e=c[0],n--)}let s=0;n>0&&(s=r[n-1][2]);let o=e,l=[];for(;o<t;)if(this.text[o]==="	"){let c=this.actualTabWidth;s=(Math.floor(s/c)+1)*c,l.push([o,++o,s,!0])}else if(this.text[o]===`
`){l.push([o,++o,s,!0]),o<t&&console.warn("measureText called with text range where newline was at the middle of the range instead of at the end. Some text was ignored");break}else{let c=this.text.indexOf(`
`,o+1);c===-1&&(c=1/0);let f=this.text.indexOf("	",o+1);f===-1&&(f=1/0);let g=Math.min(c,f,t);s=this.measureTextSlice(s,o,g),l.push([o,g,s,!1]),o=g}let h=n+l.length,d=(m=(u=l[l.length-1])!=null?u:r[n-1])!=null?m:null;return d===null?(r.length=0,r.push([e,e,0,!1]),!0):h===1&&d[1]-d[0]<=1||d[2]<=i?(r.length=n,r.push(...l),!0):!1}updateTextDims(){if(this.lineHeightSpacingDirty){this.lineHeightSpacingDirty=!1;let t=this._lineHeight,i=this._lineSpacing;if(this.lineHeight===null||this.lineSpacing===null){let r=Se("~!@#$%^&*()_+`1234567890-=qwertyuiop[]\\QWERTYUIOP{}|asdfghjkl;'ASDFGHJKL:\"zxcvbnm,./ZXCVBNM<>?",this.font);this.lineHeight===null?this._lineHeight=r.actualBoundingBoxAscent:this._lineHeight=this.lineHeight,this.lineSpacing===null?this._lineSpacing=r.actualBoundingBoxDescent:this._lineSpacing=this.lineSpacing}else this._lineHeight=this.lineHeight,this._lineSpacing=this.lineSpacing;(t!==this._lineHeight||i!==this._lineSpacing)&&(this.measureDirty=!0)}if(this.tabWidthDirty&&(this.tabWidthDirty=!1,this._tabWidth=Se(" ",this.font).width*this.tabWidth),!this.measureDirty)return;this.measureDirty=!1;let e=this._lineHeight+this._lineSpacing;if(this.text.length===0)this._height=e,this._width=this.maxWidth===1/0?0:this.maxWidth,this._lineRanges.length=1,this._lineRanges[0]=[[0,0,0,!1]];else if(this.maxWidth===1/0){this._lineRanges.length=0;let t=0;this._height=0,this._width=0;let i=this.text;for(;;){let r=this.text.indexOf(`
`,t),n=r===-1,s=n?i.length:r+1,o=[];this.measureText(t,s,1/0,o),this._lineRanges.push(o),this._height+=e;let l=o[o.length-1][2];if(l>this._width&&(this._width=l),n)break;t=s}}else{this._lineRanges.length=0;let t=[],i=this.text,r=/\s/,n=-1;for(let s=0;s<=i.length;){let o=r.test(i[s]),l=s===i.length;if(o||l){if(n>=0&&!this.measureText(n,s,this.maxWidth,t)){let h=[];if(this.measureText(n,s,this.maxWidth,h)){if(t.length===0)throw new Error("Unexpected line range without any render groups");this._lineRanges.push(t),t=h}else{let d=n;for(;d<s-1&&this.measureText(d,d+1,this.maxWidth,t);d++);this._lineRanges.push(t),t=h,s=d,n=d;continue}}if(n=-1,l){if(t.length===0){let h=this._lineRanges[this._lineRanges.length-1];if(h===void 0)t.push([0,0,0,!1]);else{let d=h[h.length-1];d===void 0?t.push([0,0,0,!1]):t.push([d[1],d[1],0,!1])}}this._lineRanges.push(t);break}if(i[s]===`
`)this.measureText(s,s+1,1/0,t),this._lineRanges.push(t),t=[];else if(!this.measureText(s,s+1,this.maxWidth,t))if(this.wrapMode===1){let h=s;do s++;while(i[s]!==`
`&&r.test(i[s]));let d=t[t.length-1];t.push([h,s,d!==void 0?d[2]:0,!0]),this._lineRanges.push(t),t=[];continue}else this._lineRanges.push(t),t=[],this.measureText(s,s+1,1/0,t)}else n===-1&&(n=s);s++}this._width=this.maxWidth,this._height=e*this._lineRanges.length}}paint(e,t,i,r){e.save(),e.beginPath(),e.rect(i,r,this.width,this.height),e.clip(),e.font=this.font,e.fillStyle=t,e.textBaseline="alphabetic";let n=this.fullLineHeight,s=r+this._lineHeight;for(let o of this._lineRanges){let l=0;for(let h of o)!h[3]&&h[2]>l&&e.fillText(this.text.slice(h[0],h[1]),i+l,s),l=h[2];s+=n}e.restore()}findOffsetFromIndex(e){let t=this.lineRanges;if(e<=0||t.length===0)return[0,0];let i=0;for(let r of t){if(e<r[r.length-1][1])break;i++}return i>=t.length&&(i=t.length-1,e=this.text.length),[this.getLineRangeWidthUntil(t[i],e),i*this.fullLineHeight]}findIndexOffsetFromOffset(e){let t=this.fullLineHeight;if(this.text===""||e[0]<=0&&e[1]<t||e[1]<0)return[0,[0,0]];let i=Math.floor(e[1]/t),r=this.lineRanges;if(i>=r.length){let d=this.text.length;return[d,this.findOffsetFromIndex(d)]}let n=i*t,s=r[i];if(s.length===1&&s[0][0]===s[0][1])return[s[0][0],[s[0][2],n]];let o=0,l=s[0][0],h=s[s.length-1][1];this.text[h-1]===`
`&&h--;for(let d=l;d<h;d++){let u=this.getLineRangeWidthUntil(s,d+1),m=(u+o)/2;if(e[0]<m)return[d,[o,n]];o=u}return[h,[o,n]]}getLine(e){if(e<=0)return 0;let t=this.lineRanges;for(let i=0;i<t.length;i++){let r=t[i],n=r[r.length-1];if(e<n[1])return i}return t.length-1}getLineStart(e){if(e<=0)return 0;let t=this.lineRanges;if(e>=t.length){let i=t[t.length-1];return i[i.length-1][1]}return t[e][0][0]}getLineEnd(e,t=!0){if(e<0)return 0;let i=this.lineRanges;if(e>=i.length){let o=i[i.length-1];return o[o.length-1][1]}let r=i[e],n=r[r.length-1],s=n[1];return!t&&s>0&&this.text[s-1]===`
`&&n[0]!==n[1]?s-1:s}get width(){return this.updateTextDims(),this._width}get height(){return this.updateTextDims(),this._height}get lineRanges(){return this.updateTextDims(),[...this._lineRanges]}get actualLineHeight(){return this.updateTextDims(),this._lineHeight}get actualLineSpacing(){return this.updateTextDims(),this._lineSpacing}get actualTabWidth(){return this.updateTextDims(),this._tabWidth}get fullLineHeight(){return this.updateTextDims(),this._lineHeight+this._lineSpacing}};b([H(["_dirty","measureDirty"])],E.prototype,"text",2),b([H(["_dirty","measureDirty","lineHeightSpacingDirty","tabWidthDirty"])],E.prototype,"font",2),b([H(["_dirty","measureDirty"])],E.prototype,"maxWidth",2),b([H(["_dirty","measureDirty","lineHeightSpacingDirty"])],E.prototype,"lineHeight",2),b([H(["_dirty","measureDirty","lineHeightSpacingDirty"])],E.prototype,"lineSpacing",2),b([H(["_dirty","measureDirty","tabWidthDirty"])],E.prototype,"tabWidth",2),b([H(["_dirty","measureDirty"])],E.prototype,"wrapMode",2);var ne=class extends C{constructor(e,t){super(!0,!1,t);this.textGetter=null;this.wrapText=!0;this.textHelper=new E,this.textHelper.wrapMode=re.Shrink,this.source=e}set source(e){e instanceof Function?this.textGetter=e:(this.textGetter=null,this.textHelper.text=e)}get source(){return this.textGetter!==null?this.textGetter:this.textHelper.text}get text(){return this.textHelper.text}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="bodyTextFont"||e==="labelMinWidth"||e==="labelMinAscent"||e==="labelMinDescent"?(this._layoutDirty=!0,this._dirty=!0):e==="bodyTextFill"&&(this._dirty=!0)}handlePreLayoutUpdate(e){this.textGetter!==null&&(this.textHelper.text=this.textGetter()),this.textHelper.font=this.bodyTextFont,this.textHelper.lineHeight=this.bodyTextHeight,this.textHelper.lineSpacing=this.bodyTextSpacing,this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handleResolveDimensions(e,t,i,r){this.textHelper.maxWidth=this.wrapText?t:1/0,this.textHelper.dirty&&(this._dirty=!0),this.width=Math.max(Math.min(this.textHelper.width,t),e),this.height=Math.max(Math.min(this.textHelper.height,r),i)}handlePainting(e,t){this.wrapText||(e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip()),this.textHelper.paint(e,this.bodyTextFill,this.x,this.y),this.wrapText||e.restore()}};b([V],ne.prototype,"wrapText",2);var ge=class extends We{constructor(e,t=null,i){let r=K({},i);r.containerAlignment={horizontal:v.Center,vertical:v.Stretch};let n=new ne(e,i);n.wrapText=!1,super(n,t,r)}};var Me=class extends ie{constructor(e,t=null,i,r=0,n=24,s=24,o){t===null&&(t=e);function l(){return i.shift?t===null?e:t:e}super(new ge(l,()=>i.callback(l()),o),[n,1/0,s,1/0],o);this.flex=r}};var He=class extends de{add(e){if(Array.isArray(e))for(let t of e)this._children.push(t),t.inheritedTheme=this.inheritedTheme;else this._children.push(e),e.inheritedTheme=this.inheritedTheme;return this._layoutDirty=!0,this._dirty=!0,this}remove(e){if(Array.isArray(e))for(let t of e){let i=this._children.indexOf(t);i!==-1&&this._children.splice(i,1)}else{let t=this._children.indexOf(e);t!==-1&&this._children.splice(t,1)}return this._layoutDirty=!0,this._dirty=!0,this}clearChildren(){return this._children.length=0,this._layoutDirty=!0,this._dirty=!0,this}};var ye=class extends He{constructor(e,t){super([],!1,!0,t);this.backgroundDirty=!0;this.unusedSpace=0;this.enabledChildCount=0;this.vertical=e}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this.backgroundDirty=!0):e==="canvasFill"?this.backgroundDirty=!0:e==="multiContainerAlignment"?this._layoutDirty=!0:e==="multiContainerSpacing"&&(this._layoutDirty=!0)}handleEvent(e,t){for(let i of this.children){if(!i.enabled)continue;let r=i.dispatchEvent(e,t);if(r!==null)return r}return null}handlePreLayoutUpdate(e){for(let t of this.children)t.preLayoutUpdate(e),t.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(e){for(let t of this.children)t.postLayoutUpdate(e),t.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=0,s=0,o=0,l=this.vertical?r:t;this.multiContainerAlignment.cross===v.Stretch&&(o=this.vertical?t:r,o==1/0&&(o=this.vertical?e:i)),this.enabledChildCount=0;for(let y of this.children){if(!y.enabled)continue;this.enabledChildCount++;let[W,D]=y.dimensions;this.vertical?y.resolveDimensions(o,t,0,1/0):y.resolveDimensions(0,1/0,o,r);let[M,O]=y.dimensions;n+=y.flex,s=Math.max(this.vertical?M:O,s),(M!==W||O!==D)&&(this.backgroundDirty=!0)}let d=this.vertical?e:i;s<d&&(s=d);let u=this.multiContainerSpacing,m=Math.max(this.enabledChildCount-1,0)*u;for(let y of this.children)!y.enabled||(m+=this.vertical?y.dimensions[1]:y.dimensions[0]);let c=l-m;if(c==1/0||c<=0){let y=this.width,W=this.height;this.vertical?(this.width=s,this.height=Math.min(m,r)):(this.width=Math.min(m,t),this.height=s),(this.width!==y||this.height!==W)&&(this.backgroundDirty=!0),this.unusedSpace=0;let D=l;for(let M of this.children){if(!M.enabled)continue;let[O,ee]=M.dimensions;if(this.vertical){let oe=Math.min(D,ee);M.resolveDimensions(o,t,oe,oe)}else{let oe=Math.min(D,O);M.resolveDimensions(oe,oe,o,r)}let[N,st]=M.dimensions;(N!==O||st!==ee)&&(this.backgroundDirty=!0);let ot=this.vertical?ee:O;D=Math.max(0,D-ot-u)}return}let f=0,g=0;n>0&&(g=c/n);for(let y of this.children){if(!y.enabled)continue;f!==0&&(f+=u);let W=g*y.flex,[D,M]=y.dimensions;if(this.vertical){let N=W+M;y.resolveDimensions(o,t,N,N)}else{let N=W+D;y.resolveDimensions(N,N,o,r)}let[O,ee]=y.dimensions;f+=this.vertical?ee:O,(O!==D||ee!==M)&&(this.backgroundDirty=!0)}let T=this.width,_=this.height,P;this.vertical?(P=r,this.width=s,this.height=P):(P=t,this.width=P,this.height=s),(this.width!==T||this.height!==_)&&(this.backgroundDirty=!0),this.unusedSpace=Math.max(P-f,0)}afterPositionResolved(){let e=this.multiContainerAlignment,t=e.main===U.SpaceAround,i=e.main===U.SpaceBetween||t,r=i?0:e.main,n=e.cross===v.Stretch?0:e.cross,s=this.enabledChildCount-1+(t?2:0),o;s<=0?o=0:o=this.unusedSpace/s;let l=this.multiContainerSpacing;i&&(l+=o);let h=(this.vertical?this.y:this.x)+r*this.unusedSpace;t&&(h+=o);for(let d of this.children){if(!d.enabled)continue;let[u,m]=d.position,[c,f]=d.dimensions;this.vertical?(d.resolvePosition(this.x+n*(this.width-c),h),h+=f+l):(d.resolvePosition(h,this.y+n*(this.height-f)),h+=c+l);let[g,T]=d.position;(g!==u||T!==m)&&(this.backgroundDirty=!0)}}handlePainting(e,t){let i=[];for(let r of this.children)!r.enabled||(r.paint(e,t),(this.backgroundDirty||t)&&i.push(this.roundRect(...r.position,...r.dimensions)));if(this.backgroundDirty||t){this.clearStart(e),e.rect(...this.roundRect(this.x,this.y,this.width,this.height));for(let r of i)e.rect(...r);this.clearEnd(e,"evenodd")}this.backgroundDirty=!1}dryPaint(){this.backgroundDirty=!1,super.dryPaint()}};var be=class extends ye{constructor(e){super(!1,e)}};var Le=class extends be{constructor(e,t,i=0,r=24,n=24,s){super(s);for(let o of e)if(typeof o=="function"){let l=o;this.add(l(t,s))}else if(typeof o[0]=="string"&&typeof o[1]=="string"){let l=o[0],h=o[1];for(let d=0;d<l.length;d++){let u=null;d<h.length&&(u=h[d]),this.add(new Me(l[d],u,t,i,r,n,s))}}else throw new Error(`Unknown virtual key row template format for entry: ${o}`)}};var G=class extends ie{constructor(e,t,i=0,r=24,n=24,s){super(new ge(e,t,s),[r,1/0,n,1/0],s);this.flex=i}};var Y=class extends G{constructor(e,t,i,r=0,n=24,s=24,o){super(e,()=>i.callback(t),r,n,s,o)}};var Ke=class extends Y{constructor(e,t=0,i=60,r=24,n){super("Backspace","Backspace",e,t,i,r,n)}};var Ve=class extends Y{constructor(e,t=0,i=24,r=24,n){super("Esc","Escape",e,t,i,r,n)}};var Ie=class extends Y{constructor(e,t=0,i=72,r=24,n){super("Enter","Enter",e,t,i,r,n)}};var Ae=class extends G{constructor(e,t=0,i=84,r=24,n){super("Shift",()=>{e.shift=!e.shift,this.child.forced=e.shift,e.callback("Shift")},t,i,r,n);this.child.forced=e.shift}};var Be=class extends Y{constructor(e,t=1,i=84,r=24,n){super("Space"," ",e,t,i,r,n)}};var Oe=class extends ye{constructor(e){super(!0,e)}};function ct(a,e){return new Ie(a,void 0,void 0,void 0,e)}function mt(a,e){return new Ae(a,void 0,void 0,void 0,e)}function pt(a,e){return new Ke(a,void 0,void 0,void 0,e)}function ft(a,e){return new Be(a,void 0,void 0,void 0,e)}function gt(a,e){return new Ve(a,void 0,void 0,void 0,e)}var ve=[[["`1234567890-=","~!@#$%^&*()_+"]],[["qwertyuiop[]\\","QWERTYUIOP{}|"]],[["asdfghjkl;'",'ASDFGHJKL:"'],ct],[mt,["zxcvbnm,./","ZXCVBNM<>?"]],[pt,ft,gt]],xe=class extends Oe{constructor(e,t=ve,i=0,r=24,n=24,s){let o=K({},s);o.multiContainerAlignment={main:U.SpaceBetween,cross:v.Stretch},super(o);let l={callback:h=>{e.keyPress(h,l.shift,l.ctrl,l.alt)},shift:!1,ctrl:!1,alt:!1};for(let h of t)this.add(new Le(h,l,i,r,n,o))}};var j=class extends me{constructor(e,t){super(e,!0,t)}};var Te=class extends j{constructor(e,t){let i=K({},t);i.containerAlignment={horizontal:v.Center,vertical:v.Center},super(e,i)}};var yt=class extends Re{constructor(e,t=ve,i=new S){super(new Te(new xe(e,t)),i);this.keyboardDriver=e}update(){this.enabled=this.keyboardDriver.getFocusedRoot()!==null,super.update()}};var bt=class extends ae{constructor(e,t=ve,i=null,r=new S){super(new Te(new xe(e,t)),i,r);this.keyboardDriver=e}updateVisibility(){this.enabled=this.keyboardDriver.getFocusedRoot()!==null}};var Pe=class extends he{constructor(e,t,i,r,n){super(t,i,r,n,p.Keyboard,!0);this.key=e}};var we=class extends Pe{cloneWithTarget(e){return new we(this.key,this.shift,this.ctrl,this.alt,e)}};var q=class extends Pe{cloneWithTarget(e){return new q(this.key,this.shift,this.ctrl,this.alt,e)}};var Ue=class{constructor(){this.eventQueues=new Map;this.keysDown=new Set;this.focus=null}getEventQueue(e){if(e===null)return null;let t=this.eventQueues.get(e);return typeof t=="undefined"?null:t}changeFocusedRoot(e){this.focus!==null&&this.focus.clearFocus(p.Keyboard),this.focus=e,this.keysDown.clear()}getFocusedRoot(){return this.focus}clearFocus(){this.changeFocusedRoot(null)}keyDown(e,t,i,r){this.keysDown.add(e);let n=this.getEventQueue(this.focus);n!==null&&n.push(new q(e,t,i,r,null))}keyUp(e,t,i,r){if(this.keysDown.delete(e)){let n=this.getEventQueue(this.focus);n!==null&&n.push(new we(e,t,i,r,null))}}keyPress(e,t,i,r){let n=this.isKeyDown(e);this.keyDown(e,t,i,r),n||this.keyUp(e,t,i,r)}isKeyDown(e){return this.keysDown.has(e)}onEnable(e){this.eventQueues.has(e)||this.eventQueues.set(e,[])}onDisable(e){this.eventQueues.has(e)&&(this.eventQueues.delete(e),e===this.focus&&this.clearFocus())}update(e){let t=this.getEventQueue(e);if(t!==null){for(let i of t)e.dispatchEvent(i);t.length=0}}onFocusChanged(e,t,i){t===p.Keyboard&&(e==this.focus?i===null&&this.clearFocus():i!==null&&this.changeFocusedRoot(e))}onFocusCapturerChanged(e,t,i,r){}};var vt=new Set(["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp","Tab"," "]);function it(a){return[a.key,a.shiftKey,a.ctrlKey,a.altKey]}var xt=class extends Ue{constructor(){super(...arguments);this.domElems=new Set}bindDOMElem(e,t=!0){this.domElems.has(e)||(this.domElems.add(e),t&&(e.addEventListener("keydown",i=>{var r,n;vt.has(i.key)&&((n=(r=this.getFocusedRoot())==null?void 0:r.getFocus(p.Keyboard))!=null?n:null)!==null&&i.preventDefault(),this.keyDown(...it(i))}),e.addEventListener("keyup",i=>{this.keyUp(...it(i))})),e.addEventListener("blur",i=>{this.shouldClearFocus(i.relatedTarget)&&this.clearFocus()}))}shouldClearFocus(e){return e===null||!this.domElems.has(e)}};function Ge(a,e){let t=e.getBoundingClientRect();return[(a.clientX-t.left)/t.width,(a.clientY-t.top)/t.height]}var X=class extends w{constructor(e,t,i,r,n,s=null){super(e,t,i,r,n,s,p.Pointer)}correctOffset(e,t){return new X(this.x-e,this.y-t,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(e){return new X(this.x,this.y,this.shift,this.ctrl,this.alt,e)}};var A;(function(i){i[i.None=0]="None",i[i.Hovering=1]="Hovering",i[i.Pressing=2]="Pressing"})(A||(A={}));var _e=class{constructor(){this.states=new Map;this.nextPointerID=0;this.hints=new Map;this.dragToScroll=new Map}unassignPointer(e,t){t.pointer!==null&&this.setPointerHint(t.pointer,A.None),t.pointer=null,t.hovering&&t.eventQueue.push(new F(e.getFocusCapturer(p.Pointer))),t.hovering=!1,t.pressing=0,t.dragLast=null}registerPointer(e=!1){let t=this.nextPointerID++;return this.setPointerHint(t,A.None),this.dragToScroll.set(t,e),t}unregisterPointer(e){for(let[t,i]of this.states)i.pointer===e&&this.unassignPointer(t,i);this.hints.delete(e),this.dragToScroll.delete(e)}canQueueEvent(e,t,i,r){let n=i.pointer===null;n&&(i.pointer=t);let s=i.pointer===t;if(!s||n)for(let[o,l]of this.states)o!==e&&l.pointer===t&&this.unassignPointer(o,l);return!s&&(!r||i.pressing>0)?!1:(r&&i.pointer!==t&&(this.unassignPointer(e,i),i.pointer=t),!0)}denormaliseCoords(e,t,i){let[r,n]=e.dimensions;return[t*r,i*n]}movePointer(e,t,i,r,n,s,o,l){let h=this.states.get(e);if(typeof h=="undefined"||(n===null&&(n=h.pressing),!this.canQueueEvent(e,t,h,n>0)))return;h.hovering=!0;let[d,u]=this.denormaliseCoords(e,i,r);if(n!==h.pressing){let m=Math.floor(Math.log2(Math.max(n,h.pressing)));for(let c=0;c<=m;c++){let f=(h.pressing>>c&1)==1,g=(n>>c&1)==1;f!==g&&(g?h.eventQueue.push(new R(d,u,c,s,o,l)):h.eventQueue.push(new L(d,u,c,s,o,l)))}h.pressing=n}else h.eventQueue.push(new X(d,u,s,o,l));h.pressing>0?this.setPointerHint(t,A.Pressing):this.setPointerHint(t,A.Hovering)}leavePointer(e,t){let i=this.states.get(e);typeof i!="undefined"&&i.hovering&&i.pointer==t&&(i.hovering=!1,i.pressing=0,i.dragLast=null,i.eventQueue.push(new F(e.getFocusCapturer(p.Pointer))),this.setPointerHint(t,A.None))}leaveAnyPointer(e){for(let t of this.states.keys())this.leavePointer(t,e)}wheelPointer(e,t,i,r,n,s,o,l,h){let d=this.states.get(e);if(typeof d=="undefined"||!this.canQueueEvent(e,t,d,!0))return;d.hovering=!0;let[u,m]=this.denormaliseCoords(e,i,r);d.eventQueue.push(new k(u,m,n,s,!1,o,l,h))}setPointerHint(e,t){return this.hints.get(e)!==t?(this.hints.set(e,t),!0):!1}getPointerHint(e){var t;return(t=this.hints.get(e))!=null?t:A.None}onEnable(e){this.states.set(e,{eventQueue:[],pointer:null,pressing:0,hovering:!1,dragLast:null,dragOrigin:[0,0]})}onDisable(e){e.dispatchEvent(new F);let t=this.states.get(e);typeof t!="undefined"&&t.pointer!==null&&(this.setPointerHint(t.pointer,A.None),t.dragLast=null),this.states.delete(e)}update(e){let t=this.states.get(e);if(typeof t=="undefined")return;let i=t.pointer===null?!1:this.dragToScroll.get(t.pointer);for(let r of t.eventQueue){if(r instanceof w&&t.dragLast!==null){let[n,s]=t.dragLast;e.dispatchEvent(new k(...t.dragOrigin,n-r.x,s-r.y,!1,!1,!1,!0)),r instanceof L?t.dragLast=null:(t.dragLast[0]=r.x,t.dragLast[1]=r.y);continue}e.dispatchEvent(r)?t.dragLast=null:i&&r instanceof R&&(t.dragLast=[r.x,r.y],t.dragOrigin[0]=r.x,t.dragOrigin[1]=r.y)}t.eventQueue.length=0}onFocusChanged(e,t,i){}onFocusCapturerChanged(e,t,i,r){}};function rt(a){return[a.shiftKey,a.ctrlKey,a.altKey]}var Tt=class extends _e{constructor(){super();this.domElems=new WeakMap;this.pointers=new Map;this.mousePointerID=this.registerPointer(!1)}bindDOMElem(e,t){let i=this.domElems.get(e);typeof i!="undefined"?this.removeListeners(i):(i={domElem:t,pointerListen:null,pointerleaveListen:null,wheelListen:null,contextMenuListen:null},this.domElems.set(e,i),t.style.touchAction="none"),e.enabled&&this.addListeners(e,i)}getPointerID(e){let t=this.pointers.get(e.pointerId);return typeof t=="undefined"&&(e.pointerType==="mouse"?t=this.mousePointerID:t=this.registerPointer(!0),this.pointers.set(e.pointerId,t)),t}addListeners(e,t){let i=t.domElem;t.pointerListen=r=>{this.movePointer(e,this.getPointerID(r),...Ge(r,i),r.buttons,...rt(r))},t.pointerleaveListen=r=>{this.leavePointer(e,this.getPointerID(r))},t.wheelListen=r=>{let n=r.deltaX,s=r.deltaY;n===0&&r.getModifierState("Shift")&&(n=s,s=0),this.wheelPointer(e,this.mousePointerID,...Ge(r,i),r.deltaX,r.deltaY,...rt(r))},t.contextMenuListen=r=>{r.preventDefault()},i.addEventListener("pointermove",t.pointerListen),i.addEventListener("pointerdown",t.pointerListen),i.addEventListener("pointerup",t.pointerListen),i.addEventListener("pointerleave",t.pointerleaveListen),i.addEventListener("wheel",t.wheelListen),i.addEventListener("contextmenu",t.contextMenuListen)}removeListeners(e){e.pointerListen!==null&&(e.domElem.removeEventListener("pointermove",e.pointerListen),e.domElem.removeEventListener("pointerdown",e.pointerListen),e.domElem.removeEventListener("pointerup",e.pointerListen),e.pointerListen=null),e.pointerleaveListen!==null&&(e.domElem.removeEventListener("pointerleave",e.pointerleaveListen),e.pointerleaveListen=null),e.wheelListen!==null&&(e.domElem.removeEventListener("wheel",e.wheelListen),e.wheelListen=null),e.contextMenuListen!==null&&(e.domElem.removeEventListener("contextmenu",e.contextMenuListen),e.contextMenuListen=null)}onEnable(e){super.onEnable(e);let t=this.domElems.get(e);typeof t!="undefined"&&this.addListeners(e,t)}onDisable(e){super.onDisable(e);let t=this.domElems.get(e);typeof t!="undefined"&&this.removeListeners(t)}};var Pt=class extends _e{constructor(){super(...arguments);this.sources=new Set}handlePointerRay(e,t,i,r,n,s,o){let[l,h,d]=this.castRay(i,r);l===null?this.leaveAnyPointer(e):this.movePointer(l,e,h,d,t,n,s,o)}addSource(e){this.sources.has(e)||(e.setRayPointerDriver(this),this.sources.add(e))}setPointerHint(e,t){let i=super.setPointerHint(e,t);for(let r of this.sources)r.onPointerHintChanged(e,t);return i}};var Z=class{constructor(e,t=null){this._dirty=!1;this._value=e,this.callback=t}get value(){return this._value}set value(e){this.setValue(e)}get dirty(){let e=this._dirty;return this._dirty=!1,e}setValue(e,t=!0){if(this._value!==e&&(this._value=e,this._dirty=!0,t&&this.callback!==null))try{this.callback(e)}catch(i){console.error("Exception in Variable callback",i)}}};var wt=class extends S{constructor(e=new S){super(void 0,e)}get canvasFill(){return"#"+Math.floor(Math.random()*16777215).toString(16)}set canvasFill(e){super.canvasFill=e}};function ms(a,e,t=null){return i=>{let r=!0,n=i;for(let s of a)if([r,n]=s(n),!r)return[!1,e];if(t!==null)try{t(n)}catch(s){console.warn("Exception in CompositeValidator callback:",s)}return[!0,n]}}function _t(a){return[!0,a]}function nt(a=null){return a===null?_t:e=>(a(e),[!0,e])}var kt=/^-?(\.\d+|\d+(\.(\d+)?)?)(e\d+)?$/;function gs(a){return kt.test(a)?[!0,parseFloat(a)]:[!1,NaN]}var Ft=/^-?\d+$/;function bs(a){return Ft.test(a)?[!0,parseInt(a)]:[!1,NaN]}function xs(a,e){return t=>t<a?[!1,t]:t>e?[!1,t]:[!0,t]}var Ct=class extends G{constructor(e,t=0,i=42,r=24,n){super("Alt",()=>{e.alt=!e.alt,this.child.forced=e.alt,e.callback("Alt")},t,i,r,n);this.child.forced=e.alt}};var Wt=class extends G{constructor(e,t=0,i=42,r=24,n){super("Ctrl",()=>{e.ctrl=!e.ctrl,this.child.forced=e.ctrl,e.callback("Control")},t,i,r,n);this.child.forced=e.ctrl}};var se=class extends C{constructor(e,t=null,i="",r){super(!1,!1,r);this.blinkStart=0;this.blinkWasOn=null;this.cursorPos=0;this.cursorOffset=[0,0];this.selectPos=0;this.selectOffset=[0,0];this.cursorOffsetDirty=!1;this._editingEnabled=!0;this.hideText=!1;this.offset=[0,0];this.wrapText=!0;this.inputFilter=null;this.dragging=!1;this.lastClick=0;this.dragStart=-1;this.successiveClickCount=0;this.textHelper=new E,this.variable=new Z(i,n=>{let[s,o]=e(n);s&&(this._validValue=o),s!==this._valid&&(this._valid=s,this._dirty=!0)}),[this._valid,this._validValue]=e(i),this.inputFilter=t}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="inputTextInnerPadding"||e==="inputTextFont"||e==="inputTextMinAscent"||e==="inputTextMinDescent"?(this._layoutDirty=!0,this._dirty=!0):(e==="inputBackgroundFill"||e==="inputTextFill"||e==="inputTextFillInvalid"||e==="inputTextFillDisabled"||e==="cursorThickness")&&(this._dirty=!0)}get blinkOn(){if(this.blinkStart===0)return null;let e=this.blinkRate;return Math.trunc((Date.now()-this.blinkStart)/(500*e)%2)===0}get editingEnabled(){return this._editingEnabled}set editingEnabled(e){this._editingEnabled!==e&&(this._editingEnabled=e,e||(this.blinkStart=0,this.moveCursorTo(0,!1)),this._dirty=!0)}set text(e){this.variable.value=e}get text(){return this.variable.value}get displayedText(){return this.hideText?"\u25CF".repeat(this.variable.value.length):this.variable.value}get valid(){return this._valid}get validValue(){return this._validValue}get line(){return this.textHelper.getLine(this.cursorPos)}moveCursorTo(e,t){this.cursorPos=Math.min(Math.max(e,0),this.text.length),t||(this.selectPos=this.cursorPos),this.cursorOffsetDirty=!0,this._dirty=!0}moveCursor(e,t){this.moveCursorTo(this.cursorPos+e,t)}moveCursorFromOffset(e,t,i){[this.cursorPos,this.cursorOffset]=this.textHelper.findIndexOffsetFromOffset([e,t]),i||(this.selectPos=this.cursorPos,this.selectOffset=this.cursorOffset),this.blinkStart=Date.now(),this._dirty=!0}moveCursorLine(e,t){this.moveCursorFromOffset(this.cursorOffset[0],this.cursorOffset[1]+(.5+e)*this.textHelper.fullLineHeight,t)}moveCursorStart(e){this.moveCursorTo(this.textHelper.getLineStart(this.line),e)}moveCursorEnd(e){this.moveCursorTo(this.textHelper.getLineEnd(this.line,!1),e)}moveCursorWord(e,t){if(e==0)return;let i=/\w/,r=this.text,n=this.cursorPos;if(e>0)for(;e>0;){let s=!1;for(;n<=r.length;n++)if(n<r.length&&i.test(r[n]))s=!0;else if(s)break;e--}else for(;e<0;){n--;let s=!1;for(;n>=0;n--)if(n>=0&&i.test(r[n]))s=!0;else if(s)break;n++,e++}this.moveCursorTo(n,t)}deleteRange(e,t){e!==t&&(this.text=this.text.substring(0,e)+this.text.substring(t),this.cursorPos=this.selectPos=e,this.cursorOffsetDirty=!0)}deleteWord(e){if(e===0)return;if(this.cursorPos!==this.selectPos){this.deleteRange(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos));return}let t=this.cursorPos;this.moveCursorWord(e,!1),t!==this.cursorPos&&this.deleteRange(Math.min(t,this.cursorPos),Math.max(t,this.cursorPos))}insertText(e){if(!(this.inputFilter!==null&&!this.inputFilter(e)))if(this.selectPos===this.cursorPos)this.text=this.text.substring(0,this.cursorPos)+e+this.text.substring(this.cursorPos),this.moveCursor(e.length,!1);else{let t=Math.min(this.cursorPos,this.selectPos),i=Math.max(this.cursorPos,this.selectPos);this.text=this.text.substring(0,t)+e+this.text.substring(i),this.moveCursorTo(t+e.length,!1)}}deleteText(e){e!==0&&(this.cursorPos!==this.selectPos?this.deleteRange(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos)):e>0?this.text=this.text.substring(0,this.cursorPos)+this.text.substring(this.cursorPos+e):(this.text=this.text.substring(0,this.cursorPos+e)+this.text.substring(this.cursorPos),this.moveCursor(e,!1)))}selectRangeAt(e){let t=this.text,i=/\w/,r=i.test(t[e]),n=e;for(;e>=0&&i.test(t[e])===r;e--);let s=e+1;for(e=n;e<t.length&&i.test(t[e])===r;e++);return[s,e]}onFocusDropped(e,t){e===p.Keyboard&&(this.blinkStart=0)}handleEvent(e,t){if(!this._editingEnabled)return this;if(e instanceof F)return this.dragging=!1,this.lastClick=0,this;if(e instanceof k)return null;if(e instanceof w){if(t.pointerStyle="text",e instanceof R||e instanceof X){let i=e instanceof R&&e.isPrimary;if(i){this.dragging=!0;let n=new Date().getTime();n-this.lastClick<500?(this.successiveClickCount++,this.successiveClickCount>2&&(this.successiveClickCount=0)):this.successiveClickCount=0,this.lastClick=n}else if(!this.dragging)return this;let r=this.inputTextInnerPadding;if(this.moveCursorFromOffset(e.x-this.x-r+this.offset[0],e.y-this.y-r+this.offset[1],!i&&this.dragging),i&&(this.cursorPos!==this.dragStart&&(this.successiveClickCount=0),this.dragStart=this.cursorPos),this.successiveClickCount>0){let n,s;if(this.successiveClickCount===1){let[o,l]=this.selectRangeAt(this.dragStart),[h,d]=this.selectRangeAt(this.cursorPos);n=Math.min(o,h),s=Math.max(l,d)}else{let o=Math.min(this.cursorPos,this.dragStart),l=this.textHelper.getLine(o);n=this.textHelper.getLineStart(l);let h=Math.max(this.cursorPos,this.dragStart),d=this.textHelper.getLine(h);s=this.textHelper.getLineEnd(d)}this.cursorPos>=this.dragStart?(this.selectPos=n,this.cursorPos=s):(this.selectPos=s,this.cursorPos=n),this.cursorOffsetDirty=!0}t.requestFocus(p.Keyboard,this)}else e instanceof L&&e.isPrimary&&(this.dragging=!1,t.hasMobileTextInput&&t.getTextInput(this.text).then(i=>{i!==null&&this.text!==i&&(this.text=i,this.moveCursorTo(i.length,!1))}));return this}else if(e instanceof q){if(this.dragging=!1,this.lastClick=0,e.alt)return this;if(e.ctrl){if(e.key==="Backspace")this.deleteWord(-1);else if(e.key==="Delete")this.deleteWord(1);else if(e.key==="ArrowLeft")this.moveCursorWord(-1,e.shift);else if(e.key==="ArrowRight")this.moveCursorWord(1,e.shift);else if(e.key==="c"||e.key==="C"){if(this.cursorPos===this.selectPos)return this;let i=this.text.slice(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos));if(navigator.clipboard)navigator.clipboard.writeText(i);else return this}else return this;return this.blinkStart=Date.now(),this}if(e.key.length===1)this.insertText(e.key);else if(e.key==="Backspace")this.deleteText(-1);else if(e.key==="Delete")this.deleteText(1);else if(e.key==="ArrowLeft")this.moveCursor(-1,e.shift);else if(e.key==="ArrowRight")this.moveCursor(1,e.shift);else if(e.key==="ArrowUp")this.moveCursorLine(-1,e.shift);else if(e.key==="ArrowDown")this.moveCursorLine(1,e.shift);else if(e.key==="PageUp")this.moveCursorLine(-5,e.shift);else if(e.key==="PageDown")this.moveCursorLine(5,e.shift);else if(e.key==="Home")this.moveCursorStart(e.shift);else if(e.key==="End")this.moveCursorEnd(e.shift);else{if(e.key==="Escape")return t.dropFocus(p.Keyboard,this),this;if(e.key==="Enter")this.insertText(`
`);else if(e.key==="Tab")this.insertText("	");else return this}this.blinkStart=Date.now()}else e instanceof z&&e.target===this&&(this.insertText(e.text),this.blinkStart=Date.now());return this}handlePreLayoutUpdate(e){this.editingEnabled||e.dropFocus(p.Keyboard,this),this.blinkOn!==this.blinkWasOn&&(this._dirty=!0),this.textHelper.text=this.displayedText,this.textHelper.font=this.inputTextFont,this.textHelper.lineHeight=this.inputTextHeight,this.textHelper.lineSpacing=this.inputTextSpacing,this.cursorOffsetDirty&&(this.cursorOffset=this.textHelper.findOffsetFromIndex(this.cursorPos),this.selectPos===this.cursorPos?(this.selectOffset[0]=this.cursorOffset[0],this.selectOffset[1]=this.cursorOffset[1]):this.selectOffset=this.textHelper.findOffsetFromIndex(this.selectPos),this.cursorOffsetDirty=!1),this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handleResolveDimensions(e,t,i,r){let n=2*this.inputTextInnerPadding;this.textHelper.maxWidth=this.wrapText?Math.max(t-n,0):1/0,this.textHelper.dirty&&(this._dirty=!0);let s=Math.min(Math.max(this.inputTextMinWidth,e),t);this.width=Math.min(Math.max(s,this.textHelper.width+n),t),this.height=Math.min(Math.max(i,this.textHelper.height+n),r)}handlePostLayoutUpdate(e){let t=this.inputTextInnerPadding,i=this.textHelper.width,r=this.textHelper.height,n=this.width-t*2,s=this.height-t*2,o=this.offset,[l,h]=this.cursorOffset;if(i>n){let d=Math.min(20,n/2),u=o[0]+d,m=o[0]+n-d;l>m&&(o[0]+=l-m),l<u&&(o[0]-=u-l),o[0]+n>i&&(o[0]=i-n),o[0]<0&&(o[0]=0)}else o[0]=0;if(r>s){let d=this.textHelper.fullLineHeight,u=s<2*d?0:d/2,m=o[1]+u,c=o[1]+s-u-d;h>c&&(o[1]+=h-c),h<m&&(o[1]-=m-h),o[1]+s>r&&(o[1]=r-s),o[1]<0&&(o[1]=0)}else o[1]=0;this.offset=o}handlePainting(e,t){e.fillStyle=this.inputBackgroundFill,e.fillRect(this.x,this.y,this.width,this.height),e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip();let i=this.inputTextInnerPadding;if(this.cursorPos!==this.selectPos)if(e.fillStyle=this.inputSelectBackgroundFill,this.cursorOffset[1]===this.selectOffset[1]){let s=Math.min(this.cursorOffset[0],this.selectOffset[0]),o=Math.max(this.cursorOffset[0],this.selectOffset[0]);e.fillRect(this.x+i+s-this.offset[0],this.y+i+this.cursorOffset[1]-this.offset[1],o-s,this.textHelper.fullLineHeight)}else{let s,o;this.cursorOffset[1]<this.selectOffset[1]?(s=this.cursorOffset,o=this.selectOffset):(o=this.cursorOffset,s=this.selectOffset);let l=this.textHelper.fullLineHeight,h=this.width+this.offset[0]-s[0]-i;h>0&&e.fillRect(this.x+i+s[0]-this.offset[0],this.y+i+s[1]-this.offset[1],h,l);let d=o[0]+i-this.offset[0];d>0&&e.fillRect(this.x,this.y+i+o[1]-this.offset[1],d,l);let u=s[1]+l,m=o[1]-u;m>0&&e.fillRect(this.x,this.y+i+u-this.offset[1],this.width,m)}let r;this._editingEnabled?this._valid?r=this.inputTextFill:r=this.inputTextFillInvalid:r=this.inputTextFillDisabled,this.textHelper.paint(e,r,this.x+i-this.offset[0],this.y+i-this.offset[1]);let n=this.blinkOn;this.blinkWasOn=n,n&&(e.fillStyle=r,e.fillRect(this.x+i+this.cursorOffset[0]-this.offset[0],this.y+i+this.cursorOffset[1]-this.offset[1],this.cursorThickness,this.textHelper.fullLineHeight)),e.restore()}};b([H(["cursorOffsetDirty","_dirty"])],se.prototype,"hideText",2),b([Ce()],se.prototype,"offset",2),b([V],se.prototype,"wrapText",2);var St=class extends se{constructor(e=null,t="",i){let r=nt(e);super(r,null,t,i)}};var Dt=class extends j{constructor(e,t){let i=K({},t);i.containerAlignment={horizontal:v.Center,vertical:v.Center},i.containerPadding={left:0,right:0,top:0,bottom:0},super(e,i)}};var Ye=class extends C{constructor(e=null,t=!1,i){super(!0,!1,i);this.offsetX=0;this.offsetY=0;this.actualLength=0;this.variable=new Z(t,e),this.clickHelper=new I(this)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="checkboxLength"?(this._layoutDirty=!0,this._dirty=!0):(e==="backgroundGlowFill"||e==="backgroundFill"||e==="accentFill"||e==="primaryFill"||e==="checkboxInnerPadding")&&(this._dirty=!0)}set checked(e){this.variable.value=e}get checked(){return this.variable.value}handleEvent(e,t){if(e instanceof k)return null;let i=this.x+this.offsetX,r=this.y+this.offsetY;return this.clickHelper.handleClickEvent(e,t,[i,i+this.actualLength,r,r+this.actualLength]),this.clickHelper.clickStateChanged&&(this._dirty=!0,this.clickHelper.wasClick&&(this.checked=!this.checked)),this}handlePostLayoutUpdate(e){this.variable.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=this.checkboxLength;this.actualLength=Math.min(n,t,r),this.width=this.actualLength,this.height=this.actualLength,this.width<e&&(this.width=e),this.height<i&&(this.height=i),this.offsetX=(this.width-this.actualLength)/2,this.offsetY=(this.height-this.actualLength)/2}handlePainting(e,t){let i=this.clickHelper.clickState===x.Hover||this.clickHelper.clickState===x.Hold;i?e.fillStyle=this.backgroundGlowFill:e.fillStyle=this.backgroundFill;let r=this.offsetX+this.x,n=this.offsetY+this.y;if(e.fillRect(r,n,this.actualLength,this.actualLength),this.checked){i?e.fillStyle=this.accentFill:e.fillStyle=this.primaryFill;let s=this.checkboxInnerPadding,o=this.actualLength-s*2;o<=0?e.fillRect(r,n,this.actualLength,this.actualLength):e.fillRect(r+s,n+s,o,o)}}};var J=class extends C{constructor(e,t=null,i=null,r=null,n){super(!0,!1,n);this.lastSrc=null;this.rotation=0;this.imageWidth=null;this.imageHeight=null;this.offsetX=0;this.offsetY=0;this.actualWidth=0;this.actualHeight=0;this._image=e,this.imageWidth=t,this.imageHeight=i,this.viewBox=r}set image(e){e!==this._image&&(this._image=e,this.lastSrc=null)}get image(){return this._image}handlePreLayoutUpdate(e){var t,i;((t=this._image)==null?void 0:t.src)!==this.lastSrc&&((i=this._image)==null?void 0:i.complete)&&(this._layoutDirty=!0,this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=this.imageWidth;n===null&&(this.viewBox===null?n=this._image.width:n=this.viewBox[2]),this.width=Math.max(Math.min(n,t),e);let s=this.imageHeight;s===null&&(this.viewBox===null?s=this._image.height:s=this.viewBox[3]),this.height=Math.max(Math.min(s,r),i);let o=this.width/n,l=this.height/s,h=Math.min(o,l);this.actualWidth=n*h,this.actualHeight=s*h,this.offsetX=(this.width-this.actualWidth)/2,this.offsetY=(this.height-this.actualHeight)/2}handlePainting(e,t){var s;if(!((s=this._image)==null?void 0:s.complete)){this.lastSrc=null;return}this.lastSrc=this._image.src;let i=this.x+this.offsetX,r=this.y+this.offsetY,n=this.rotation!==0;n&&(e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip(),e.translate(this.x+this.offsetX+this.actualWidth/2,this.y+this.offsetY+this.actualHeight/2),i=-this.actualWidth/2,r=-this.actualHeight/2,e.rotate(this.rotation)),this.viewBox===null?e.drawImage(this._image,i,r,this.actualWidth,this.actualHeight):e.drawImage(this._image,...this.viewBox,i,r,this.actualWidth,this.actualHeight),n&&e.restore()}dryPaint(){var e;((e=this._image)==null?void 0:e.complete)?this.lastSrc=this._image.src:this.lastSrc=null,super.dryPaint()}};b([qe],J.prototype,"rotation",2),b([tt(!0)],J.prototype,"viewBox",2),b([V],J.prototype,"imageWidth",2),b([V],J.prototype,"imageHeight",2);var Rt=class extends pe{constructor(e,t=null,i=null,r=null,n=null,s){super(new J(e,t,i,r,s),n,s)}};var Xe=class extends C{constructor(e=1,t=0,i=0,r){super(!0,!1,r);this.flex=e,this.minWidth=t,this.minHeight=i}handleResolveDimensions(e,t,i,r){t!==1/0?this.width=t:this.width=Math.max(e,this.minWidth),r!==1/0?this.height=r:this.height=Math.max(i,this.minHeight)}};var Et=class extends be{constructor(e,t=null,i=!1,r){super(r);this.add([new ne(e,r),new Xe(1,0,0,r),new Ye(t,i,r)])}};var ke=class extends ${constructor(e,t=0,i=0,r=!1,n=!1,s=!1,o){super(e,!1,!0,o);this._offset=[0,0];this._constraints=[0,1/0,0,1/0];this.forceReLayout=!0;this.forceRePaint=!0;this.viewport=s?new te:null,this.minWidth=t,this.minHeight=i,this._widthTied=r,this._heightTied=n,this._constraints=[0,1/0,0,1/0]}get offset(){return[...this._offset]}set offset(e){(this._offset[0]!==e[0]||this._offset[1]!==e[1])&&(this._offset[0]=e[0],this._offset[1]=e[1],this._dirty=!0,this.correctChildPosition())}set constraints(e){(e[0]!==this._constraints[0]||e[1]!==this._constraints[1]||e[2]!==this._constraints[2]||e[3]!==this._constraints[3])&&(this._constraints[0]=e[0],this._constraints[1]=e[1],this._constraints[2]=e[2],this._constraints[3]=e[3],this.viewport!==null?this.viewport.constraints=e:this.forceReLayout=!0)}get constraints(){return[...this._constraints]}get widthTied(){return this._widthTied}set widthTied(e){this._widthTied!==e&&(this._widthTied=e,this._layoutDirty=!0,this.forceReLayout=!0)}get heightTied(){return this._heightTied}set heightTied(e){this._heightTied!==e&&(this._heightTied=e,this._layoutDirty=!0,this.forceReLayout=!0)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="canvasFill"&&(this._dirty=!0)}handleEvent(e,t){if(e.target===null&&!(e instanceof w))return null;let[i,r]=this.child.dimensions,n=this.x+this.offset[0],s=n+i,o=this.y+this.offset[1],l=o+r;if(e instanceof w){if(e.target===null&&(e.x<n||e.x>=s||e.y<o||e.y>=l))return null;this.viewport!==null&&(e=e.correctOffset(n,o))}return this.child.dispatchEvent(e,t)}handlePreLayoutUpdate(e){let t=this.child;t.preLayoutUpdate(e),this._widthTied||this._heightTied?t.layoutDirty&&(this._layoutDirty=!0):this.viewport!==null?(this.viewport.constraints=this._constraints,this.viewport.resolveChildsLayout(t)):(t.layoutDirty||this.forceReLayout)&&(t.resolveDimensionsAsTop(...this._constraints),this.correctChildPosition())}handlePostLayoutUpdate(e){let t=this.child;this.forceReLayout=!1,t.postLayoutUpdate(e),t.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=!0,s=!0,o=Math.min(Math.max(e,this.minWidth),t),l=Math.min(Math.max(i,this.minHeight),r);if(this._widthTied||this._heightTied){let h=[...this._constraints];this._widthTied&&(h[0]=o,h[1]=t),this._heightTied&&(h[2]=l,h[3]=r);let d=this.child;this.viewport===null?(d.resolveDimensionsAsTop(...h),this.correctChildPosition()):(this.viewport.constraints=h,this.viewport.resolveChildsLayout(d)),this._widthTied&&(this.width=d.dimensions[0],n=!1),this._heightTied&&(this.height=d.dimensions[1],s=!1)}n&&(this.width=Math.min(o,t)),s&&(this.height=Math.min(l,r)),this.width===0&&this.minWidth===0&&!this._widthTied&&console.warn("ViewportWidget has no minimum width and width isn't tied, therefore, it may be dimensionless. Set a minimum width and/or tie the width"),this.height===0&&this.minHeight===0&&!this._heightTied&&console.warn("ViewportWidget has no minimum height and height isn't tied, therefore, it may be dimensionless. Set a minimum height and/or tie the height")}afterPositionResolved(){this.correctChildPosition(),this.viewport===null&&(this.forceRePaint=!0)}correctChildPosition(){if(this.viewport!==null)return;let[e,t]=this.offset;this.child.resolvePosition(this.x+e,this.y+t)}handlePainting(e,t){this.viewport!==null&&this.viewport.paintToCanvas(this.child,t);let[i,r,n,s]=this.roundRect(this.x,this.y,this.width,this.height),[o,l]=this.child.dimensions,[h,d]=this.offset,u=i+n,m=r+s,c=this.x+h,f=this.y+d,g=Math.min(Math.max(c,i),u),T=Math.min(Math.max(f,r),m),_=Math.min(Math.max(c+o,i),u)-g,P=Math.min(Math.max(f+l,r),m)-T;if([g,T,_,P]=this.roundRect(g,T,_,P),_===0||P===0){this.viewport===null&&this.child.dryPaint(),this.forceRePaint=!1;return}let y=g-c,W=T-f;this.clearStart(e),e.rect(i,r,n,s),e.clip(),this.viewport!==null&&e.drawImage(this.viewport.canvas,y,W,_,P,g,T,_,P),e.rect(g,T,_,P),this.clearEnd(e,"evenodd"),this.viewport===null&&(e.save(),e.beginPath(),e.rect(g,T,_,P),e.clip(),this.child.paint(e,t||this.forceRePaint),e.restore()),this.forceRePaint=!1}};b([V],ke.prototype,"minWidth",2),b([V],ke.prototype,"minHeight",2);var B;(function(t){t[t.Overlay=0]="Overlay",t[t.Layout=1]="Layout"})(B||(B={}));var Mt=class extends ke{constructor(e,t=0,i=0,r=!1,n=!1,s=0,o=!1,l){super(e,t,i,r,n,o,l);this.effectiveWidth=0;this.effectiveHeight=0;this.verticalDragged=null;this.startingScroll=0;this.startingOffset=0;this.lastScroll=0;this.horizWasPainted=!1;this.vertWasPainted=!1;this._scrollbarMode=s,this.horizontalClickHelper=new I(this),this.verticalClickHelper=new I(this)}get scrollbarMode(){return this._scrollbarMode}set scrollbarMode(e){if(this._scrollbarMode!==e){let t=this.scroll;this._scrollbarMode=e,this.scroll=t,this._layoutDirty=!0,this._dirty=!0}}get offset(){return super.offset}set offset(e){let[t,i]=this.child.dimensions;super.offset=[-Math.max(Math.min(-e[0],t-this.effectiveWidth),0),-Math.max(Math.min(-e[1],i-this.effectiveHeight),0)]}get widthTied(){return super.widthTied}set widthTied(e){let t=this.scroll;super.widthTied=e,this.scroll=t}get heightTied(){return super.heightTied}set heightTied(e){let t=this.scroll;super.heightTied=e,this.scroll=t}get scroll(){let[e,t]=this.offset,[i,r]=this.child.dimensions,n=i-this.effectiveWidth,s=r-this.effectiveHeight;return[n===0?0:Math.min(Math.max(-e/n,0),1),s===0?0:Math.min(Math.max(-t/s,0),1)]}set scroll(e){let[t,i]=this.child.dimensions;this.offset=[-e[0]*(t-this.effectiveWidth),-e[1]*(i-this.effectiveHeight)]}getClickHelper(e){return e?this.verticalClickHelper:this.horizontalClickHelper}handleEventScrollbar(e,t,i,r){if(this.verticalDragged!==null&&this.verticalDragged!==e)return!1;let[n,s]=this.getScrollbarRects(e,t),o=this._scrollbarMode===0,l=o?n:s,h=[l[0],l[0]+l[2],l[1],l[1]+l[3]],d=this.getClickHelper(e);d.handleClickEvent(i,r,h);let u=d.clickState,m=d.clickStateChanged;if(m&&(this._dirty=!0),u===x.Hold){if(d.pointerPos===null||!(i instanceof w))return!0;let c=e?1:0,f=this.scroll,g=o;g||(g=d.isPointInRect(i.x,i.y,n[0],n[0]+n[2],n[1],n[1]+n[3]));let T;if(o?T=d.getNormalInRect(i.x,i.y,s[0],s[0]+s[2],s[1],s[1]+s[3])[c]:T=d.pointerPos[c],m){if(!g){let _=e?this.effectiveHeight:this.effectiveWidth,P=this.child.dimensions[c],y=_/P;f[c]=(T-y/2)/(1-y),this.scroll=f}this.startingOffset=T,this.startingScroll=f[c],this.verticalDragged=e}else{let _=e?this.effectiveHeight:this.effectiveWidth,P=this.child.dimensions[c],y=_/P,W=T-this.startingOffset;f[c]=this.startingScroll+W/(1-y),this.scroll=f}return!0}else{if(u===x.Hover)return!0;if(m)return this.verticalDragged=null,!0}return!1}clampOffset(e){let[t,i]=this.child.dimensions,r=-(t-this.effectiveWidth);r>=0?e[0]=0:e[0]<r&&(e[0]=r);let n=-(i-this.effectiveHeight);n>=0?e[1]=0:e[1]<n&&(e[1]=n)}handleWheelEvent(e){let t=this.offset,[i,r]=t;t[0]-=e.shift?e.deltaY:e.deltaX,t[1]-=e.shift?e.deltaX:e.deltaY,this.clampOffset(t),this.offset=t;let[n,s]=this.offset,o=n!==i||s!==r,l=this.lastScroll,h=new Date().getTime();return this.lastScroll=h,o?!0:e.fromDrag?!1:h-l<200}onThemeUpdated(e=null){super.onThemeUpdated(e),e==="scrollBarThickness"?(this._layoutDirty=!0,this._dirty=!0):(e==="backgroundFill"||e==="scrollBarMinPercent"||e==="scrollBarMinPixels"||e==="primaryFill"||e==="accentFill"||e==="backgroundGlowFill")&&(this._dirty=!0)}handleEvent(e,t){if((e instanceof F||e instanceof w)&&(e.target===null||e.target===this)){let[r,n]=this.child.dimensions,s=this._scrollbarMode===0,o=!s&&!this.widthTied&&!this.heightTied,l=r>this.width,h=n>this.height,d=!1;if(!this.widthTied&&(l||!s)&&this.handleEventScrollbar(!1,h||o,e,t)&&(d=!0),!this.heightTied&&(h||!s)&&this.handleEventScrollbar(!0,l||o,e,t)&&(d=!0),d)return e instanceof k&&this.handleWheelEvent(e),this}let i=super.handleEvent(e,t);return i===null&&e instanceof k&&this.handleWheelEvent(e)?this:i}handleResolveDimensions(e,t,i,r){let n=this.scrollBarThickness,s=this._scrollbarMode===1,o=s&&!this.heightTied,l=s&&!this.widthTied,h,d,u,m;o?(d=Math.max(t-n,0),h=Math.min(e,d)):(d=t,h=e),l?(m=Math.max(r-n,0),u=Math.min(i,m)):(m=r,u=i),super.handleResolveDimensions(h,d,u,m),this.effectiveWidth=this.width,this.effectiveHeight=this.height,o&&(this.width=Math.min(Math.max(this.width+n,e),t)),l&&(this.height=Math.min(Math.max(this.height+n,i),r))}handlePostLayoutUpdate(e){super.handlePostLayoutUpdate(e);let t=this.offset;this.clampOffset(t),this.offset=t}handlePainting(e,t){let[i,r]=this.child.dimensions,n=i>this.width,s=r>this.height,o=this.scrollbarNeedsPaint(!1,n),l=this.scrollbarNeedsPaint(!0,s);(this.horizWasPainted!==o||this.vertWasPainted!==l)&&(this.horizWasPainted=o,this.vertWasPainted=l,this.forceRePaint=!0),super.handlePainting(e,t);let h=this._scrollbarMode===1&&!this.widthTied&&!this.heightTied;if(o&&this.paintScrollbar(!1,n,s||h,e),l&&this.paintScrollbar(!0,s,n||h,e),h){let d=this.scrollBarThickness;e.fillStyle=this.backgroundFill,e.fillRect(this.x+this.width-d,this.y+this.height-d,d,d)}}getScrollbarRects(e,t){let i=this._scrollbarMode===0,r=e?1:0,n=this.scroll[r],s=this.child.dimensions[r],o=e?this.effectiveHeight:this.effectiveWidth,l=this.scrollBarThickness,h=this.scrollBarMinPercent,d=this.scrollBarMinPixels,u=o;i&&(u-=t?l:0);let m=Math.min(Math.max(d,Math.max(o/s,h)*u),u),c=(u-m)*n,f,g,T,_;e?(f=this.x+this.width-l,g=this.y+c,T=l,_=m):(f=this.x+c,g=this.y+this.height-l,T=m,_=l);let P,y,W,D;return e?(P=f,y=this.y,W=l,D=u):(P=this.x,y=g,W=u,D=l),[[f,g,T,_],[P,y,W,D]]}scrollbarNeedsPaint(e,t){return!t&&this._scrollbarMode===0?!1:!(e?this.heightTied:this.widthTied)}paintScrollbar(e,t,i,r){let[n,s]=this.getScrollbarRects(e,i);if(this._scrollbarMode!==0&&(r.fillStyle=this.backgroundFill,r.fillRect(...s)),t)switch(this.getClickHelper(e).clickState){case x.Released:r.fillStyle=this.primaryFill;break;case x.Hover:case x.Hold:r.fillStyle=this.accentFill;break}else r.fillStyle=this.backgroundGlowFill;r.fillRect(...n)}};var Ht=class extends C{constructor(e=null,t=0,i=1,r=0,n=0,s=!1,o){super(!0,!1,o);this.offsetX=0;this.offsetY=0;this.actualWidth=0;this.actualHeight=0;if(i<t)throw new Error("Slider max value can't be smaller than minimum value");this.clickHelper=new I(this),this.variable=new Z(Math.max(n,t),e),this.minValue=t,this.maxValue=i,this.snapIncrement=r,this.vertical=s}set value(e){this.setValue(e)}get value(){return this.variable.value}setValue(e,t=!0){this.snapIncrement>0&&(e=Math.round(e/this.snapIncrement)*this.snapIncrement),e<this.minValue?e=this.minValue:e>this.maxValue&&(e=this.maxValue),this.variable.setValue(e,t)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="sliderThickness"||e==="sliderMinLength"?(this._layoutDirty=!0,this._dirty=!0):(e==="accentFill"||e==="primaryFill"||e==="backgroundFill")&&(this._dirty=!0)}handleEvent(e,t){if(e instanceof k)return null;let i=this.x+this.offsetX,r=this.y+this.offsetY;if(this.clickHelper.handleClickEvent(e,t,[i,i+this.actualWidth,r,r+this.actualHeight]),(this.clickHelper.clickStateChanged&&this.clickHelper.wasClick||this.clickHelper.clickState==x.Hold)&&this.clickHelper.pointerPos!==null){let n=this.clickHelper.pointerPos[0];this.value=this.minValue+n*(this.maxValue-this.minValue)}return this.clickHelper.clickStateChanged&&(this._dirty=!0),this}handlePostLayoutUpdate(e){this.variable.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,i,r){let n=this.sliderThickness,s=this.sliderMinLength;this.vertical?(r!=1/0?this.height=r:this.height=Math.max(s,i),this.actualHeight=this.height,this.offsetY=0,this.width=Math.min(Math.max(n,e),t),this.actualWidth=Math.min(this.width,n),this.offsetX=(this.width-this.actualWidth)/2):(t!=1/0?this.width=t:this.width=Math.max(s,e),this.actualWidth=this.width,this.offsetX=0,this.height=Math.min(Math.max(n,i),r),this.actualHeight=Math.min(this.height,n),this.offsetY=(this.height-this.actualHeight)/2)}handlePainting(e,t){let i=this.x+this.offsetX,r=this.y+this.offsetY;this.clickHelper.clickState===x.Hover||this.clickHelper.clickState===x.Hold?e.fillStyle=this.accentFill:e.fillStyle=this.primaryFill;let n=this.actualWidth*(this.value-this.minValue)/(this.maxValue-this.minValue);e.fillRect(i,r,n,this.actualHeight),e.fillStyle=this.backgroundFill;let s=this.actualWidth-n;e.fillRect(i+n,r,s,this.actualHeight)}};var Lt=class extends j{constructor(e,t){let i=K({},t);i.containerAlignment={horizontal:v.Center,vertical:v.Stretch},super(e,i)}};var Kt=class extends ue{constructor(e,t){super(e);this.scopeTheme=t}set inheritedTheme(e){super.inheritedTheme=this.scopeTheme}get inheritedTheme(){return this.scopeTheme}};export{v as Alignment,Ct as AltKey,ie as ArtificialConstraint,Ke as BackspaceKey,me as BaseContainer,le as BaseTheme,St as BasicTextInput,Y as BasicVirtualKey,pe as Button,Dt as Center,Ye as Checkbox,I as ClickHelper,x as ClickState,Oe as Column,j as Container,Wt as ControlKey,xt as DOMKeyboardDriver,Tt as DOMPointerDriver,Re as DOMRoot,yt as DOMVirtualKeyboardRoot,wt as DebugTheme,It as DefaultTextInputHandler,_t as DefaultTextValidator,Ie as EnterKey,Ve as EscapeKey,Q as Event,We as FilledButton,U as FlexAlignment,gs as FloatValidator,p as FocusType,Me as GlyphVirtualKey,J as Icon,Rt as IconButton,bs as IntValidator,Pe as KeyEvent,q as KeyPress,we as KeyRelease,Ue as KeyboardDriver,ne as Label,Et as LabelledCheckbox,F as Leave,ms as MakeCompositeValidator,nt as MakeDefaultTextValidatorWithCallback,xs as MakeRangeValidator,Te as Margin,he as ModifierEvent,ye as MultiContainer,He as MultiParent,de as Parent,ue as PassthroughWidget,ce as PointerButtonEvent,_e as PointerDriver,w as PointerEvent,A as PointerHint,X as PointerMove,R as PointerPress,L as PointerRelease,k as PointerWheel,Pt as RayPointerDriver,ae as Root,be as Row,Mt as ScrollableViewportWidget,B as ScrollbarMode,Ae as ShiftKey,$ as SingleParent,Ht as Slider,Be as SpaceKey,Xe as Spacing,ge as TextButton,E as TextHelper,se as TextInput,Lt as TextMargin,z as TextPasteEvent,S as Theme,Kt as ThemeScope,Z as Variable,te as Viewport,ke as ViewportWidget,G as VirtualKey,Le as VirtualKeyRow,xe as VirtualKeyboard,bt as VirtualKeyboardRoot,C as Widget,re as WrapMode,ve as defaultVirtualKeyboardTemplate,Je as flagArrayField,je as flagField,Ge as getPointerEventNormPos,et as layoutArrayField,V as layoutField,Se as measureTextDims,dt as multiFlagArrayField,H as multiFlagField,Ce as paintArrayField,qe as paintField,tt as paintLayoutArrayField,ti as paintLayoutField,De as roundToPower2,Ze as watchArrayField,Fe as watchField};
//# sourceMappingURL=index.esm.js.map
