var st=Object.defineProperty;var Gt=Object.getOwnPropertyDescriptor;var Pt=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable;var Ft=(h,i,e)=>i in h?st(h,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[i]=e,Q=(h,i)=>{for(var e in i||(i={}))$t.call(i,e)&&Ft(h,e,i[e]);if(Pt)for(var e of Pt(i))Yt.call(i,e)&&Ft(h,e,i[e]);return h};var l=(h,i)=>st(h,"name",{value:i,configurable:!0});var y=(h,i,e,t)=>{for(var r=t>1?void 0:t?Gt(i,e):i,n=h.length-1,s;n>=0;n--)(s=h[n])&&(r=(t?s(i,e,r):s(r))||r);return t&&r&&st(i,e,r),r};var Ct=(h,i,e)=>new Promise((t,r)=>{var n=a=>{try{o(e.next(a))}catch(d){r(d)}},s=a=>{try{o(e.throw(a))}catch(d){r(d)}},o=a=>a.done?t(a.value):Promise.resolve(a.value).then(n,s);o((e=e.apply(h,i)).next())});var qe=(n=>(n.SpaceBetween="between",n.SpaceAround="around",n[n.Start=0]="Start",n[n.Center=.5]="Center",n[n.End=1]="End",n))(qe||{});var te=(r=>(r.Stretch="stretch",r[r.Start=0]="Start",r[r.Center=.5]="Center",r[r.End=1]="End",r))(te||{});var $=class{constructor(i,e,t,r=!1){this.target=i,this.focusType=e,this.needsFocus=t,this.reversed=r}};l($,"Event");var pe=class extends ${constructor(e,t,r,n,s,o){super(n,s,o);this.shift=e,this.ctrl=t,this.alt=r}};l(pe,"ModifierEvent");var T=class extends pe{constructor(e,t,r,n,s,o=null,a=null){super(r,n,s,o,a,!1);this.x=e,this.y=t}};l(T,"PointerEvent");var He=class extends ${constructor(e,t){super(null,null,!1,t);this.relativeTo=e,this.reachedRelative=e===null}cloneWithTarget(e){return e!==null&&!He.targetWarned&&(He.targetWarned=!0,console.warn("TabSelect events cannot be targetted to a specific widget. Target ignored")),new He(this.relativeTo,this.reversed)}},E=He;l(E,"TabSelect"),E.targetWarned=!1;var Me=null;function Ze(h,i){if(Me===null&&(Me=document.createElement("canvas").getContext("2d"),Me===null))throw new Error("Failed to get canvas context");return Me.font=i,Me.measureText(h)}l(Ze,"measureTextDims");function Je(h){return function(i,e){let t=new WeakMap;Object.defineProperty(i,e,{set:function(r){let n=t.get(this);r!==n&&(t.set(this,r),h.call(this,n))},get:function(){return t.get(this)},enumerable:!0,configurable:!0})}}l(Je,"watchField");function St(h){return Je(function(i){this[h]=!0})}l(St,"flagField");var ge=St("_dirty"),z=St("_layoutDirty");function O(h){return Je(function(i){for(let e of h)this[e]=!0})}l(O,"multiFlagField");var ki=O(["_dirty","_layoutDirty"]);function Dt(h,i=!1){return function(e,t){let r=new WeakMap;Object.defineProperty(e,t,{set:function(n){if(Array.isArray(n)){let s=r.get(this);if(Array.isArray(s)){if(n.length!==s.length){s.length=n.length;for(let o=0;o<n.length;o++)s[o]=n[o];h.call(this)}else for(let o=0;o<n.length;o++)if(s[o]!==n[o]){for(let a=0;a<n.length;a++)s[a]=n[a];h.call(this);return}}else r.set(this,[...n]),h.call(this)}else if(i)r.set(this,n),h.call(this);else throw new Error("Value must be an array")},get:function(){let n=r.get(this);return Array.isArray(n)?[...n]:n},enumerable:!0,configurable:!0})}}l(Dt,"watchArrayField");function Wt(h,i=!1){return Dt(function(){this[h]=!0},i)}l(Wt,"flagArrayField");function et(h=!1){return Wt("_dirty",h)}l(et,"paintArrayField");function Lt(h=!1){return Wt("_layoutDirty",h)}l(Lt,"layoutArrayField");function Nt(h,i=!1){return Dt(function(){for(let e of h)this[e]=!0},i)}l(Nt,"multiFlagArrayField");function Et(h=!1){return Nt(["_dirty","_layoutDirty"],h)}l(Et,"paintLayoutArrayField");var Xt=new Set([`
`,"	"]),Ht=(e=>(e[e.Normal=0]="Normal",e[e.Shrink=1]="Shrink",e))(Ht||{}),Mt=(t=>(t[t.Start=0]="Start",t[t.Center=.5]="Center",t[t.End=1]="End",t))(Mt||{}),C=class{constructor(){this.text="";this.font="";this.maxWidth=1/0;this.lineHeight=null;this.lineSpacing=null;this.tabWidth=4;this.wrapMode=0;this.alignMode=0;this._width=0;this._height=0;this._lineHeight=0;this._lineSpacing=0;this._tabWidth=0;this.measureDirty=!0;this.lineHeightSpacingDirty=!0;this.tabWidthDirty=!0;this._dirty=!1;this._lineRanges=[]}get dirty(){let i=this._dirty;return this._dirty=!1,i}measureTextSlice(i,e,t){let r=Ze(this.text.slice(e,t),this.font);return i===0?r.width+Math.max(0,r.actualBoundingBoxLeft):i+r.width}getLineRangeWidthUntil(i,e){if(e<=i[0][0])return 0;let t=0;for(;t<i.length;t++){let s=i[t],o=s[1];if(e==o)return s[2];if(e>=s[0]&&e<o)break}if(t===i.length)return i[t-1][2];let r=0;t>0&&(r=i[t-1][2]);let n=i[t];return n[3]?r+n[2]*(e-n[0])/(n[1]-n[0]):this.measureTextSlice(r,n[0],e)}measureText(i,e,t,r){var c,f;let n=0;for(;n<r.length;n++){let m=r[n];if(i>=m[0]&&i<m[1]){i=m[0];break}}if(n>0){let m=r[n-1];m[1]!==i&&(i=m[1],--n>0?m=r[n]:m=null),m!==null&&!m[3]&&!Xt.has(this.text[i])&&(i=m[0],n--)}let s=0;n>0&&(s=r[n-1][2]);let o=i,a=[];for(;o<e;)if(this.text[o]==="	"){let m=this.actualTabWidth;s=(Math.floor(s/m)+1)*m,a.push([o,++o,s,!0])}else if(this.text[o]===`
`){a.push([o,++o,s,!0]),o<e&&console.warn("measureText called with text range where newline was at the middle of the range instead of at the end. Some text was ignored");break}else{let m=this.text.indexOf(`
`,o+1);m===-1&&(m=1/0);let b=this.text.indexOf("	",o+1);b===-1&&(b=1/0);let v=Math.min(m,b,e);s=this.measureTextSlice(s,o,v),a.push([o,v,s,!1]),o=v}let d=n+a.length,u=(f=(c=a[a.length-1])!=null?c:r[n-1])!=null?f:null;return u===null?(r.length=0,r.push([i,i,0,!1]),!0):d===1&&u[1]-u[0]<=1||u[2]<=t?(r.length=n,r.push(...a),!0):!1}updateTextDims(){if(this.lineHeightSpacingDirty){this.lineHeightSpacingDirty=!1;let e=this._lineHeight,t=this._lineSpacing;if(this.lineHeight===null||this.lineSpacing===null){let r=Ze("~!@#$%^&*()_+`1234567890-=qwertyuiop[]\\QWERTYUIOP{}|asdfghjkl;'ASDFGHJKL:\"zxcvbnm,./ZXCVBNM<>?",this.font);this.lineHeight===null?this._lineHeight=r.actualBoundingBoxAscent:this._lineHeight=this.lineHeight,this.lineSpacing===null?this._lineSpacing=r.actualBoundingBoxDescent:this._lineSpacing=this.lineSpacing}else this._lineHeight=this.lineHeight,this._lineSpacing=this.lineSpacing;(e!==this._lineHeight||t!==this._lineSpacing)&&(this.measureDirty=!0)}if(this.tabWidthDirty&&(this.tabWidthDirty=!1,this._tabWidth=Ze(" ",this.font).width*this.tabWidth),!this.measureDirty)return;this.measureDirty=!1;let i=this._lineHeight+this._lineSpacing;if(this.text.length===0)this._height=i,this._width=this.maxWidth===1/0?0:this.maxWidth,this._lineRanges.length=1,this._lineRanges[0]=[[0,0,0,!1]];else if(this.maxWidth===1/0){this._lineRanges.length=0;let e=0;this._height=0,this._width=0;let t=this.text;for(;;){let r=this.text.indexOf(`
`,e),n=r===-1,s=n?t.length:r+1,o=[];this.measureText(e,s,1/0,o),this._lineRanges.push(o),this._height+=i;let a=o[o.length-1][2];if(a>this._width&&(this._width=a),n)break;e=s}}else{this._lineRanges.length=0;let e=[],t=this.text,r=/\s/,n=-1;for(let s=0;s<=t.length;){let o=r.test(t[s]),a=s===t.length;if(o||a){if(n>=0&&!this.measureText(n,s,this.maxWidth,e)){let d=[];if(this.measureText(n,s,this.maxWidth,d)){if(e.length===0)throw new Error("Unexpected line range without any render groups");this._lineRanges.push(e),e=d}else{let u=n;for(;u<s-1&&this.measureText(u,u+1,this.maxWidth,e);u++);this._lineRanges.push(e),e=d,s=u,n=u;continue}}if(n=-1,a){if(e.length===0){let d=this._lineRanges[this._lineRanges.length-1];if(d===void 0)e.push([0,0,0,!1]);else{let u=d[d.length-1];u===void 0?e.push([0,0,0,!1]):e.push([u[1],u[1],0,!1])}}this._lineRanges.push(e);break}if(t[s]===`
`)this.measureText(s,s+1,1/0,e),this._lineRanges.push(e),e=[];else if(!this.measureText(s,s+1,this.maxWidth,e))if(this.wrapMode===1){let d=s;do s++;while(t[s]!==`
`&&r.test(t[s]));let u=e[e.length-1];e.push([d,s,u!==void 0?u[2]:0,!0]),this._lineRanges.push(e),e=[];continue}else this._lineRanges.push(e),e=[],this.measureText(s,s+1,1/0,e)}else n===-1&&(n=s);s++}this._width=this.maxWidth,this._height=i*this._lineRanges.length}}paintGroup(i,e,t,r,n){!e[3]&&e[2]>t&&i.fillText(this.text.slice(e[0],e[1]),r,n)}paint(i,e,t,r){i.save(),i.beginPath(),i.rect(t,r,this.width,this.height),i.clip(),i.font=this.font,i.fillStyle=e,i.textBaseline="alphabetic",this.updateTextDims();let n=this.fullLineHeight,s=r+this._lineHeight;for(let o=0;o<this._lineRanges.length;o++){let a=0,d=this.getLineShift(o);for(let u of this._lineRanges[o])this.paintGroup(i,u,a,t+a+d,s),a=u[2];s+=n}i.restore()}findOffsetFromIndex(i){if(this.updateTextDims(),i<=0||this._lineRanges.length===0)return[this.getLineShift(0),0];let e=0;for(let t of this._lineRanges){if(i<t[t.length-1][1])break;e++}return e>=this._lineRanges.length&&(e=this._lineRanges.length-1,i=this.text.length),[this.getLineRangeWidthUntil(this._lineRanges[e],i)+this.getLineShift(e),e*this.fullLineHeight]}findIndexOffsetFromOffset(i){let e=this.fullLineHeight,t=this.getLineShift(0);if(this.text===""||i[0]<=t&&i[1]<e||i[1]<0)return[0,[t,0]];let r=Math.floor(i[1]/e);if(this.updateTextDims(),r>=this._lineRanges.length){let f=this.text.length;return[f,this.findOffsetFromIndex(f)]}let n=r*e,s=this._lineRanges[r],o=this.getLineShift(r);if(s.length===1&&s[0][0]===s[0][1])return[s[0][0],[s[0][2]+o,n]];let a=0,d=s[0][0],u=s[s.length-1][1];this.text[u-1]===`
`&&u--;let c=i[0]-o;for(let f=d;f<u;f++){let m=this.getLineRangeWidthUntil(s,f+1),b=(m+a)/2;if(c<b)return[f,[a+o,n]];a=m}return[u,[a+o,n]]}getLine(i){if(i<=0)return 0;this.updateTextDims();for(let e=0;e<this._lineRanges.length;e++){let t=this._lineRanges[e],r=t[t.length-1];if(i<r[1])return e}return this._lineRanges.length-1}getLineStart(i){if(i<=0)return 0;if(this.updateTextDims(),i>=this._lineRanges.length){let e=this._lineRanges[this._lineRanges.length-1];return e[e.length-1][1]}return this._lineRanges[i][0][0]}getLineEnd(i,e=!0){if(i<0)return 0;if(this.updateTextDims(),i>=this._lineRanges.length){let s=this._lineRanges[this._lineRanges.length-1];return s[s.length-1][1]}let t=this._lineRanges[i],r=t[t.length-1],n=r[1];return!e&&n>0&&this.text[n-1]===`
`&&r[0]!==r[1]?n-1:n}getLineShift(i){let e=this.alignMode;if(e===0)return 0;if(this.updateTextDims(),i<0)i=0;else if(i>=this._lineRanges.length)return this.width*e;let t=this._lineRanges[i];return(this.width-t[t.length-1][2])*e}get width(){return this.updateTextDims(),this._width}get height(){return this.updateTextDims(),this._height}get lineRanges(){return this.updateTextDims(),[...this._lineRanges]}get actualLineHeight(){return this.updateTextDims(),this._lineHeight}get actualLineSpacing(){return this.updateTextDims(),this._lineSpacing}get actualTabWidth(){return this.updateTextDims(),this._tabWidth}get fullLineHeight(){return this.updateTextDims(),this._lineHeight+this._lineSpacing}};l(C,"TextHelper"),y([O(["_dirty","measureDirty"])],C.prototype,"text",2),y([O(["_dirty","measureDirty","lineHeightSpacingDirty","tabWidthDirty"])],C.prototype,"font",2),y([O(["_dirty","measureDirty"])],C.prototype,"maxWidth",2),y([O(["_dirty","measureDirty","lineHeightSpacingDirty"])],C.prototype,"lineHeight",2),y([O(["_dirty","measureDirty","lineHeightSpacingDirty"])],C.prototype,"lineSpacing",2),y([O(["_dirty","measureDirty","tabWidthDirty"])],C.prototype,"tabWidth",2),y([O(["_dirty","measureDirty"])],C.prototype,"wrapMode",2),y([O(["_dirty"])],C.prototype,"alignMode",2);var D=class{constructor(i,e){this.listener=null;this._fallbackTheme=e,typeof i!="undefined"&&(this._canvasFill=i.canvasFill,this._containerPadding=i.containerPadding,this._containerAlignment=i.containerAlignment,this._multiContainerSpacing=i.multiContainerSpacing,this._multiContainerAlignment=i.multiContainerAlignment,this._primaryFill=i.primaryFill,this._accentFill=i.accentFill,this._backgroundFill=i.backgroundFill,this._backgroundGlowFill=i.backgroundGlowFill,this._sliderMinLength=i.sliderMinLength,this._sliderThickness=i.sliderThickness,this._bodyTextFont=i.bodyTextFont,this._bodyTextFill=i.bodyTextFill,this._bodyTextHeight=i.bodyTextHeight,this._bodyTextSpacing=i.bodyTextSpacing,this._bodyTextAlign=i.bodyTextAlign,this._checkboxLength=i.checkboxLength,this._checkboxInnerPadding=i.checkboxInnerPadding,this._inputBackgroundFill=i.inputBackgroundFill,this._inputSelectBackgroundFill=i.inputSelectBackgroundFill,this._inputTextFont=i.inputTextFont,this._inputTextFill=i.inputTextFill,this._inputTextFillDisabled=i.inputTextFillDisabled,this._inputTextFillInvalid=i.inputTextFillInvalid,this._inputTextHeight=i.inputTextHeight,this._inputTextSpacing=i.inputTextSpacing,this._inputTextInnerPadding=i.inputTextInnerPadding,this._inputTextMinWidth=i.inputTextMinWidth,this._inputTextAlign=i.inputTextAlign,this._blinkRate=i.blinkRate,this._cursorThickness=i.cursorThickness,this._scrollBarThickness=i.scrollBarThickness,this._scrollBarMinPercent=i.scrollBarMinPercent,this._scrollBarMinPixels=i.scrollBarMinPixels,this._radioButtonLength=i.radioButtonLength,this._radioButtonInnerPadding=i.radioButtonInnerPadding)}get fallbackTheme(){return this._fallbackTheme}set fallbackTheme(i){if(this._fallbackTheme===i)return;let e=this._fallbackTheme;typeof e!="undefined"&&this.listener!==null&&e.unsubscribe(this.listener),typeof i!="undefined"&&(this.listener=t=>this.onThemeUpdated(t),i.subscribe(this.listener)),this._fallbackTheme=i,this.onThemeUpdated()}onThemeUpdated(i=null){}get canvasFill(){var i,e,t;return(t=(e=this._canvasFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.canvasFill)!=null?t:"rgba(0,0,0,0.5)"}set canvasFill(i){this._canvasFill!==i&&(this._canvasFill=i,this.onThemeUpdated("canvasFill"))}get containerPadding(){var i,e,t;return(t=(e=this._containerPadding)!=null?e:(i=this._fallbackTheme)==null?void 0:i.containerPadding)!=null?t:{left:4,right:4,top:4,bottom:4}}set containerPadding(i){this._containerPadding!==i&&(this._containerPadding=i,this.onThemeUpdated("containerPadding"))}get containerAlignment(){var i,e,t;return(t=(e=this._containerAlignment)!=null?e:(i=this._fallbackTheme)==null?void 0:i.containerAlignment)!=null?t:{horizontal:0,vertical:0}}set containerAlignment(i){this._containerAlignment!==i&&(this._containerAlignment=i,this.onThemeUpdated("containerAlignment"))}get multiContainerSpacing(){var i,e,t;return(t=(e=this._multiContainerSpacing)!=null?e:(i=this._fallbackTheme)==null?void 0:i.multiContainerSpacing)!=null?t:4}set multiContainerSpacing(i){this._multiContainerSpacing!==i&&(this._multiContainerSpacing=i,this.onThemeUpdated("multiContainerSpacing"))}get multiContainerAlignment(){var i,e,t;return(t=(e=this._multiContainerAlignment)!=null?e:(i=this._fallbackTheme)==null?void 0:i.multiContainerAlignment)!=null?t:{main:"between",cross:"stretch"}}set multiContainerAlignment(i){this._multiContainerAlignment!==i&&(this._multiContainerAlignment=i,this.onThemeUpdated("multiContainerAlignment"))}get primaryFill(){var i,e,t;return(t=(e=this._primaryFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.primaryFill)!=null?t:"rgb(0,127,255)"}set primaryFill(i){this._primaryFill!==i&&(this._primaryFill=i,this.onThemeUpdated("primaryFill"))}get accentFill(){var i,e,t;return(t=(e=this._accentFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.accentFill)!=null?t:"rgb(0,195,255)"}set accentFill(i){this._accentFill!==i&&(this._accentFill=i,this.onThemeUpdated("accentFill"))}get backgroundFill(){var i,e,t;return(t=(e=this._backgroundFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.backgroundFill)!=null?t:"rgb(32,32,32)"}set backgroundFill(i){this._backgroundFill!==i&&(this._backgroundFill=i,this.onThemeUpdated("backgroundFill"))}get backgroundGlowFill(){var i,e,t;return(t=(e=this._backgroundGlowFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.backgroundGlowFill)!=null?t:"rgb(48,48,48)"}set backgroundGlowFill(i){this._backgroundGlowFill!==i&&(this._backgroundGlowFill=i,this.onThemeUpdated("backgroundGlowFill"))}get sliderMinLength(){var i,e,t;return(t=(e=this._sliderMinLength)!=null?e:(i=this._fallbackTheme)==null?void 0:i.sliderMinLength)!=null?t:100}set sliderMinLength(i){this._sliderMinLength!==i&&(this._sliderMinLength=i,this.onThemeUpdated("sliderMinLength"))}get sliderThickness(){var i,e,t;return(t=(e=this._sliderThickness)!=null?e:(i=this._fallbackTheme)==null?void 0:i.sliderThickness)!=null?t:10}set sliderThickness(i){this._sliderThickness!==i&&(this._sliderThickness=i,this.onThemeUpdated("sliderThickness"))}get bodyTextFont(){var i,e,t;return(t=(e=this._bodyTextFont)!=null?e:(i=this._fallbackTheme)==null?void 0:i.bodyTextFont)!=null?t:"1rem sans-serif"}set bodyTextFont(i){this._bodyTextFont!==i&&(this._bodyTextFont=i,this.onThemeUpdated("bodyTextFont"))}get bodyTextFill(){var i,e,t;return(t=(e=this._bodyTextFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.bodyTextFill)!=null?t:"white"}set bodyTextFill(i){this._bodyTextFill!==i&&(this._bodyTextFill=i,this.onThemeUpdated("bodyTextFill"))}get bodyTextHeight(){var i,e,t;return(t=(e=this._bodyTextHeight)!=null?e:(i=this._fallbackTheme)==null?void 0:i.bodyTextHeight)!=null?t:null}set bodyTextHeight(i){this._bodyTextHeight!==i&&(this._bodyTextHeight=i,this.onThemeUpdated("bodyTextHeight"))}get bodyTextSpacing(){var i,e,t;return(t=(e=this._bodyTextSpacing)!=null?e:(i=this._fallbackTheme)==null?void 0:i.bodyTextSpacing)!=null?t:null}set bodyTextSpacing(i){this._bodyTextSpacing!==i&&(this._bodyTextSpacing=i,this.onThemeUpdated("bodyTextSpacing"))}get bodyTextAlign(){var i,e,t;return(t=(e=this._bodyTextAlign)!=null?e:(i=this._fallbackTheme)==null?void 0:i.bodyTextAlign)!=null?t:0}set bodyTextAlign(i){this._bodyTextAlign!==i&&(this._bodyTextAlign=i,this.onThemeUpdated("bodyTextAlign"))}get checkboxLength(){var i,e,t;return(t=(e=this._checkboxLength)!=null?e:(i=this._fallbackTheme)==null?void 0:i.checkboxLength)!=null?t:12}set checkboxLength(i){this._checkboxLength!==i&&(this._checkboxLength=i,this.onThemeUpdated("checkboxLength"))}get checkboxInnerPadding(){var i,e,t;return(t=(e=this._checkboxInnerPadding)!=null?e:(i=this._fallbackTheme)==null?void 0:i.checkboxInnerPadding)!=null?t:2}set checkboxInnerPadding(i){this._checkboxInnerPadding!==i&&(this._checkboxInnerPadding=i,this.onThemeUpdated("checkboxInnerPadding"))}get inputBackgroundFill(){var i,e,t;return(t=(e=this._inputBackgroundFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputBackgroundFill)!=null?t:"white"}set inputBackgroundFill(i){this._inputBackgroundFill!==i&&(this._inputBackgroundFill=i,this.onThemeUpdated("inputBackgroundFill"))}get inputSelectBackgroundFill(){var i,e,t;return(t=(e=this._inputSelectBackgroundFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputSelectBackgroundFill)!=null?t:"rgb(0,195,255)"}set inputSelectBackgroundFill(i){this._inputSelectBackgroundFill!==i&&(this._inputSelectBackgroundFill=i,this.onThemeUpdated("inputSelectBackgroundFill"))}get inputTextFont(){var i,e,t;return(t=(e=this._inputTextFont)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextFont)!=null?t:"1rem monospace"}set inputTextFont(i){this._inputTextFont!==i&&(this._inputTextFont=i,this.onThemeUpdated("inputTextFont"))}get inputTextFill(){var i,e,t;return(t=(e=this._inputTextFill)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextFill)!=null?t:"black"}set inputTextFill(i){this._inputTextFill!==i&&(this._inputTextFill=i,this.onThemeUpdated("inputTextFill"))}get inputTextFillDisabled(){var i,e,t;return(t=(e=this._inputTextFillDisabled)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextFillDisabled)!=null?t:"grey"}set inputTextFillDisabled(i){this._inputTextFillDisabled!==i&&(this._inputTextFillDisabled=i,this.onThemeUpdated("inputTextFillDisabled"))}get inputTextFillInvalid(){var i,e,t;return(t=(e=this._inputTextFillInvalid)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextFillInvalid)!=null?t:"red"}set inputTextFillInvalid(i){this._inputTextFillInvalid!==i&&(this._inputTextFillInvalid=i,this.onThemeUpdated("inputTextFillInvalid"))}get inputTextHeight(){var i,e,t;return(t=(e=this._inputTextHeight)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextHeight)!=null?t:null}set inputTextHeight(i){this._inputTextHeight!==i&&(this._inputTextHeight=i,this.onThemeUpdated("inputTextHeight"))}get inputTextSpacing(){var i,e,t;return(t=(e=this._inputTextSpacing)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextSpacing)!=null?t:null}set inputTextSpacing(i){this._inputTextSpacing!==i&&(this._inputTextSpacing=i,this.onThemeUpdated("inputTextSpacing"))}get inputTextInnerPadding(){var i,e,t;return(t=(e=this._inputTextInnerPadding)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextInnerPadding)!=null?t:2}set inputTextInnerPadding(i){this._inputTextInnerPadding!==i&&(this._inputTextInnerPadding=i,this.onThemeUpdated("inputTextInnerPadding"))}get inputTextMinWidth(){var i,e,t;return(t=(e=this._inputTextMinWidth)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextMinWidth)!=null?t:100}set inputTextMinWidth(i){this._inputTextMinWidth!==i&&(this._inputTextMinWidth=i,this.onThemeUpdated("inputTextMinWidth"))}get inputTextAlign(){var i,e,t;return(t=(e=this._inputTextAlign)!=null?e:(i=this._fallbackTheme)==null?void 0:i.inputTextAlign)!=null?t:0}set inputTextAlign(i){this._inputTextAlign!==i&&(this._inputTextAlign=i,this.onThemeUpdated("inputTextAlign"))}get blinkRate(){var i,e,t;return(t=(e=this._blinkRate)!=null?e:(i=this._fallbackTheme)==null?void 0:i.blinkRate)!=null?t:.8}set blinkRate(i){this._blinkRate!==i&&(this._blinkRate=i,this.onThemeUpdated("blinkRate"))}get cursorThickness(){var i,e,t;return(t=(e=this._cursorThickness)!=null?e:(i=this._fallbackTheme)==null?void 0:i.cursorThickness)!=null?t:1}set cursorThickness(i){this._cursorThickness!==i&&(this._cursorThickness=i,this.onThemeUpdated("cursorThickness"))}get scrollBarThickness(){var i,e,t;return(t=(e=this._scrollBarThickness)!=null?e:(i=this._fallbackTheme)==null?void 0:i.scrollBarThickness)!=null?t:8}set scrollBarThickness(i){this._scrollBarThickness!==i&&(this._scrollBarThickness=i,this.onThemeUpdated("scrollBarThickness"))}get scrollBarMinPercent(){var i,e,t;return(t=(e=this._scrollBarMinPercent)!=null?e:(i=this._fallbackTheme)==null?void 0:i.scrollBarMinPercent)!=null?t:.1}set scrollBarMinPercent(i){this._scrollBarMinPercent!==i&&(this._scrollBarMinPercent=i,this.onThemeUpdated("scrollBarMinPercent"))}get scrollBarMinPixels(){var i,e,t;return(t=(e=this._scrollBarMinPixels)!=null?e:(i=this._fallbackTheme)==null?void 0:i.scrollBarMinPixels)!=null?t:20}set scrollBarMinPixels(i){this._scrollBarMinPixels!==i&&(this._scrollBarMinPixels=i,this.onThemeUpdated("scrollBarMinPixels"))}get radioButtonLength(){var i,e,t;return(t=(e=this._radioButtonLength)!=null?e:(i=this._fallbackTheme)==null?void 0:i.radioButtonLength)!=null?t:12}set radioButtonLength(i){this._radioButtonLength!==i&&(this._radioButtonLength=i,this.onThemeUpdated("radioButtonLength"))}get radioButtonInnerPadding(){var i,e,t;return(t=(e=this._radioButtonInnerPadding)!=null?e:(i=this._fallbackTheme)==null?void 0:i.radioButtonInnerPadding)!=null?t:2}set radioButtonInnerPadding(i){this._radioButtonInnerPadding!==i&&(this._radioButtonInnerPadding=i,this.onThemeUpdated("radioButtonInnerPadding"))}};l(D,"BaseTheme");var Qt=/[%a-zA-Z]+/,Rt=/[0-9]+(\.[0-9]+)?(%|cap|ch|ex|vmin|vmax|Q|r?em|r?lh|i[cn]|[cm]m|p[xct]|v[hwib])/,zt=Math.PI*2,p=class extends D{constructor(e,t,r){super(r);this._enabled=!0;this._dirty=!0;this._layoutDirty=!0;this.width=0;this.height=0;this.x=0;this.y=0;this._flex=0;this._root=null;this._parent=null;this.tabFocusable=!1;this._cachedFont_bodyTextFont="";this._cachedLastFont_bodyTextFont="";this._cachedFont_inputTextFont="";this._cachedLastFont_inputTextFont="";this.needsClear=e,this.propagatesEvents=t}get flex(){return this._flex}set flex(e){e!==this._flex&&(this._flex=e,this._layoutDirty=!0)}set enabled(e){e!==this._enabled&&(this._enabled=e,this.forceDirty())}get enabled(){return this._enabled}set inheritedTheme(e){this.fallbackTheme=e}get inheritedTheme(){return this.fallbackTheme}onThemeUpdated(e=null){super.onThemeUpdated(e),this.needsClear&&(e===null||e==="canvasFill")&&(this._dirty=!0)}get dimensions(){return[this.width,this.height]}get position(){return[this.x,this.y]}get dirty(){return this._dirty&&!this.dimensionless}get layoutDirty(){return this._layoutDirty}get dimensionless(){return this.width==0||this.height==0}onFocusGrabbed(e){}onFocusDropped(e){}handleEvent(e){return e.target===this?this:null}dispatchEvent(e){if(!this._enabled)return null;if(e.target===null){if(e instanceof T&&(e.x<this.x||e.y<this.y||e.x>=this.x+this.width||e.y>=this.y+this.height))return null}else if(e.target!==this&&!this.propagatesEvents)return null;let t=null;if(e.reversed&&(t=this.handleEvent(e)),e instanceof E)if(e.reachedRelative){if(this.tabFocusable&&(t===this||t===null))return this}else e.relativeTo===this&&(e.reachedRelative=!0);return e.reversed||(t=this.handleEvent(e)),t}handlePreLayoutUpdate(){}preLayoutUpdate(){this._enabled&&this.handlePreLayoutUpdate()}resolveDimensions(e,t,r,n){if(!this._enabled){this.width=0,this.height=0,this._layoutDirty=!1;return}if(e==1/0)throw new Error("minWidth must not be infinite");if(e>t&&(console.warn(`minWidth (${e}) must not be greater than maxWidth (${t}). Set minWidth to maxWidth. This may be caused by floating pointer precision errors`),e=t),e<0&&(console.warn(`minWidth (${e}) must not be lesser than 0. Set minWidth to 0. This may be caused by floating pointer precision errors`),e=0),r==1/0)throw new Error("minHeight must not be infinite");r>n&&(console.warn(`minHeight (${r}) must not be greater than maxHeight (${n}). Set minHeight to maxHeight. This may be caused by floating pointer precision errors`),r=n),r<0&&(console.warn(`minHeight (${r}) must not be lesser than 0. Set minHeight to 0. This may be caused by floating pointer precision errors`),r=0);let s=this.width,o=this.height;if(this.handleResolveDimensions(e,t,r,n),this.width<e?(this.width=e,console.error("Horizontal underflow in widget")):this.width>t&&(this.width=t,console.error("Horizontal overflow in widget")),this.width<0||!isFinite(this.width)||isNaN(this.width))throw new Error(`Disallowed width (${this.width}) in widget`);if(this.height<r?(this.height=r,console.error("Vertical underflow in widget")):this.height>n&&(this.height=n,console.error("Vertical overflow in widget")),this.height<0||!isFinite(this.height)||isNaN(this.height))throw new Error(`Disallowed height (${this.height}) in widget`);this._layoutDirty=!1,(s!==this.width||o!==this.height)&&(this._dirty=!0)}resolveDimensionsAsTop(e,t,r,n){this.resolveDimensions(e,t,r,n),(t===1/0||n===1/0)&&this.resolveDimensions(e,t===1/0?this.width:t,r,n===1/0?this.height:n)}afterPositionResolved(){}resolvePosition(e,t){(e!==this.x||t!==this.y)&&(this._dirty=!0),this.x=e,this.y=t,this.afterPositionResolved()}handlePostLayoutUpdate(){}postLayoutUpdate(){this._enabled&&this.handlePostLayoutUpdate()}clear(e,t,r,n,s,o=null){s.save(),s.globalCompositeOperation="copy",s.fillStyle=o!=null?o:this.canvasFill,s.beginPath(),s.rect(...this.roundRect(e,t,r,n,!0)),s.clip(),s.fill(),s.restore()}clearStart(e,t=null){e.save(),e.globalCompositeOperation="copy",e.fillStyle=t!=null?t:this.canvasFill,e.beginPath()}clearEnd(e,t="nonzero"){e.clip(t),e.fill(),e.restore()}roundRect(e,t,r,n,s=!1){let o=s?Math.ceil:Math.floor,a=s?Math.floor:Math.ceil;return e=o(e),t=o(t),[e,t,a(e+r)-e,a(t+n)-t]}paintCircle(e,t,r,n){e.beginPath(),e.arc(t,r,n,0,zt),e.fill()}handlePainting(e,t){}paint(e,t=!1){if(this.dimensionless)return this.dryPaint();!this._dirty&&!t||(this._enabled&&(this.needsClear&&this.clear(this.x,this.y,this.width,this.height,e),e.save(),this.handlePainting(e,t),e.restore()),this._dirty=!1)}dryPaint(){this._dirty=!1}forceThemeUpdate(){this.onThemeUpdated()}forceDirty(){this._dirty=!0,this._layoutDirty=!0}scaleFont(e,t){let r=e.search(Rt),n,s,o=0;if(r==-1)(r=e.search("xx-small"))!==-1?(s=.5625*t,o=8):(r=e.search("x-small"))!==-1?(s=.625*t,o=7):(r=e.search("small"))!==-1?(s=.8333*t,o=5):(r=e.search("medium"))!==-1?(s=t,o=6):(r=e.search("large"))!==-1?(s=1.125*t,o=5):(r=e.search("x-large"))!==-1?(s=1.5*t,o=7):(r=e.search("xx-large"))!==-1?(s=2*t,o=8):(r=e.search("smaller"))!==-1?(s=.8333*t,o=7):(r=e.search("larger"))!==-1?(s=1.125*t,o=6):s=t,n="rem";else{let a=e.match(Rt);if(a===null)throw new Error("Unexpected null font-size match");let d=a[0];o=d.length;let u=d.match(Qt);if(u===null)throw new Error("Unexpected null font-size suffix match");n=u[0],s=parseFloat(d)*t}return e.substring(0,r)+s.toString()+n+e.substring(r+o,e.length)}get active(){return this._root!==null}get root(){if(!this.active)throw new Error("Cannot get root; Widget is not active");return this._root}get parent(){if(!this.active)throw new Error("Cannot get parent; Widget is not active");return this._parent}activate(e,t){if(this.active)throw new Error("Attempt to activate active Widget");this._root=e,this._parent=t,this.forceDirty()}deactivate(){if(!this.active)throw new Error("Attempt to deactivate inactive Widget");this._root=null,this._parent=null}get containerPadding(){var r,n;let e=super.containerPadding,t=(n=(r=this._root)==null?void 0:r.resolution)!=null?n:1;return{left:e.left*t,right:e.right*t,top:e.top*t,bottom:e.bottom*t}}set containerPadding(e){super.containerPadding=e}get multiContainerSpacing(){var e,t;return super.multiContainerSpacing*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set multiContainerSpacing(e){super.multiContainerSpacing=e}get sliderMinLength(){var e,t;return super.sliderMinLength*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set sliderMinLength(e){super.sliderMinLength=e}get sliderThickness(){var e,t;return super.sliderThickness*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set sliderThickness(e){super.sliderThickness=e}get bodyTextFont(){var t,r;let e=super.bodyTextFont;return e!==this._cachedLastFont_bodyTextFont&&(this._cachedLastFont_bodyTextFont=e,this._cachedFont_bodyTextFont=this.scaleFont(e,(r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)),this._cachedFont_bodyTextFont}set bodyTextFont(e){super.bodyTextFont=e}get bodyTextHeight(){var t,r;let e=super.bodyTextHeight;return e===null?e:e*((r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)}set bodyTextHeight(e){super.bodyTextHeight=e}get bodyTextSpacing(){var t,r;let e=super.bodyTextSpacing;return e===null?e:e*((r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)}set bodyTextSpacing(e){super.bodyTextSpacing=e}get checkboxLength(){var e,t;return super.checkboxLength*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set checkboxLength(e){super.checkboxLength=e}get checkboxInnerPadding(){var e,t;return super.checkboxInnerPadding*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set checkboxInnerPadding(e){super.checkboxInnerPadding=e}get inputTextFont(){var t,r;let e=super.inputTextFont;return e!==this._cachedLastFont_inputTextFont&&(this._cachedLastFont_inputTextFont=e,this._cachedFont_inputTextFont=this.scaleFont(e,(r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)),this._cachedFont_inputTextFont}set inputTextFont(e){super.inputTextFont=e}get inputTextHeight(){var t,r;let e=super.inputTextHeight;return e===null?e:e*((r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)}set inputTextHeight(e){super.inputTextHeight=e}get inputTextSpacing(){var t,r;let e=super.inputTextSpacing;return e===null?e:e*((r=(t=this._root)==null?void 0:t.resolution)!=null?r:1)}set inputTextSpacing(e){super.inputTextSpacing=e}get inputTextInnerPadding(){var e,t;return super.inputTextInnerPadding*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set inputTextInnerPadding(e){super.inputTextInnerPadding=e}get inputTextMinWidth(){var e,t;return super.inputTextMinWidth*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set inputTextMinWidth(e){super.inputTextMinWidth=e}get cursorThickness(){var e,t;return super.cursorThickness*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set cursorThickness(e){super.cursorThickness=e}get scrollBarThickness(){var e,t;return super.scrollBarThickness*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set scrollBarThickness(e){super.scrollBarThickness=e}get scrollBarMinPixels(){var e,t;return super.scrollBarMinPixels*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set scrollBarMinPixels(e){super.scrollBarMinPixels=e}get radioButtonLength(){var e,t;return super.radioButtonLength*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set radioButtonLength(e){super.radioButtonLength=e}get radioButtonInnerPadding(){var e,t;return super.radioButtonInnerPadding*((t=(e=this._root)==null?void 0:e.resolution)!=null?t:1)}set radioButtonInnerPadding(e){super.radioButtonInnerPadding=e}};l(p,"Widget");var be=class extends p{constructor(e,t,r,n){super(t,r,n);this._children=[...e]}set inheritedTheme(e){super.inheritedTheme=e;for(let t of this.children)t.inheritedTheme=e}get inheritedTheme(){return super.inheritedTheme}dryPaint(){super.dryPaint();for(let e of this.children)e.dryPaint()}forceDirty(){super.forceDirty();for(let e of this.children)e.forceDirty()}get childCount(){return this._children.length}get children(){return this._children.values()}activate(e,t){super.activate(e,t);for(let r of this.children)r.activate(e,t)}deactivate(){super.deactivate();for(let e of this.children)e.deactivate()}};l(be,"Parent");var Re=class extends be{add(i){if(Array.isArray(i)){let e=this.active;for(let t of i)this._children.push(t),t.inheritedTheme=this.inheritedTheme,e&&t.activate(this.root,this)}else this._children.push(i),i.inheritedTheme=this.inheritedTheme,this.active&&i.activate(this.root,this);return this.forceDirty(),this}remove(i){if(Array.isArray(i)){let e=this.active;for(let t of i){let r=this._children.indexOf(t);r!==-1&&this._children.splice(r,1),e&&t.deactivate()}}else{let e=this._children.indexOf(i);e!==-1&&this._children.splice(e,1),this.active&&i.deactivate()}return this.forceDirty(),this}clearChildren(){if(this.active)for(let i of this._children)i.deactivate();return this._children.length=0,this.forceDirty(),this}};l(Re,"MultiParent");var ie=class extends Re{constructor(e,t){super([],!1,!0,t);this.backgroundDirty=!0;this.unusedSpace=0;this.enabledChildCount=0;this.vertical=e}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this.backgroundDirty=!0):e==="canvasFill"?this.backgroundDirty=!0:e==="multiContainerAlignment"?this._layoutDirty=!0:e==="multiContainerSpacing"&&(this._layoutDirty=!0)}handleEvent(e){let t=this.children;e.reversed&&(t=Array.from(t).reverse());for(let r of t){if(!r.enabled)continue;let n=r.dispatchEvent(e);if(n!==null)return n}return null}handlePreLayoutUpdate(){for(let e of this.children)e.preLayoutUpdate(),e.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(){for(let e of this.children)e.postLayoutUpdate(),e.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=0,o=0,a=0,d=this.vertical?n:t;this.multiContainerAlignment.cross==="stretch"&&(a=this.vertical?t:n,a==1/0&&(a=this.vertical?e:r)),this.enabledChildCount=0;for(let x of this.children){if(!x.enabled){x.resolveDimensions(0,0,0,0);continue}this.enabledChildCount++;let[R,U]=x.dimensions;this.vertical?x.resolveDimensions(a,t,0,1/0):x.resolveDimensions(0,1/0,a,n);let[G,ee]=x.dimensions;s+=x.flex,o=Math.max(this.vertical?G:ee,o),(G!==R||ee!==U)&&(this.backgroundDirty=!0)}let c=this.vertical?e:r;o<c&&(o=c);let f=this.multiContainerSpacing,m=Math.max(this.enabledChildCount-1,0)*f;for(let x of this.children)!x.enabled||(m+=this.vertical?x.dimensions[1]:x.dimensions[0]);let b=d-m;if(b==1/0||b<=0){let x=this.width,R=this.height;this.vertical?(this.width=o,this.height=Math.min(m,n)):(this.width=Math.min(m,t),this.height=o),(this.width!==x||this.height!==R)&&(this.backgroundDirty=!0),this.unusedSpace=0;let U=d;for(let G of this.children){if(!G.enabled)continue;let[ee,We]=G.dimensions;if(this.vertical){let Ee=Math.min(U,We);G.resolveDimensions(a,t,Ee,Ee)}else{let Ee=Math.min(U,ee);G.resolveDimensions(Ee,Ee,a,n)}let[fe,Ot]=G.dimensions;(fe!==ee||Ot!==We)&&(this.backgroundDirty=!0);let Kt=this.vertical?We:ee;U=Math.max(0,U-Kt-f)}return}let v=0,k=0;s>0&&(k=b/s);for(let x of this.children){if(!x.enabled)continue;v!==0&&(v+=f);let R=k*x.flex,[U,G]=x.dimensions;if(this.vertical){let fe=R+G;x.resolveDimensions(a,t,fe,fe)}else{let fe=R+U;x.resolveDimensions(fe,fe,a,n)}let[ee,We]=x.dimensions;v+=this.vertical?We:ee,(ee!==U||We!==G)&&(this.backgroundDirty=!0)}let _=this.width,S=this.height,P;this.vertical?(P=n,this.width=o,this.height=P):(P=t,this.width=P,this.height=o),(this.width!==_||this.height!==S)&&(this.backgroundDirty=!0),this.unusedSpace=Math.max(P-v,0)}afterPositionResolved(){let e=this.multiContainerAlignment,t=e.main==="around",r=e.main==="between"||t,n=r?0:e.main,s=e.cross==="stretch"?0:e.cross,o=this.enabledChildCount-1+(t?2:0),a;o<=0?a=0:a=this.unusedSpace/o;let d=this.multiContainerSpacing;r&&(d+=a);let u=(this.vertical?this.y:this.x)+n*this.unusedSpace;t&&(u+=a);for(let c of this.children){if(!c.enabled)continue;let[f,m]=c.position,[b,v]=c.dimensions;this.vertical?(c.resolvePosition(this.x+s*(this.width-b),u),u+=v+d):(c.resolvePosition(u,this.y+s*(this.height-v)),u+=b+d);let[k,_]=c.position;(k!==f||_!==m)&&(this.backgroundDirty=!0)}}handlePainting(e,t){let r=[];for(let n of this.children)n.paint(e,t),n.enabled&&(this.backgroundDirty||t)&&r.push(this.roundRect(...n.position,...n.dimensions,!0));if(this.backgroundDirty||t){this.clearStart(e),e.rect(...this.roundRect(this.x,this.y,this.width,this.height,!0));for(let n of r)e.rect(...n);this.clearEnd(e,"evenodd")}this.backgroundDirty=!1}dryPaint(){this.backgroundDirty=!1,super.dryPaint()}forceDirty(){super.forceDirty(),this.backgroundDirty=!0}};l(ie,"MultiContainer");var re=class extends be{constructor(i,e,t,r){super([i],e,t,r)}get child(){return this._children[0]}};l(re,"SingleParent");var ne=class extends re{constructor(e,t,r){super(e,!1,t,r);this.backgroundDirty=!0}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this.backgroundDirty=!0):e==="canvasFill"?this.backgroundDirty=!0:e==="containerPadding"?this._layoutDirty=!0:e==="containerAlignment"&&(this._layoutDirty=!0)}handleEvent(e){return this.child.dispatchEvent(e)}handlePreLayoutUpdate(){let e=this.child;e.preLayoutUpdate(),e.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(){let e=this.child;e.postLayoutUpdate(),e.dirty&&(this._dirty=!0),this.backgroundDirty&&(this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=this.containerPadding,o=s.left+s.right,a=s.top+s.bottom,d=t-o,u=n-a;d<0&&(d=0),u<0&&(u=0);let c=this.containerAlignment,f=0;c.horizontal==="stretch"&&(d!==1/0?f=d:f=Math.max(e-o,0));let m=0;c.vertical==="stretch"&&(u!==1/0?m=u:m=Math.max(r-a,0));let[b,v]=this.child.dimensions;this.child.resolveDimensions(f,d,m,u);let[k,_]=this.child.dimensions,[S,P]=[this.width,this.height];this.width=Math.max(e,k+o),this.height=Math.max(r,_+a),(this.width!==S||this.height!==P||k!==b||_!==v)&&(this.backgroundDirty=!0)}afterPositionResolved(){let e=this.containerPadding,t=this.containerAlignment,[r,n]=this.child.dimensions,s=r+e.left+e.right,o=n+e.top+e.bottom,a=this.x+e.left;if(t.horizontal!=="stretch"){let f=this.width-s;f>0&&(a+=f*t.horizontal)}let d=this.y+e.top;if(t.vertical!=="stretch"){let f=this.height-o;f>0&&(d+=f*t.vertical)}let[u,c]=this.child.position;this.child.resolvePosition(a,d),(u!==a||c!==d)&&(this.backgroundDirty=!0)}handleBaseContainerPainting(e,t,r=null){(this.backgroundDirty||t)&&(this.clearStart(e,r),e.rect(...this.roundRect(this.x,this.y,this.width,this.height,!0)),e.rect(...this.roundRect(...this.child.position,...this.child.dimensions,!0)),this.clearEnd(e,"evenodd"),this.backgroundDirty=!1),this.child.paint(e,t)}handlePainting(e,t){this.handleBaseContainerPainting(e,t)}dryPaint(){this.backgroundDirty=!1,super.dryPaint()}forceDirty(){super.forceDirty(),this.backgroundDirty=!0}};l(ne,"BaseContainer");var H=(t=>(t[t.Pointer=0]="Pointer",t[t.Keyboard=1]="Keyboard",t[t.Tab=2]="Tab",t))(H||{});var A=class extends pe{constructor(e,t,r,n,s){super(t,r,n,s,1,!0);this.key=e}};l(A,"KeyEvent");var W=class extends A{cloneWithTarget(i){return new W(this.key,this.shift,this.ctrl,this.alt,i)}};l(W,"KeyPress");var F=class extends ${constructor(i=null){super(i,0,!0)}cloneWithTarget(i){return new F(i)}};l(F,"Leave");var M=class extends D{constructor(e,t){super(e,t);this.subscribers=new Set}get fallbackTheme(){return super.fallbackTheme}set fallbackTheme(e){super.fallbackTheme=e}onThemeUpdated(e=null){for(let t of this.subscribers)t(e)}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}};l(M,"Theme");function ot(h,i=!0){return Math.pow(2,(i?Math.ceil:Math.floor)(Math.log2(h)))}l(ot,"roundToPower2");function lt(h){return(h&h-1)===0}l(lt,"isPower2");var Le=class{constructor(i=64,e=64){this.constraints=[0,1/0,0,1/0];this.maxCanvasWidth=1/0;this.maxCanvasHeight=1/0;this._dirty=!0;this.canvas=document.createElement("canvas"),this.canvas.width=i,this.canvas.height=e;let t=this.canvas.getContext("2d",{alpha:!0});if(t===null)throw new Error("Failed to get canvas context");this.context=t}get canvasDimensions(){return[this.canvas.width,this.canvas.height]}resolveChildsLayout(i){if(!i.layoutDirty&&!this._dirty)return!1;this._dirty=!1;let[e,t]=i.dimensions,[r,n,s,o]=this.constraints;i.resolveDimensionsAsTop(r,n,s,o),i.resolvePosition(0,0);let[a,d]=i.dimensions;if(a!==e||d!==t){let u=Math.min(Math.max(ot(a),this.canvas.width),this.maxCanvasWidth),c=Math.min(Math.max(ot(d),this.canvas.height),this.maxCanvasHeight);if(u===0||c===0?Le.dimensionlessWarned||(Le.dimensionlessWarned=!0,console.warn("Canvas has 0 width or height. Are you using an empty Root?")):(!lt(u)||!lt(c))&&(Le.powerOf2Warned||(Le.powerOf2Warned=!0,console.warn("Canvas has a width or height that is not a power of 2, which may create mipmapping issues. Make sure to use power of 2 starting and maximum canvas dimensions."))),u!==this.canvas.width||c!==this.canvas.height){let f=null;if(e!==0&&t!==0){f=document.createElement("canvas"),f.width=e,f.height=t;let m=f.getContext("2d");if(m===null)throw new Error("Failed to get context of temporary canvas for resizing original canvas");m.globalCompositeOperation="copy",m.drawImage(this.canvas,0,0,e,t,0,0,e,t)}this.canvas.width=u,this.canvas.height=c,f!==null&&(this.context.globalCompositeOperation="copy",this.context.drawImage(f,0,0,f.width,f.height,0,0,Math.min(f.width,this.maxCanvasWidth),Math.min(f.height,this.maxCanvasHeight)),this.context.globalCompositeOperation="source-over")}return!0}else return!1}getAppliedScale(i){let[e,t]=i.dimensions,r=1,n=1;return e>this.maxCanvasWidth&&(r=this.maxCanvasWidth/e),t>this.maxCanvasHeight&&(n=this.maxCanvasHeight/t),[r,n]}paintToCanvas(i,e){let t=i.dirty,[r,n]=this.getAppliedScale(i),s=r!==1||n!==1;return s&&(this.context.save(),this.context.scale(r,n)),i.paint(this.context,e),s&&this.context.restore(),t}},K=Le;l(K,"Viewport"),K.dimensionlessWarned=!1,K.powerOf2Warned=!1,y([et()],K.prototype,"constraints",2),y([ge],K.prototype,"maxCanvasWidth",2),y([ge],K.prototype,"maxCanvasHeight",2);var tt=class{constructor(i,e=null,t=new M){this.drivers=new Set;this._enabled=!0;this.pointerStyle="default";this._currentPointerStyle="default";this._foci=new Map([[1,null],[0,null],[2,null]]);this._fociCapturers=new Map([[1,null],[0,null],[2,null]]);this.textInputHandler=null;this._mobileTextInUse=!1;this._resolution=1;this.viewport=new K,this.child=i,this.pointerStyleHandler=e,this.child.inheritedTheme=t,this.child.activate(this,null)}get constraints(){return this.viewport.constraints}set constraints(i){this.viewport.constraints=i}get canvasDimensions(){return this.viewport.canvasDimensions}get dimensions(){return this.child.dimensions}get enabled(){return this._enabled}set enabled(i){if(this._enabled!==i)if(this._enabled=i,i)for(let t of this.drivers)t.onEnable(this);else{for(let t of this.drivers)t.onDisable(this);this.updatePointerStyle("default");for(let t of this._foci.keys())this.clearFocus(t)}}get canvas(){return this.viewport.canvas}resolveLayout(){return this.enabled?this.viewport.resolveChildsLayout(this.child):!1}paint(){return this.enabled?this.viewport.paintToCanvas(this.child,!1):!1}dispatchEvent(i){if(!this.enabled)return!1;if(i.focusType!==null&&i.target===null){let r=this._foci.get(i.focusType);if(typeof r=="undefined"&&(r=null),i.needsFocus&&r===null)return i instanceof W&&i.key==="Tab"&&this.dispatchEvent(new E(this.getFocus(2),i.shift)),!1;i=i.cloneWithTarget(r)}this.pointerStyle="default";let e=this.child.dispatchEvent(i);if(e===null&&(i.focusType!==null&&(this.clearFocus(i.focusType),i instanceof W&&i.key==="Tab"&&this.dispatchEvent(new E(this.getFocus(2),i.shift))),i instanceof E&&i.relativeTo!==null&&(i=new E(null,i.reversed),e=this.child.dispatchEvent(i))),i instanceof E&&(i.reachedRelative&&e===null&&(e=this.child.dispatchEvent(i)),e&&(!i.reachedRelative&&!tt.badTabCaptureWarned&&(tt.badTabCaptureWarned=!0,console.warn(`TabSelect event captured by widget (${e.constructor.name}), but reachedRelative was false; a widget type is probably capturing events by default`),console.groupCollapsed("Stack trace"),console.trace(),console.groupEnd()),this.requestFocus(2,e))),i.focusType===null)return e!==null;let t=this.getFocusCapturer(i.focusType);if(t===e)return e!==null;i.focusType===0&&t!==null&&this.child.dispatchEvent(new F(t)),this._fociCapturers.set(i.focusType,e);for(let r of this.drivers)r.onFocusCapturerChanged(this,i.focusType,t,e);return e!==null}preLayoutUpdate(){if(!!this.enabled){for(let i of this.drivers)i.update(this);this.child.preLayoutUpdate()}}postLayoutUpdate(){!this.enabled||(this.child.postLayoutUpdate(),this.updatePointerStyle())}updatePointerStyle(i=null){i!==null&&(this.pointerStyle=i),this.pointerStyle!==this._currentPointerStyle&&(this._currentPointerStyle=this.pointerStyle,this.pointerStyleHandler!==null&&this.pointerStyleHandler(this._currentPointerStyle))}requestFocus(i,e){if(e!==null){let t=this._foci.get(i);if(e!==t){this.clearFocus(i),this._foci.set(i,e),e.onFocusGrabbed(i);for(let n of this.drivers)n.onFocusChanged(this,i,e)}let r=null;if(i===1&&(r=2),i===2&&(r=1),r!==null&&e!==this._foci.get(r)){this.clearFocus(r),this._foci.set(r,e),e.onFocusGrabbed(r);for(let n of this.drivers)n.onFocusChanged(this,r,e)}}}dropFocus(i,e){let t=this._foci.get(i);e===t&&this.clearFocus(i)}clearFocus(i){let e=this._foci.get(i);if(e){e.onFocusDropped(i),this._foci.set(i,null);for(let t of this.drivers)t.onFocusChanged(this,i,null)}}getFocus(i){var e;return(e=this._foci.get(i))!=null?e:null}getFocusCapturer(i){var e;return(e=this._fociCapturers.get(i))!=null?e:null}registerDriver(i){this.drivers.has(i)||(this.drivers.add(i),this._enabled&&i.onEnable&&i.onEnable(this))}unregisterDriver(i){!this.drivers.delete(i)||this._enabled&&i.onDisable&&i.onDisable(this)}clearDrivers(){for(let i of this.drivers)this.unregisterDriver(i)}get hasMobileTextInput(){return this.textInputHandler!==null&&!this._mobileTextInUse}get usingMobileTextInput(){return this._mobileTextInUse}getTextInput(i=""){return Ct(this,null,function*(){if(this.textInputHandler!==null&&!this._mobileTextInUse){this._mobileTextInUse=!0;let e=yield this.textInputHandler(i);return this._mobileTextInUse=!1,e}return null})}get resolution(){return this._resolution}set resolution(i){this._resolution!==i&&(this._resolution=i,this.child.forceThemeUpdate())}get maxCanvasWidth(){return this.viewport.maxCanvasWidth}set maxCanvasWidth(i){this.viewport.maxCanvasWidth=i}get maxCanvasHeight(){return this.viewport.maxCanvasHeight}set maxCanvasHeight(i){this.viewport.maxCanvasHeight=i}get effectiveScale(){return this.viewport.getAppliedScale(this.child)}},w=tt;l(w,"Root"),w.badTabCaptureWarned=!1;var V=new Map;function ye(h){let i=V.get(h);return i===void 0?(console.warn(`Unknown debug feature "${h}"; defaulting to not enabled`),!1):i[0]}l(ye,"isDebugFeatureEnabled");function jt(h,i){let e=V.get(h);if(e===void 0){console.warn(`Unknown debug feature "${h}"; ignored`);return}let[t,r]=e;i===void 0&&(i=!t),t!==i&&(e[0]=i,console.info(`[canvas-ui] ${i?"En":"Dis"}abled "${h}" debug feature`))}l(jt,"toggleDebugFeature");function qt(){for(let[h,i]of V)console.info(`[canvas-ui] "${h}" (${i[0]?"en":"dis"}abled): ${i[1]}`)}l(qt,"listDebugFeatures");function it(h,i){let e=`${h.name}.${i}`,t=`watchflag.${e}`;if(V.has(t)){console.warn(`[canvas-ui] Already injected debug feature with name ${t}; ignored`);return}let r=`watchflag.${e}.strace`;if(V.has(r)){console.warn(`[canvas-ui] Already injected debug feature with name ${r}; ignored`);return}let n=new WeakMap;Object.defineProperty(h.prototype,i,{get(){return n.get(this)},set(s){if(ye(t)&&!n.get(this)&&s){let a=`[canvas-ui ${t}] ${this.constructor.name}.${i} set to true`;ye(r)?(console.groupCollapsed(a),console.trace(),console.groupEnd()):console.debug(a)}n.set(this,s)}}),V.set(t,[!1,`Show when ${e} is set to true`]),V.set(r,[!1,`Print stack trace when ${t} shows that a flag has been set`])}l(it,"injectWatchflagFeature");function rt(h,i,e=null){let t=`${h.name}.${i}`,r=`trace.${t}`;if(V.has(r)){console.warn(`[canvas-ui] Already injected debug feature with name ${r}; ignored`);return}let n=[],s=new Map,o=h.prototype[i],a=0;function d(){a===0&&(ye(r)&&console.debug(`[canvas-ui ${r}] Trace:
${n.join(`
`)}`),a=0,n.length=0,s.clear())}l(d,"logMsgStack"),h.prototype[i]=function(...u){a++;let c=s.get(this);if(c===void 0){c=n.length,s.set(this,c);let m;a>1?m="  ".repeat(a-2)+"> ":m="",n.push(`${m}${this.constructor.name}`)}else n[c]+=", recall";e!==null&&(n[c]+=e.apply(this,u));let f=new Date().getTime();try{let m=o.apply(this,u);return n[c]+=` <${new Date().getTime()-f} ms>`,m}catch(m){throw n[c]+=" <exception thrown>",m}finally{a--,d()}},V.set(r,[!1,`Trace ${t} method calls`])}l(rt,"injectTraceFeature");function Y(h,i){let e=`${h.name}.${i}`,t=`randomfill.${e}`;if(V.has(t)){console.warn(`[canvas-ui] Already injected debug feature with name ${t}; ignored`);return}let r=Object.getOwnPropertyDescriptor(h.prototype,i);Object.defineProperty(h.prototype,i,{get(){if(ye(t))return"#"+Math.floor(Math.random()*16777215).toString(16);if((r==null?void 0:r.get)!==void 0)return r.get.apply(this)},set(n){(r==null?void 0:r.set)!==void 0&&r.set.apply(this,[n])}}),V.set(t,[!1,`(EPILEPSY WARNING) Override the ${e} theme property with a new random colour every time the theme property's value is fetched. Useful for visualising widget painting`])}l(Y,"injectRandomFillFeature");function g(h,i){let e=`${h.name}.${i}`,t=`stacktrace.${e}`;if(V.has(t)){console.warn(`[canvas-ui] Already injected debug feature with name ${t}; ignored`);return}let r=h.prototype[i];h.prototype[i]=function(...n){return ye(t)&&(console.groupCollapsed(`${h.name}.${i} called`),console.trace(),console.groupEnd()),r.apply(this,n)},V.set(t,[!1,`Print stack trace when ${e} is called`])}l(g,"injectStackTraceFeature");var At=!1;function wr(){if(At){console.warn("[canvas-ui] Already injected debug code; ignored");return}At=!0,rt(p,"paint",(t,r)=>r?" (forced)":""),rt(p,"resolveDimensions",(t,r,n,s)=>` (${t}, ${r}, ${n}, ${s})`),rt(p,"resolvePosition",(t,r)=>` (${t}, ${r})`),rt(p,"dispatchEvent",t=>` (${t.constructor.name})`),g(w,"resolveLayout"),g(w,"paint"),g(w,"dispatchEvent"),g(w,"preLayoutUpdate"),g(w,"postLayoutUpdate"),g(w,"updatePointerStyle"),g(w,"requestFocus"),g(w,"dropFocus"),g(w,"clearFocus"),g(w,"getFocus"),g(w,"getFocusCapturer"),g(w,"registerDriver"),g(w,"unregisterDriver"),g(w,"clearDrivers"),g(w,"getTextInput"),g(p,"onThemeUpdated"),g(p,"onFocusDropped"),g(p,"handleEvent"),g(p,"dispatchEvent"),g(p,"handlePreLayoutUpdate"),g(p,"preLayoutUpdate"),g(p,"handleResolveDimensions"),g(p,"resolveDimensions"),g(p,"resolveDimensionsAsTop"),g(p,"afterPositionResolved"),g(p,"resolvePosition"),g(p,"handlePostLayoutUpdate"),g(p,"postLayoutUpdate"),g(p,"clear"),g(p,"clearStart"),g(p,"clearEnd"),g(p,"roundRect"),g(p,"handlePainting"),g(p,"paint"),g(p,"dryPaint"),g(p,"forceThemeUpdate"),g(p,"forceDirty"),g(p,"scaleFont"),it(p,"_dirty"),it(p,"_layoutDirty"),it(ne,"backgroundDirty"),it(ie,"backgroundDirty"),Y(D,"canvasFill"),Y(D,"primaryFill"),Y(D,"accentFill"),Y(D,"backgroundFill"),Y(D,"backgroundGlowFill"),Y(D,"bodyTextFill"),Y(D,"inputBackgroundFill"),Y(D,"inputSelectBackgroundFill"),Y(D,"inputTextFill"),Y(D,"inputTextFillDisabled"),Y(D,"inputTextFillInvalid"),V.set("textrendergroups",[!1,"Draw text render groups in a TextHelper with alternating background colours (green and red). Width overriding groups have a blue background and zero-width groups have a black background. Throws an exception on negative width groups"]);let h=new Map,i=C.prototype.paint;C.prototype.paint=function(t,r,n,s){h.set(this,!1),i.apply(this,[t,r,n,s])};let e=C.prototype.paintGroup;C.prototype.paintGroup=function(t,r,n,s,o){if(ye("textrendergroups")){let a=t.fillStyle,d=this.actualLineHeight,u=this.fullLineHeight;if(!r[3]&&r[2]>n){let c=h.get(this);t.fillStyle=c?"rgba(255, 0, 0, 0.5)":"rgba(0, 255, 0, 0.5)",t.fillRect(s,o-d,r[2]-n,u),h.set(this,!c),t.fillStyle=a}else{let c=r[2]-n;if(t.fillStyle=c>0?"rgba(0, 0, 255, 0.5)":"rgba(0, 0, 0, 0.5)",c==0)c=4;else if(c<0)throw new Error("Unexpected group with negative width");t.fillRect(s,o-d,c,u)}}e.apply(this,[t,r,n,s,o])},window.canvasDebug={enabled:ye,toggle:jt,list:qt},console.info("[canvas-ui] Injected debug code; the library will be slower"),console.info("[canvas-ui] Check if a debug feature is enabled in the console with canvasDebug.enabled(debugFeature: string)"),console.info("[canvas-ui] Enable a debug feature in the console with canvasDebug.toggle(debugFeature: string, enabled?: boolean)"),console.info("[canvas-ui] List debug features in the console with canvasDebug.list()")}l(wr,"injectDebugCode");function Fr(h){return new Promise((i,e)=>{function t(){document.body.removeChild(a),document.body.removeChild(o)}l(t,"closePopup");function r(){t(),i(h)}l(r,"cancelHandler");function n(){t(),i(u.value)}l(n,"okHandler");function s(b){b.key=="Enter"&&(b.preventDefault(),n())}l(s,"enterChecker");let o=document.createElement("div");o.id="textInputHandlerOverlay";let a=document.createElement("div");a.id="textInputHandler";let d=document.createElement("p");d.textContent="Change text:";let u=document.createElement("input");u.addEventListener("keyup",s),u.value=h;let c=document.createElement("div"),f=document.createElement("button");f.addEventListener("click",r),f.textContent="Cancel";let m=document.createElement("button");m.addEventListener("click",n),m.textContent="OK",c.appendChild(f),c.appendChild(m),a.appendChild(d),a.appendChild(u),a.appendChild(c),document.body.appendChild(o),document.body.appendChild(a),u.focus({preventScroll:!1})})}l(Fr,"DefaultTextInputHandler");var se=class extends ${constructor(e,t=null){super(t,1,!1);this.text=e}cloneWithTarget(e){return new se(this.text,e)}};l(se,"TextPasteEvent");var Ae=class extends w{constructor(e,t=new M){super(e,null,t);this.domElem=document.createElement("canvas"),this.domElem.tabIndex=1,[this.domElem.width,this.domElem.height]=this.dimensions;let r=this.domElem.getContext("2d",{alpha:!0});if(r===null)throw new Error("Failed to get DOM canvas context");this.domCanvasContext=r,this.pointerStyleHandler=n=>{this.domElem.style.cursor=n},this.domElem.addEventListener("paste",n=>{n.preventDefault(),n.clipboardData!==null&&this.dispatchEvent(new se(n.clipboardData.getData("text")))}),this.domElem.contentEditable="true",this.domElem.style.outline="0px solid transparent",this.domElem.style.caretColor="transparent",this.domElem.style.cursor="default"}update(){if(this.enabled)this.domElem.style.removeProperty("display");else{this.domElem.style.display="none";return}this.preLayoutUpdate(),this.resolveLayout()&&([this.domElem.width,this.domElem.height]=this.dimensions,this.autoScale()),this.postLayoutUpdate(),this.paint()&&(this.domCanvasContext.globalCompositeOperation="copy",this.domCanvasContext.drawImage(this.canvas,0,0))}get resolution(){return super.resolution}set resolution(e){super.resolution=e,this.autoScale()}autoScale(){let[e,t]=this.effectiveScale;this.domElem.style.width=(this.domElem.width/this.resolution/e).toString()+"px",this.domElem.style.height=(this.domElem.height/this.resolution/t).toString()+"px"}};l(Ae,"DOMRoot");var ve=class extends re{constructor(i,e){super(i,!1,!0,e)}handleEvent(i){return this.child.dispatchEvent(i)}handlePreLayoutUpdate(){let i=this.child;i.preLayoutUpdate(),i.layoutDirty&&(this._layoutDirty=!0)}handlePostLayoutUpdate(){let i=this.child;i.postLayoutUpdate(),i.dirty&&(this._dirty=!0)}handleResolveDimensions(i,e,t,r){let n=this.child;n.resolveDimensions(i,e,t,r),[this.width,this.height]=n.dimensions}afterPositionResolved(){this.child.resolvePosition(this.x,this.y)}handlePainting(i,e){this.child.paint(i,e)}};l(ve,"PassthroughWidget");var ce=class extends ve{constructor(e,t=[0,1/0,0,1/0],r){super(e,r);this._constraints=[0,1/0,0,1/0];this.constraints=[0,1/0,0,1/0];this._constraints=[...t]}handleResolveDimensions(e,t,r,n){var c,f;let s=(f=(c=this.root)==null?void 0:c.resolution)!=null?f:1,o=Math.min(Math.max(this._constraints[0]*s,e),t),a=Math.min(Math.max(this._constraints[2]*s,r),n),d=Math.min(Math.max(this._constraints[1]*s,e),t),u=Math.min(Math.max(this._constraints[3]*s,r),n);o>d&&(o=d),a>u&&(a=u),super.handleResolveDimensions(o,d,a,u)}};l(ce,"ArtificialConstraint"),y([Lt()],ce.prototype,"constraints",2);var j=(t=>(t[t.Released=0]="Released",t[t.Hover=1]="Hover",t[t.Hold=2]="Hold",t))(j||{});var Ve=class{constructor(i){this.clickHelpers=i}get lastClickState(){let i=0;for(let e of this.clickHelpers)e.lastClickState>i&&(i=e.lastClickState);return i}get clickState(){let i=0;for(let e of this.clickHelpers)e.clickState>i&&(i=e.clickState);return i}get clickStateChanged(){for(let i of this.clickHelpers)if(i.clickStateChanged)return!0;return!1}get wasClick(){for(let i of this.clickHelpers)if(i.wasClick&&i.clickStateChanged)return!0;return!1}};l(Ve,"CompoundClickHelper");var xe=class{constructor(i){this.lastClickState=0;this.clickState=0;this.clickStateChanged=!1;this.wasClick=!1;this.widget=i}setClickState(i,e){this.clickState!==i?(this.lastClickState=this.clickState,this.clickState=i,this.wasClick=e&&this.lastClickState===2,this.clickStateChanged=!0):this.clickStateChanged=!1}};l(xe,"GenericClickHelper");var L=class extends T{constructor(e,t,r,n,s,o,a,d,u=null){super(e,t,o,a,d,u,0);this.deltaX=r,this.deltaY=n,this.fromDrag=s}correctOffset(e,t){return new L(this.x-e,this.y-t,this.deltaX,this.deltaY,this.fromDrag,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(e){return new L(this.x,this.y,this.deltaX,this.deltaY,this.fromDrag,this.shift,this.ctrl,this.alt,e)}};l(L,"PointerWheel");var oe=class extends A{cloneWithTarget(i){return new oe(this.key,this.shift,this.ctrl,this.alt,i)}};l(oe,"KeyRelease");var Te=class extends T{constructor(e,t,r,n,s,o,a=null,d=null){super(e,t,n,s,o,a,d);this.button=r}get isLeft(){return this.button===0}get isPrimary(){return this.isLeft}get isRight(){return this.button===1}get isSecondary(){return this.isRight}get isMiddle(){return this.button===2}get isTertiary(){return this.isMiddle}};l(Te,"PointerButtonEvent");var B=class extends Te{constructor(i,e,t,r,n,s,o=null){super(i,e,t,r,n,s,o,0)}correctOffset(i,e){return new B(this.x-i,this.y-e,this.button,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(i){return new B(this.x,this.y,this.button,this.shift,this.ctrl,this.alt,i)}};l(B,"PointerRelease");var I=class extends Te{constructor(i,e,t,r,n,s,o=null){super(i,e,t,r,n,s,o)}correctOffset(i,e){return new I(this.x-i,this.y-e,this.button,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(i){return new I(this.x,this.y,this.button,this.shift,this.ctrl,this.alt,i)}};l(I,"PointerPress");var q=class extends xe{constructor(){super(...arguments);this.pointerPos=null;this.startingPointerPos=null;this.pointerButton=0}getNormalInRect(e,t,r,n,s,o){return[(e-r)/(n-r),(t-s)/(o-s)]}isPointInRect(e,t,r,n,s,o){return e>=r&&e<n&&t>=s&&t<o}isNormalInRect(e,t){return e>=0&&e<1&&t>=0&&t<1}handleClickEvent(e,t,r){if(e instanceof F)return t.dropFocus(0,this.widget),this.pointerPos=null,this.setClickState(0,!1);if(e instanceof T){this.pointerPos=this.getNormalInRect(e.x,e.y,...r);let n=this.isNormalInRect(...this.pointerPos);if(n)t.pointerStyle="pointer";else if(e.target===null)return t.dropFocus(0,this.widget),this.setClickState(0,!1);return e instanceof I&&e.button===this.pointerButton?(this.startingPointerPos=this.pointerPos,t.requestFocus(0,this.widget),this.setClickState(2,n)):e instanceof B&&e.button===this.pointerButton?(t.dropFocus(0,this.widget),n?this.setClickState(1,n):this.setClickState(0,n)):e.target===null?this.setClickState(1,n):this.setClickState(2,n)}else this.clickStateChanged=!1}};l(q,"ClickHelper");var le=class extends Ve{constructor(e){let t=new q(e),r=new xe(e);super([t,r]);this.pointerClickHelper=t,this.keyboardClickHelper=r}onFocusGrabbed(e){return e===1?(this.keyboardClickHelper.setClickState(1,!0),!0):!1}onFocusDropped(e){return e===1?(this.keyboardClickHelper.setClickState(0,!1),!0):!1}handleEvent(e,t,r,n){if(e instanceof L)return[!1,!1];if(e instanceof A){if(e instanceof W&&e.key==="Tab")return[!1,!1];if(e.key!=="Enter")return[!1,!0]}else if(!(e instanceof T||e instanceof F))return[!1,!1];return r?(e instanceof W?(this.pointerClickHelper.clickStateChanged=!1,this.keyboardClickHelper.setClickState(2,!0)):e instanceof oe?(this.pointerClickHelper.clickStateChanged=!1,this.keyboardClickHelper.setClickState(1,!0)):(this.keyboardClickHelper.clickStateChanged=!1,this.pointerClickHelper.handleClickEvent(e,t,n)),[this.clickStateChanged&&this.wasClick,!0]):(this.pointerClickHelper.clickStateChanged=!1,this.keyboardClickHelper.clickStateChanged=!1,[!1,!0])}};l(le,"ButtonClickHelper");var ke=class extends ne{constructor(e,t=null,r){super(e,!1,r);this.clickHelper=new le(this),this.callback=t,this.tabFocusable=!0}click(){if(this.callback!==null)try{this.callback()}catch(e){console.error("Exception in Icon callback",e)}}onFocusGrabbed(e){this.clickHelper.onFocusGrabbed(e)}onFocusDropped(e){this.clickHelper.onFocusDropped(e)}handleEvent(e){let[t,r]=this.clickHelper.handleEvent(e,this.root,this.callback!==null,[this.x,this.x+this.width,this.y,this.y+this.height]);return t&&this.click(),r?this:null}};l(ke,"Button");var _e=class extends ke{constructor(e,t=null,r){super(e,t,r);this.backgroundProperty="backgroundFill";this.forced=!1;this.childTheme=new M({canvasFill:this.getBackgroundFill()}),this.child.inheritedTheme=this.childTheme}updateBackground(){let e=this.backgroundProperty;if(this.forced)this.backgroundProperty="primaryFill";else switch(this.clickHelper.clickState){case 2:this.backgroundProperty="accentFill";break;case 1:this.backgroundProperty="backgroundGlowFill";break;default:this.backgroundProperty="backgroundFill";break}e!==this.backgroundProperty&&(this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill())}getBackgroundFill(){switch(this.backgroundProperty){case"primaryFill":return this.primaryFill;case"accentFill":return this.accentFill;case"backgroundGlowFill":return this.backgroundGlowFill;case"backgroundFill":return this.backgroundFill;default:throw new Error(`Unknown theme property: ${this.backgroundProperty}`)}}set inheritedTheme(e){e!==this.fallbackTheme&&(this.fallbackTheme=e,this.childTheme.fallbackTheme=e)}get inheritedTheme(){return this.fallbackTheme}onThemeUpdated(e=null){e===null?(this._layoutDirty=!0,this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill()):e===this.backgroundProperty?(this.backgroundDirty=!0,this.childTheme.canvasFill=this.getBackgroundFill()):e==="containerPadding"?this._layoutDirty=!0:e==="containerAlignment"&&(this._layoutDirty=!0)}onFocusGrabbed(e){super.onFocusGrabbed(e),e===1&&this.updateBackground()}onFocusDropped(e){super.onFocusDropped(e),e===1&&this.updateBackground()}handleEvent(e){let t=super.handleEvent(e);return this.clickHelper.clickStateChanged&&this.updateBackground(),t}handlePainting(e,t){this.handleBaseContainerPainting(e,t,this.getBackgroundFill())}};l(_e,"FilledButton"),y([Je(_e.prototype.updateBackground)],_e.prototype,"forced",2);var Z=class extends p{constructor(e,t){super(!0,!1,t);this.textGetter=null;this.wrapText=!0;this.textHelper=new C,this.textHelper.wrapMode=1,this.source=e}set source(e){e instanceof Function?this.textGetter=e:(this.textGetter=null,this.textHelper.text=e)}get source(){return this.textGetter!==null?this.textGetter:this.textHelper.text}get text(){return this.textHelper.text}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="bodyTextFont"||e==="labelMinWidth"||e==="labelMinAscent"||e==="labelMinDescent"?(this._layoutDirty=!0,this._dirty=!0):e==="bodyTextFill"&&(this._dirty=!0)}handlePreLayoutUpdate(){this.textGetter!==null&&(this.textHelper.text=this.textGetter()),this.textHelper.font=this.bodyTextFont,this.textHelper.lineHeight=this.bodyTextHeight,this.textHelper.lineSpacing=this.bodyTextSpacing,this.textHelper.alignMode=this.bodyTextAlign,this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handleResolveDimensions(e,t,r,n){this.textHelper.maxWidth=this.wrapText?t:1/0,this.textHelper.dirty&&(this._dirty=!0),this.width=Math.max(Math.min(this.textHelper.width,t),e),this.height=Math.max(Math.min(this.textHelper.height,n),r)}handlePainting(e,t){this.wrapText||(e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip()),this.textHelper.paint(e,this.bodyTextFill,this.x,this.y),this.wrapText||e.restore()}};l(Z,"Label"),y([z],Z.prototype,"wrapText",2);var we=class extends _e{constructor(i,e=null,t){let r=Q({},t);r.containerAlignment={horizontal:.5,vertical:"stretch"};let n=new Z(i,t);n.wrapText=!1,super(n,e,r)}};l(we,"TextButton");var Ie=class extends ce{constructor(i,e=null,t,r=0,n=24,s=24,o){e===null&&(e=i);function a(){return t.shift?e===null?i:e:i}l(a,"getGlyph"),super(new we(a,()=>t.callback(a()),o),[n,1/0,s,1/0],o),this.flex=r}};l(Ie,"GlyphVirtualKey");var ae=class extends ie{constructor(i){super(!1,i)}};l(ae,"Row");var Ue=class extends ae{constructor(i,e,t=0,r=24,n=24,s){super(s);for(let o of i)if(typeof o=="function"){let a=o;this.add(a(e,s))}else if(typeof o[0]=="string"&&typeof o[1]=="string"){let a=o[0],d=o[1];for(let u=0;u<a.length;u++){let c=null;u<d.length&&(c=d[u]),this.add(new Ie(a[u],c,e,t,r,n,s))}}else throw new Error(`Unknown virtual key row template format for entry: ${o}`)}};l(Ue,"VirtualKeyRow");var N=class extends ce{constructor(i,e,t=0,r=24,n=24,s){super(new we(i,e,s),[r,1/0,n,1/0],s),this.flex=t}};l(N,"VirtualKey");var X=class extends N{constructor(i,e,t,r=0,n=24,s=24,o){super(i,()=>t.callback(e),r,n,s,o)}};l(X,"BasicVirtualKey");var Be=class extends X{constructor(i,e=0,t=60,r=24,n){super("Backspace","Backspace",i,e,t,r,n)}};l(Be,"BackspaceKey");var Oe=class extends X{constructor(i,e=0,t=24,r=24,n){super("Esc","Escape",i,e,t,r,n)}};l(Oe,"EscapeKey");var Ke=class extends X{constructor(i,e=0,t=72,r=24,n){super("Enter","Enter",i,e,t,r,n)}};l(Ke,"EnterKey");var Ge=class extends N{constructor(i,e=0,t=84,r=24,n){super("Shift",()=>{i.shift=!i.shift,this.child.forced=i.shift,i.callback("Shift")},e,t,r,n),this.child.forced=i.shift}};l(Ge,"ShiftKey");var $e=class extends X{constructor(i,e=1,t=84,r=24,n){super("Space"," ",i,e,t,r,n)}};l($e,"SpaceKey");var Ye=class extends ie{constructor(i){super(!0,i)}};l(Ye,"Column");function Zt(h,i){return new Ke(h,void 0,void 0,void 0,i)}l(Zt,"EnterKeyTemplate");function Jt(h,i){return new Ge(h,void 0,void 0,void 0,i)}l(Jt,"ShiftKeyTemplate");function ei(h,i){return new Be(h,void 0,void 0,void 0,i)}l(ei,"BackspaceKeyTemplate");function ti(h,i){return new $e(h,void 0,void 0,void 0,i)}l(ti,"SpaceKeyTemplate");function ii(h,i){return new Oe(h,void 0,void 0,void 0,i)}l(ii,"EscapeKeyTemplate");var Ne=[[["`1234567890-=","~!@#$%^&*()_+"]],[["qwertyuiop[]\\","QWERTYUIOP{}|"]],[["asdfghjkl;'",'ASDFGHJKL:"'],Zt],[Jt,["zxcvbnm,./","ZXCVBNM<>?"]],[ei,ti,ii]],Pe=class extends Ye{constructor(i,e=Ne,t=0,r=24,n=24,s){let o=Q({},s);o.multiContainerAlignment={main:"between",cross:"stretch"},super(o);let a={callback:d=>{i.keyPress(d,a.shift,a.ctrl,a.alt)},shift:!1,ctrl:!1,alt:!1};for(let d of e)this.add(new Ue(d,a,t,r,n,o))}};l(Pe,"VirtualKeyboard");var he=class extends ne{constructor(i,e){super(i,!0,e)}};l(he,"Container");var Fe=class extends he{constructor(i,e){let t=Q({},e);t.containerAlignment={horizontal:.5,vertical:.5},super(i,t)}};l(Fe,"Margin");var at=class extends Ae{constructor(e,t=Ne,r=new M){super(new Fe(new Pe(e,t)),r);this.keyboardDriver=e}update(){this.enabled=this.keyboardDriver.getFocusedRoot()!==null,super.update()}};l(at,"DOMVirtualKeyboardRoot");var ht=class extends w{constructor(e,t=Ne,r=null,n=new M){super(new Fe(new Pe(e,t)),r,n);this.keyboardDriver=e}updateVisibility(){this.enabled=this.keyboardDriver.getFocusedRoot()!==null}};l(ht,"VirtualKeyboardRoot");var Xe=class{constructor(){this.eventQueues=new Map;this.keysDown=new Set;this.focus=null;this.lastActivity=null}getEventQueue(i){if(i===null)return null;let e=this.eventQueues.get(i);return typeof e=="undefined"?null:e}changeFocusedRoot(i){this.focus!==i&&(this.focus!==null&&this.focus.clearFocus(1),this.focus=i,this.keysDown.clear())}getFocusedRoot(){return this.focus}getEffectiveFocusedRoot(){return this.focus?this.focus:this.lastActivity?this.lastActivity:this.eventQueues.size>0?this.eventQueues.keys().next().value:null}clearFocus(){this.changeFocusedRoot(null)}keyDown(i,e,t,r){this.keysDown.add(i);let n=this.getEventQueue(this.getEffectiveFocusedRoot());n!==null&&n.push(new W(i,e,t,r,null))}keyUp(i,e,t,r){if(this.keysDown.delete(i)){let n=this.getEventQueue(this.getEffectiveFocusedRoot());n!==null&&n.push(new oe(i,e,t,r,null))}}keyPress(i,e,t,r){let n=this.isKeyDown(i);this.keyDown(i,e,t,r),n||this.keyUp(i,e,t,r)}isKeyDown(i){return this.keysDown.has(i)}onEnable(i){this.eventQueues.has(i)||this.eventQueues.set(i,[])}onDisable(i){this.eventQueues.has(i)&&(this.eventQueues.delete(i),i===this.focus&&this.clearFocus())}update(i){let e=this.getEventQueue(i);if(e!==null){for(let t of e)i.dispatchEvent(t);e.length=0}}onFocusChanged(i,e,t){t!==null&&(this.lastActivity=i),e===1&&i!==this.focus&&t!==null&&this.changeFocusedRoot(i)}onFocusCapturerChanged(i,e,t,r){}};l(Xe,"KeyboardDriver");var ri=new Set(["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp","Tab"," "]),ni=new Set(["a","A"]),si=new Set(["Tab"]);function Vt(h){return[h.key,h.shiftKey,h.ctrlKey,h.altKey]}l(Vt,"unpackKeyboardEvent");var dt=class extends Xe{constructor(){super(...arguments);this.domElems=new Set}maybePreventDefault(e){var t,r;(ri.has(e.key)||ni.has(e.key)&&e.ctrlKey)&&(si.has(e.key)||((r=(t=this.getFocusedRoot())==null?void 0:t.getFocus(1))!=null?r:null)!==null)&&e.preventDefault()}bindDOMElem(e,t=!0){this.domElems.has(e)||(this.domElems.add(e),t&&(e.addEventListener("keydown",r=>{this.maybePreventDefault(r),this.keyDown(...Vt(r))}),e.addEventListener("keyup",r=>{this.maybePreventDefault(r),this.keyUp(...Vt(r))})),e.addEventListener("blur",r=>{this.shouldClearFocus(r.relatedTarget)&&this.clearFocus()}))}shouldClearFocus(e){return e===null||!this.domElems.has(e)}};l(dt,"DOMKeyboardDriver");function ut(h,i){let e=i.getBoundingClientRect();return[(h.clientX-e.left)/e.width,(h.clientY-e.top)/e.height]}l(ut,"getPointerEventNormPos");var J=class extends T{constructor(i,e,t,r,n,s=null){super(i,e,t,r,n,s,0)}correctOffset(i,e){return new J(this.x-i,this.y-e,this.shift,this.ctrl,this.alt,this.target)}cloneWithTarget(i){return new J(this.x,this.y,this.shift,this.ctrl,this.alt,i)}};l(J,"PointerMove");var It=(t=>(t[t.None=0]="None",t[t.Hovering=1]="Hovering",t[t.Pressing=2]="Pressing",t))(It||{});var Ce=class{constructor(){this.states=new Map;this.nextPointerID=0;this.hints=new Map;this.dragToScroll=new Map}unassignPointer(i,e){e.pointer!==null&&this.setPointerHint(e.pointer,0),e.pointer=null,e.hovering&&e.eventQueue.push(new F(i.getFocusCapturer(0))),e.hovering=!1,e.pressing=0,e.dragLast=null}registerPointer(i=!1){let e=this.nextPointerID++;return this.setPointerHint(e,0),this.dragToScroll.set(e,i),e}unregisterPointer(i){for(let[e,t]of this.states)t.pointer===i&&this.unassignPointer(e,t);this.hints.delete(i),this.dragToScroll.delete(i)}canQueueEvent(i,e,t,r){let n=t.pointer===null;n&&(t.pointer=e);let s=t.pointer===e;if(!s||n)for(let[o,a]of this.states)o!==i&&a.pointer===e&&this.unassignPointer(o,a);return!s&&(!r||t.pressing>0)?!1:(r&&t.pointer!==e&&(this.unassignPointer(i,t),t.pointer=e),!0)}denormaliseCoords(i,e,t){let[r,n]=i.dimensions;return[e*r,t*n]}movePointer(i,e,t,r,n,s,o,a){let d=this.states.get(i);if(typeof d=="undefined"||(n===null&&(n=d.pressing),!this.canQueueEvent(i,e,d,n>0)))return;d.hovering=!0;let[u,c]=this.denormaliseCoords(i,t,r);if(n!==d.pressing){let f=Math.floor(Math.log2(Math.max(n,d.pressing)));for(let m=0;m<=f;m++){let b=(d.pressing>>m&1)===1,v=(n>>m&1)===1;b!==v&&(v?d.eventQueue.push(new I(u,c,m,s,o,a)):d.eventQueue.push(new B(u,c,m,s,o,a)))}d.pressing=n}else d.eventQueue.push(new J(u,c,s,o,a));d.pressing>0?this.setPointerHint(e,2):this.setPointerHint(e,1)}leavePointer(i,e){let t=this.states.get(i);typeof t!="undefined"&&t.hovering&&t.pointer==e&&(t.hovering=!1,t.pressing=0,t.dragLast=null,t.eventQueue.push(new F(i.getFocusCapturer(0))),this.setPointerHint(e,0))}leaveAnyPointer(i){for(let e of this.states.keys())this.leavePointer(e,i)}wheelPointer(i,e,t,r,n,s,o,a,d){let u=this.states.get(i);if(typeof u=="undefined"||!this.canQueueEvent(i,e,u,!0))return;u.hovering=!0;let[c,f]=this.denormaliseCoords(i,t,r);u.eventQueue.push(new L(c,f,n,s,!1,o,a,d))}setPointerHint(i,e){return this.hints.get(i)!==e?(this.hints.set(i,e),!0):!1}getPointerHint(i){var e;return(e=this.hints.get(i))!=null?e:0}onEnable(i){this.states.set(i,{eventQueue:[],pointer:null,pressing:0,hovering:!1,dragLast:null,dragOrigin:[0,0]})}onDisable(i){i.dispatchEvent(new F);let e=this.states.get(i);typeof e!="undefined"&&e.pointer!==null&&(this.setPointerHint(e.pointer,0),e.dragLast=null),this.states.delete(i)}update(i){let e=this.states.get(i);if(typeof e=="undefined")return;let t=e.pointer===null?!1:this.dragToScroll.get(e.pointer);for(let r of e.eventQueue){if(r instanceof T&&e.dragLast!==null){let[n,s]=e.dragLast;i.dispatchEvent(new L(...e.dragOrigin,n-r.x,s-r.y,!1,!1,!1,!0)),r instanceof B?e.dragLast=null:(e.dragLast[0]=r.x,e.dragLast[1]=r.y);continue}i.dispatchEvent(r)?e.dragLast=null:t&&r instanceof I&&(e.dragLast=[r.x,r.y],e.dragOrigin[0]=r.x,e.dragOrigin[1]=r.y)}e.eventQueue.length=0}onFocusChanged(i,e,t){}onFocusCapturerChanged(i,e,t,r){}};l(Ce,"PointerDriver");function Ut(h){return[h.shiftKey,h.ctrlKey,h.altKey]}l(Ut,"unpackModifiers");var ct=class extends Ce{constructor(){super();this.domElems=new WeakMap;this.pointers=new Map;this.mousePointerID=this.registerPointer(!1)}bindDOMElem(e,t){let r=this.domElems.get(e);typeof r!="undefined"?this.removeListeners(r):(r={domElem:t,pointerListen:null,pointerleaveListen:null,wheelListen:null,contextMenuListen:null},this.domElems.set(e,r),t.style.touchAction="none"),e.enabled&&this.addListeners(e,r)}getPointerID(e){let t=this.pointers.get(e.pointerId);return typeof t=="undefined"&&(e.pointerType==="mouse"?t=this.mousePointerID:t=this.registerPointer(!0),this.pointers.set(e.pointerId,t)),t}addListeners(e,t){let r=t.domElem;t.pointerListen=n=>{this.movePointer(e,this.getPointerID(n),...ut(n,r),n.buttons,...Ut(n))},t.pointerleaveListen=n=>{this.leavePointer(e,this.getPointerID(n))},t.wheelListen=n=>{this.wheelPointer(e,this.mousePointerID,...ut(n,r),n.deltaX,n.deltaY,...Ut(n))},t.contextMenuListen=n=>{n.preventDefault()},r.addEventListener("pointermove",t.pointerListen),r.addEventListener("pointerdown",t.pointerListen),r.addEventListener("pointerup",t.pointerListen),r.addEventListener("pointerleave",t.pointerleaveListen),r.addEventListener("wheel",t.wheelListen),r.addEventListener("contextmenu",t.contextMenuListen)}removeListeners(e){e.pointerListen!==null&&(e.domElem.removeEventListener("pointermove",e.pointerListen),e.domElem.removeEventListener("pointerdown",e.pointerListen),e.domElem.removeEventListener("pointerup",e.pointerListen),e.pointerListen=null),e.pointerleaveListen!==null&&(e.domElem.removeEventListener("pointerleave",e.pointerleaveListen),e.pointerleaveListen=null),e.wheelListen!==null&&(e.domElem.removeEventListener("wheel",e.wheelListen),e.wheelListen=null),e.contextMenuListen!==null&&(e.domElem.removeEventListener("contextmenu",e.contextMenuListen),e.contextMenuListen=null)}onEnable(e){super.onEnable(e);let t=this.domElems.get(e);typeof t!="undefined"&&this.addListeners(e,t)}onDisable(e){super.onDisable(e);let t=this.domElems.get(e);typeof t!="undefined"&&this.removeListeners(t)}};l(ct,"DOMPointerDriver");var mt=class extends Ce{constructor(){super(...arguments);this.sources=new Set}handlePointerRay(e,t,r,n,s,o,a){let[d,u,c]=this.castRay(r,n);d===null?this.leaveAnyPointer(e):this.movePointer(d,e,u,c,t,s,o,a)}addSource(e){this.sources.has(e)||(e.setRayPointerDriver(this),this.sources.add(e))}setPointerHint(e,t){let r=super.setPointerHint(e,t);for(let n of this.sources)n.onPointerHintChanged(e,t);return r}};l(mt,"RayPointerDriver");var Qe=class{constructor(i){this._dirty=!1;this._value=i}get value(){return this._value}set value(i){this.setValue(i)}get dirty(){let i=this._dirty;return this._dirty=!1,i}setValue(i,e=!0){return this._value===i?!1:(this._value=i,e&&(this._dirty=!0),!0)}};l(Qe,"Variable");var de=class extends Qe{constructor(){super(...arguments);this.callbacks=new Set}hasCallback(e){return this.callbacks.has(e)}watch(e){return this.hasCallback(e)?!1:(this.callbacks.add(e),!0)}unwatch(e){return this.callbacks.delete(e)}setValue(e,t=!0){let r=super.setValue(e,t);if(r&&t)for(let n of this.callbacks)try{n(e)}catch(s){console.error("Exception in Variable callback",s)}return r}};l(de,"WatchableVariable");var ft=class extends M{constructor(i=new M){super(void 0,i)}get canvasFill(){return"#"+Math.floor(Math.random()*16777215).toString(16)}set canvasFill(i){super.canvasFill=i}};l(ft,"DebugTheme");function po(h,i,e=null){return t=>{let r=!0,n=t;for(let s of h)if([r,n]=s(n),!r)return[!1,i];if(e!==null)try{e(n)}catch(s){console.warn("Exception in CompositeValidator callback:",s)}return[!0,n]}}l(po,"MakeCompositeValidator");function oi(h){return[!0,h]}l(oi,"DefaultTextValidator");function Bt(h=null){return h===null?oi:i=>(h(i),[!0,i])}l(Bt,"MakeDefaultTextValidatorWithCallback");var li=/^-?(\.\d+|\d+(\.(\d+)?)?)(e\d+)?$/;function yo(h){return li.test(h)?[!0,parseFloat(h)]:[!1,NaN]}l(yo,"FloatValidator");var ai=/^-?\d+$/;function xo(h){return ai.test(h)?[!0,parseInt(h)]:[!1,NaN]}l(xo,"IntValidator");function ko(h,i){return e=>e<h?[!1,e]:e>i?[!1,e]:[!0,e]}l(ko,"MakeRangeValidator");var pt=class extends N{constructor(i,e=0,t=42,r=24,n){super("Alt",()=>{i.alt=!i.alt,this.child.forced=i.alt,i.callback("Alt")},e,t,r,n),this.child.forced=i.alt}};l(pt,"AltKey");var gt=class extends N{constructor(i,e=0,t=42,r=24,n){super("Ctrl",()=>{i.ctrl=!i.ctrl,this.child.forced=i.ctrl,i.callback("Control")},e,t,r,n),this.child.forced=i.ctrl}};l(gt,"ControlKey");var me=class extends p{constructor(e,t=null,r="",n){super(!1,!1,n);this.blinkStart=0;this.blinkWasOn=null;this.cursorPos=0;this.cursorOffset=[0,0];this.selectPos=0;this.selectOffset=[0,0];this.cursorOffsetDirty=!1;this._editingEnabled=!0;this.hideText=!1;this.offset=[0,0];this.wrapText=!0;this.inputFilter=null;this.dragging=!1;this.lastClick=0;this.dragStart=-1;this.successiveClickCount=0;this.typeableTab=!1;this.tabFocusable=!0,this.textHelper=new C,this.variable=new de(r),this.variable.watch(s=>{let[o,a]=e(s);o&&(this._validValue=a),o!==this._valid&&(this._valid=o,this._dirty=!0)}),[this._valid,this._validValue]=e(r),this.inputFilter=t}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0,this.cursorOffsetDirty=!0):e==="inputTextInnerPadding"||e==="inputTextFont"||e==="inputTextMinAscent"||e==="inputTextMinDescent"?(this._layoutDirty=!0,this._dirty=!0):e==="inputBackgroundFill"||e==="inputTextFill"||e==="inputTextFillInvalid"||e==="inputTextFillDisabled"||e==="cursorThickness"?this._dirty=!0:e==="inputTextAlign"&&(this.cursorOffsetDirty=!0)}get blinkOn(){if(this.blinkStart===0)return null;let e=this.blinkRate;return Math.trunc((Date.now()-this.blinkStart)/(500*e)%2)===0}get editingEnabled(){return this._editingEnabled}set editingEnabled(e){this._editingEnabled!==e&&(this._editingEnabled=e,e||(this.blinkStart=0,this.moveCursorTo(0,!1)),this._dirty=!0)}set text(e){this.variable.value=e;let t=this.variable.value.length;this.cursorPos>t&&(this.cursorPos=t,this.cursorOffsetDirty=!0),this.selectPos>t&&(this.selectPos=t,this.cursorOffsetDirty=!0)}get text(){return this.variable.value}get displayedText(){return this.hideText?"\u25CF".repeat(this.variable.value.length):this.variable.value}get valid(){return this._valid}get validValue(){return this._validValue}get line(){return this.textHelper.getLine(this.cursorPos)}moveCursorTo(e,t){this.cursorPos=Math.min(Math.max(e,0),this.text.length),t||(this.selectPos=this.cursorPos),this.cursorOffsetDirty=!0,this._dirty=!0}moveCursor(e,t){this.moveCursorTo(this.cursorPos+e,t)}moveCursorFromOffset(e,t,r){[this.cursorPos,this.cursorOffset]=this.textHelper.findIndexOffsetFromOffset([e,t]),r||(this.selectPos=this.cursorPos,this.selectOffset=this.cursorOffset),this.blinkStart=Date.now(),this._dirty=!0}moveCursorLine(e,t){this.moveCursorFromOffset(this.cursorOffset[0],this.cursorOffset[1]+(.5+e)*this.textHelper.fullLineHeight,t)}moveCursorStart(e){this.moveCursorTo(this.textHelper.getLineStart(this.line),e)}moveCursorEnd(e){this.moveCursorTo(this.textHelper.getLineEnd(this.line,!1),e)}moveCursorWord(e,t){if(e==0)return;let r=/\w/,n=this.text,s=this.cursorPos;if(e>0)for(;e>0;){let o=!1;for(;s<=n.length;s++)if(s<n.length&&r.test(n[s]))o=!0;else if(o)break;e--}else for(;e<0;){s--;let o=!1;for(;s>=0;s--)if(s>=0&&r.test(n[s]))o=!0;else if(o)break;s++,e++}this.moveCursorTo(s,t)}deleteRange(e,t){e!==t&&(this.variable.value=this.text.substring(0,e)+this.text.substring(t),this.cursorPos=this.selectPos=e,this.cursorOffsetDirty=!0)}deleteWord(e){if(e===0)return;if(this.cursorPos!==this.selectPos){this.deleteRange(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos));return}let t=this.cursorPos;this.moveCursorWord(e,!1),t!==this.cursorPos&&this.deleteRange(Math.min(t,this.cursorPos),Math.max(t,this.cursorPos))}insertText(e){if(!(this.inputFilter!==null&&!this.inputFilter(e)))if(this.selectPos===this.cursorPos)this.variable.value=this.text.substring(0,this.cursorPos)+e+this.text.substring(this.cursorPos),this.moveCursor(e.length,!1);else{let t=Math.min(this.cursorPos,this.selectPos),r=Math.max(this.cursorPos,this.selectPos);this.variable.value=this.text.substring(0,t)+e+this.text.substring(r),this.moveCursorTo(t+e.length,!1)}}deleteText(e){e!==0&&(this.cursorPos!==this.selectPos?this.deleteRange(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos)):e>0?this.variable.value=this.text.substring(0,this.cursorPos)+this.text.substring(this.cursorPos+e):(this.variable.value=this.text.substring(0,this.cursorPos+e)+this.text.substring(this.cursorPos),this.moveCursor(e,!1)))}selectRangeAt(e){let t=this.text,r=/\w/,n=r.test(t[e]),s=e;for(;e>=0&&r.test(t[e])===n;e--);let o=e+1;for(e=s;e<t.length&&r.test(t[e])===n;e++);return[o,e]}onFocusGrabbed(e){e===1&&this.blinkStart===0&&(this.blinkStart=Date.now(),this.selectPos=this.variable.value.length,this.cursorPos=this.selectPos,this.cursorOffsetDirty=!0)}onFocusDropped(e){e===1&&(this.blinkStart=0)}handleEvent(e){if(!this._editingEnabled)return null;let t=this.root;if(e instanceof F)return this.dragging=!1,this.lastClick=0,this;if(e instanceof L)return null;if(e instanceof T){if(t.pointerStyle="text",e instanceof I||e instanceof J){let r=e instanceof I&&e.isPrimary;if(r){this.dragging=!0;let s=new Date().getTime();s-this.lastClick<500?(this.successiveClickCount++,this.successiveClickCount>2&&(this.successiveClickCount=0)):this.successiveClickCount=0,this.lastClick=s}else if(!this.dragging)return this;let n=this.inputTextInnerPadding;if(this.moveCursorFromOffset(e.x-this.x-n+this.offset[0],e.y-this.y-n+this.offset[1],!r&&this.dragging),r&&(this.cursorPos!==this.dragStart&&(this.successiveClickCount=0),this.dragStart=this.cursorPos),this.successiveClickCount>0){let s,o;if(this.successiveClickCount===1){let[a,d]=this.selectRangeAt(this.dragStart),[u,c]=this.selectRangeAt(this.cursorPos);s=Math.min(a,u),o=Math.max(d,c)}else{let a=Math.min(this.cursorPos,this.dragStart),d=this.textHelper.getLine(a);s=this.textHelper.getLineStart(d);let u=Math.max(this.cursorPos,this.dragStart),c=this.textHelper.getLine(u);o=this.textHelper.getLineEnd(c)}this.cursorPos>=this.dragStart?(this.selectPos=s,this.cursorPos=o):(this.selectPos=o,this.cursorPos=s),this.cursorOffsetDirty=!0}t.requestFocus(1,this)}else e instanceof B&&e.isPrimary&&(this.dragging=!1,t.hasMobileTextInput&&t.getTextInput(this.text).then(r=>{r!==null&&this.text!==r&&(this.text=r,this.moveCursorTo(r.length,!1))}));return this}else if(e instanceof W){if(this.dragging=!1,this.lastClick=0,e.alt)return this;if(e.ctrl){if(e.key==="Backspace")this.deleteWord(-1);else if(e.key==="Delete")this.deleteWord(1);else if(e.key==="ArrowLeft")this.moveCursorWord(-1,e.shift);else if(e.key==="ArrowRight")this.moveCursorWord(1,e.shift);else if(e.key==="c"||e.key==="C"){if(this.cursorPos===this.selectPos)return this;let r=this.text.slice(Math.min(this.cursorPos,this.selectPos),Math.max(this.cursorPos,this.selectPos));if(navigator.clipboard)navigator.clipboard.writeText(r);else return this}else if(e.key==="a"||e.key==="A")this.cursorPos=this.text.length,this.selectPos=0,this.cursorOffsetDirty=!0,this._dirty=!0;else return this;return this.blinkStart=Date.now(),this}if(e.key.length===1)this.insertText(e.key);else if(e.key==="Backspace")this.deleteText(-1);else if(e.key==="Delete")this.deleteText(1);else if(e.key==="ArrowLeft")this.moveCursor(-1,e.shift);else if(e.key==="ArrowRight")this.moveCursor(1,e.shift);else if(e.key==="ArrowUp")this.moveCursorLine(-1,e.shift);else if(e.key==="ArrowDown")this.moveCursorLine(1,e.shift);else if(e.key==="PageUp")this.moveCursorLine(-5,e.shift);else if(e.key==="PageDown")this.moveCursorLine(5,e.shift);else if(e.key==="Home")this.moveCursorStart(e.shift);else if(e.key==="End")this.moveCursorEnd(e.shift);else{if(e.key==="Escape")return t.dropFocus(1,this),this;if(e.key==="Enter")this.insertText(`
`);else if(e.key==="Tab")if(this.typeableTab){if(e.shift)return t.dispatchEvent(new E(this,!1)),this;this.insertText("	")}else return null;else return this}this.blinkStart=Date.now()}else if(e instanceof se)e.target===this&&(this.insertText(e.text),this.blinkStart=Date.now());else if(e.target!==this)return null;return this}handlePreLayoutUpdate(){this.editingEnabled||this.root.dropFocus(1,this),this.blinkOn!==this.blinkWasOn&&(this._dirty=!0),this.textHelper.text=this.displayedText,this.textHelper.font=this.inputTextFont,this.textHelper.lineHeight=this.inputTextHeight,this.textHelper.lineSpacing=this.inputTextSpacing,this.textHelper.alignMode=this.inputTextAlign,this.textHelper.dirty&&(this._dirty=!0,this._layoutDirty=!0)}handleResolveDimensions(e,t,r,n){let s=2*this.inputTextInnerPadding;this.textHelper.maxWidth=this.wrapText?Math.max(t-s,0):1/0,this.textHelper.dirty&&(this._dirty=!0);let o=Math.min(Math.max(this.inputTextMinWidth,e),t);this.width=Math.min(Math.max(o,this.textHelper.width+s),t),this.height=Math.min(Math.max(r,this.textHelper.height+s),n)}handlePostLayoutUpdate(){this.cursorOffsetDirty&&(this.cursorOffset=this.textHelper.findOffsetFromIndex(this.cursorPos),this.selectPos===this.cursorPos?(this.selectOffset[0]=this.cursorOffset[0],this.selectOffset[1]=this.cursorOffset[1]):this.selectOffset=this.textHelper.findOffsetFromIndex(this.selectPos),this.cursorOffsetDirty=!1);let e=this.inputTextInnerPadding,t=this.textHelper.width,r=this.textHelper.height,n=this.width-e*2,s=this.height-e*2,o=this.offset,[a,d]=this.cursorOffset;if(t>n){let u=Math.min(20,n/2),c=o[0]+u,f=o[0]+n-u;a>f&&(o[0]+=a-f),a<c&&(o[0]-=c-a),o[0]+n>t&&(o[0]=t-n),o[0]<0&&(o[0]=0)}else o[0]=0;if(r>s){let u=this.textHelper.fullLineHeight,c=s<2*u?0:u/2,f=o[1]+c,m=o[1]+s-c-u;d>m&&(o[1]+=d-m),d<f&&(o[1]-=f-d),o[1]+s>r&&(o[1]=r-s),o[1]<0&&(o[1]=0)}else o[1]=0;this.offset=o}handlePainting(e,t){e.fillStyle=this.inputBackgroundFill,e.fillRect(this.x,this.y,this.width,this.height),e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip();let r=this.inputTextInnerPadding;if(this.cursorPos!==this.selectPos)if(e.fillStyle=this.inputSelectBackgroundFill,this.cursorOffset[1]===this.selectOffset[1]){let o=Math.min(this.cursorOffset[0],this.selectOffset[0]),a=Math.max(this.cursorOffset[0],this.selectOffset[0]);e.fillRect(this.x+r+o-this.offset[0],this.y+r+this.cursorOffset[1]-this.offset[1],a-o,this.textHelper.fullLineHeight)}else{let o,a;this.cursorOffset[1]<this.selectOffset[1]?(o=this.cursorOffset,a=this.selectOffset):(a=this.cursorOffset,o=this.selectOffset);let d=this.textHelper.fullLineHeight,u=this.width+this.offset[0]-o[0]-r;u>0&&e.fillRect(this.x+r+o[0]-this.offset[0],this.y+r+o[1]-this.offset[1],u,d);let c=a[0]+r-this.offset[0];c>0&&e.fillRect(this.x,this.y+r+a[1]-this.offset[1],c,d);let f=o[1]+d,m=a[1]-f;m>0&&e.fillRect(this.x,this.y+r+f-this.offset[1],this.width,m)}let n;this._editingEnabled?this._valid?n=this.inputTextFill:n=this.inputTextFillInvalid:n=this.inputTextFillDisabled,this.textHelper.paint(e,n,this.x+r-this.offset[0],this.y+r-this.offset[1]);let s=this.blinkOn;this.blinkWasOn=s,s&&(e.fillStyle=n,e.fillRect(this.x+r+this.cursorOffset[0]-this.offset[0],this.y+r+this.cursorOffset[1]-this.offset[1],this.cursorThickness,this.textHelper.fullLineHeight)),e.restore()}};l(me,"TextInput"),y([O(["cursorOffsetDirty","_dirty"])],me.prototype,"hideText",2),y([et()],me.prototype,"offset",2),y([z],me.prototype,"wrapText",2);var bt=class extends me{constructor(i=null,e="",t){let r=Bt(i);super(r,null,e,t)}};l(bt,"BasicTextInput");var yt=class extends he{constructor(i,e){let t=Q({},e);t.containerAlignment={horizontal:.5,vertical:.5},t.containerPadding={left:0,right:0,top:0,bottom:0},super(i,t)}};l(yt,"Center");var ze=class extends p{constructor(e=null,t=!1,r){super(!0,!1,r);this.offsetX=0;this.offsetY=0;this.actualLength=0;this.tabFocusable=!0,this.variable=new de(t),e&&this.variable.watch(e),this.clickHelper=new le(this)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="checkboxLength"?(this._layoutDirty=!0,this._dirty=!0):(e==="backgroundGlowFill"||e==="backgroundFill"||e==="accentFill"||e==="primaryFill"||e==="checkboxInnerPadding")&&(this._dirty=!0)}set checked(e){this.variable.value=e}get checked(){return this.variable.value}onFocusGrabbed(e){this.clickHelper.onFocusGrabbed(e)&&(this._dirty=!0)}onFocusDropped(e){this.clickHelper.onFocusDropped(e)&&(this._dirty=!0)}handleEvent(e){let t=this.x+this.offsetX,r=this.y+this.offsetY,[n,s]=this.clickHelper.handleEvent(e,this.root,!0,[t,t+this.actualLength,r,r+this.actualLength]);return n&&(this.checked=!this.checked),this.clickHelper.clickStateChanged&&(this._dirty=!0),s?this:null}handlePostLayoutUpdate(){this.variable.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=this.checkboxLength;this.actualLength=Math.min(s,t,n),this.width=this.actualLength,this.height=this.actualLength,this.width<e&&(this.width=e),this.height<r&&(this.height=r),this.offsetX=(this.width-this.actualLength)/2,this.offsetY=(this.height-this.actualLength)/2}handlePainting(e,t){let r=this.clickHelper.clickState===1||this.clickHelper.clickState===2;r?e.fillStyle=this.backgroundGlowFill:e.fillStyle=this.backgroundFill;let n=this.offsetX+this.x,s=this.offsetY+this.y;if(e.fillRect(n,s,this.actualLength,this.actualLength),this.checked){r?e.fillStyle=this.accentFill:e.fillStyle=this.primaryFill;let o=this.checkboxInnerPadding,a=this.actualLength-o*2;a<=0?e.fillRect(n,s,this.actualLength,this.actualLength):e.fillRect(n+o,s+o,a,a)}}};l(ze,"Checkbox");var hi=/^.*\.(webm|og[gv]|m(p4|4v|ov)|avi|qt)$/i,ue=class extends p{constructor(e,t=null,r=null,n=null,s){super(!0,!1,s);this.lastSrc=null;this.rotation=0;this.imageWidth=null;this.imageHeight=null;this.offsetX=0;this.offsetY=0;this.actualWidth=0;this.actualHeight=0;this.loadedmetadataListener=null;this.canplayListener=null;this.frameCallback=null;if(typeof e=="string")if(hi.test(e)){let o=document.createElement("video");o.src=e,o.preload="auto",e=o}else{let o=document.createElement("img");o.src=e,e=o}this._image=e,this.imageWidth=t,this.imageHeight=r,this.viewBox=n,this.setupVideoEvents()}setupVideoEvents(){if(this.image instanceof HTMLVideoElement)if(this.loadedmetadataListener=e=>this._layoutDirty=!0,this.image.addEventListener("loadedmetadata",this.loadedmetadataListener),this.canplayListener=e=>this._dirty=!0,this.image.addEventListener("canplay",this.canplayListener),"requestVideoFrameCallback"in this.image){console.warn("requestVideoFrameCallback available; if video playback is choppy or broken, please report it on Github");let e=this.image;this.frameCallback=(t,r)=>{this._dirty=!0,console.log("set dirty"),this.image===e&&this.frameCallback!==null&&this.image.requestVideoFrameCallback(this.frameCallback)},this.image.requestVideoFrameCallback(this.frameCallback)}else console.warn("requestVideoFrameCallback not available; video will be played back on every frame when not paused")}set image(e){e!==this._image&&(this._image instanceof HTMLVideoElement&&(this.loadedmetadataListener!==null&&this._image.removeEventListener("loadedmetadata",this.loadedmetadataListener),this.canplayListener!==null&&this._image.removeEventListener("canplay",this.canplayListener)),this._image=e,this.lastSrc=null,this.loadedmetadataListener=null,this.canplayListener=null,this.frameCallback=null,this.setupVideoEvents())}get image(){return this._image}handlePreLayoutUpdate(){var e,t;this._image instanceof HTMLVideoElement?!this._image.paused&&this.frameCallback===null&&(this._dirty=!0):((e=this._image)==null?void 0:e.src)!==this.lastSrc&&((t=this._image)==null?void 0:t.complete)&&(this._layoutDirty=!0,this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=this.imageWidth;s===null&&(this.viewBox===null?this._image instanceof HTMLVideoElement?s=this._image.videoWidth:s=this._image.naturalWidth:s=this.viewBox[2]),this.width=Math.max(Math.min(s,t),e);let o=this.imageHeight;o===null&&(this.viewBox===null?this._image instanceof HTMLVideoElement?o=this._image.videoHeight:o=this._image.naturalHeight:o=this.viewBox[3]),this.height=Math.max(Math.min(o,n),r);let a=this.width/s,d=this.height/o,u=Math.min(a,d);this.actualWidth=s*u,this.actualHeight=o*u,this.offsetX=(this.width-this.actualWidth)/2,this.offsetY=(this.height-this.actualHeight)/2}handlePainting(e,t){var o;if(this._image instanceof HTMLImageElement&&!((o=this._image)!=null&&o.complete)){this.lastSrc=null;return}this.lastSrc=this._image.src;let r=this.x+this.offsetX,n=this.y+this.offsetY,s=this.rotation!==0;s&&(e.save(),e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.clip(),e.translate(this.x+this.offsetX+this.actualWidth/2,this.y+this.offsetY+this.actualHeight/2),r=-this.actualWidth/2,n=-this.actualHeight/2,e.rotate(this.rotation)),this.viewBox===null?e.drawImage(this._image,r,n,this.actualWidth,this.actualHeight):e.drawImage(this._image,...this.viewBox,r,n,this.actualWidth,this.actualHeight),s&&e.restore()}dryPaint(){var e;this._image instanceof HTMLImageElement&&((e=this._image)==null?void 0:e.complete)?this.lastSrc=this._image.src:this.lastSrc=null,super.dryPaint()}};l(ue,"Icon"),y([ge],ue.prototype,"rotation",2),y([Et(!0)],ue.prototype,"viewBox",2),y([z],ue.prototype,"imageWidth",2),y([z],ue.prototype,"imageHeight",2);var vt=class extends ke{constructor(i,e=null,t=null,r=null,n=null,s){super(new ue(i,e,t,r,s),n,s)}};l(vt,"IconButton");var Se=class extends p{constructor(e=1,t=0,r=0,n){super(!0,!1,n);this.flex=e,this.minWidth=t,this.minHeight=r}handleResolveDimensions(e,t,r,n){t!==1/0?this.width=t:this.width=Math.max(e,this.minWidth),n!==1/0?this.height=n:this.height=Math.max(r,this.minHeight)}};l(Se,"Spacing");var xt=class extends ae{constructor(i,e=null,t=!1,r){super(r),this.add([new Z(i,r),new Se(1,0,0,r),new ze(e,t,r)])}};l(xt,"LabelledCheckbox");var je=class extends p{constructor(e,t,r){super(!0,!1,r);this.offsetX=0;this.offsetY=0;this.actualLength=0;this._wasSelected=!1;this.tabFocusable=!0,this.variable=e,this.value=t,this.clickHelper=new le(this),this.callback=this.handleChange.bind(this),this._wasSelected=this.selected}handleChange(e){this.selected!==this._wasSelected&&(this._dirty=!0)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="radioButtonLength"?(this._layoutDirty=!0,this._dirty=!0):(e==="backgroundGlowFill"||e==="backgroundFill"||e==="accentFill"||e==="primaryFill"||e==="radioButtonInnerPadding")&&(this._dirty=!0)}select(){this.variable.value=this.value}get selected(){return this.variable.value===this.value}onFocusGrabbed(e){this.clickHelper.onFocusGrabbed(e)&&(this._dirty=!0)}onFocusDropped(e){this.clickHelper.onFocusDropped(e)&&(this._dirty=!0)}handleEvent(e){let t=this.x+this.offsetX,r=this.y+this.offsetY,[n,s]=this.clickHelper.handleEvent(e,this.root,!0,[t,t+this.actualLength,r,r+this.actualLength]);return n&&this.select(),this.clickHelper.clickStateChanged&&(this._dirty=!0),s?this:null}handleResolveDimensions(e,t,r,n){let s=this.radioButtonLength;this.actualLength=Math.min(s,t,n),this.width=this.actualLength,this.height=this.actualLength,this.width<e&&(this.width=e),this.height<r&&(this.height=r),this.offsetX=(this.width-this.actualLength)/2,this.offsetY=(this.height-this.actualLength)/2}handlePainting(e,t){this._wasSelected=this.selected;let r=this.clickHelper.clickState===1||this.clickHelper.clickState===2;r?e.fillStyle=this.backgroundGlowFill:e.fillStyle=this.backgroundFill;let n=this.actualLength/2,s=this.offsetX+this.x+n,o=this.offsetY+this.y+n;if(this.paintCircle(e,s,o,n),this.selected){r?e.fillStyle=this.accentFill:e.fillStyle=this.primaryFill;let a=this.actualLength-this.radioButtonInnerPadding*2;if(a<=0)this.paintCircle(e,s,o,n);else{let d=a/2;this.paintCircle(e,s,o,d)}}}activate(e,t){super.activate(e,t),this.variable.watch(this.callback)}deactivate(){super.deactivate(),this.variable.unwatch(this.callback)}};l(je,"RadioButton");var Tt=class extends ae{constructor(i,e,t,r){super(r),this.add([new Z(i,r),new Se(1,0,0,r),new je(e,t,r)])}};l(Tt,"LabelledRadioButton");var De=class extends re{constructor(e,t=0,r=0,n=!1,s=!1,o=!1,a){super(e,!1,!0,a);this._offset=[0,0];this._constraints=[0,1/0,0,1/0];this.forceReLayout=!0;this.forceRePaint=!0;this.autoScrollSelections=!0;this.viewport=o?new K:null,this.minWidth=t,this.minHeight=r,this._widthTied=n,this._heightTied=s,this._constraints=[0,1/0,0,1/0]}get offset(){return[...this._offset]}set offset(e){(this._offset[0]!==e[0]||this._offset[1]!==e[1])&&(this._offset[0]=e[0],this._offset[1]=e[1],this._dirty=!0,this.correctChildPosition())}set constraints(e){(e[0]!==this._constraints[0]||e[1]!==this._constraints[1]||e[2]!==this._constraints[2]||e[3]!==this._constraints[3])&&(this._constraints[0]=e[0],this._constraints[1]=e[1],this._constraints[2]=e[2],this._constraints[3]=e[3],this.viewport!==null?this.viewport.constraints=e:this.forceReLayout=!0)}get constraints(){return[...this._constraints]}get widthTied(){return this._widthTied}set widthTied(e){this._widthTied!==e&&(this._widthTied=e,this._layoutDirty=!0,this.forceReLayout=!0)}get heightTied(){return this._heightTied}set heightTied(e){this._heightTied!==e&&(this._heightTied=e,this._layoutDirty=!0,this.forceReLayout=!0)}get scaledMinWidth(){var e,t;return this.minWidth*((t=(e=this.root)==null?void 0:e.resolution)!=null?t:1)}get scaledMinHeight(){var e,t;return this.minHeight*((t=(e=this.root)==null?void 0:e.resolution)!=null?t:1)}get scaledConstraints(){var t,r;let e=(r=(t=this.root)==null?void 0:t.resolution)!=null?r:1;return[this._constraints[0]*e,this._constraints[1]*e,this._constraints[2]*e,this._constraints[3]*e]}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="canvasFill"&&(this._dirty=!0)}getClickAreaOf(e){let[t,r]=e.dimensions,[n,s]=e.position,o=this.x+this.offset[0]+n,a=this.y+this.offset[1]+s;return[o,o+t,a,a+r]}handleEvent(e){if(e instanceof T){let[r,n,s,o]=this.getClickAreaOf(this.child);if(e.target===null&&(e.x<r||e.x>=n||e.y<s||e.y>=o))return null;this.viewport!==null&&(e=e.correctOffset(r,s))}let t=this.child.dispatchEvent(e);if(this.autoScrollSelections&&t!==null&&!(this.widthTied&&this.heightTied)&&(e instanceof E||e instanceof A)){let[r,n,s,o]=this.getClickAreaOf(t),a=this.x+this.width,d=this.y+this.height,[u,c]=this.offset;!this.widthTied&&!(r>=this.x&&n<a)&&!(this.x>=r&&a<n)&&(r>this.x?u-=r-this.x:u+=a-n),!this.heightTied&&!(s>=this.y&&o<d)&&!(this.y>=s&&d<o)&&(s>this.y?c-=s-this.y:c+=d-o),this.offset=[u,c]}return t}handlePreLayoutUpdate(){let e=this.child;e.preLayoutUpdate(),this._widthTied||this._heightTied?e.layoutDirty&&(this._layoutDirty=!0):this.viewport!==null?(this.viewport.constraints=this.scaledConstraints,this.viewport.resolveChildsLayout(e)):(e.layoutDirty||this.forceReLayout)&&(e.resolveDimensionsAsTop(...this.scaledConstraints),this.correctChildPosition())}handlePostLayoutUpdate(){let e=this.child;this.forceReLayout=!1,e.postLayoutUpdate(),e.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=!0,o=!0,a=Math.min(Math.max(e,this.scaledMinWidth),t),d=Math.min(Math.max(r,this.scaledMinHeight),n);if(this._widthTied||this._heightTied){let u=this.scaledConstraints;this._widthTied&&(u[0]=a,u[1]=t),this._heightTied&&(u[2]=d,u[3]=n);let c=this.child;this.viewport===null?(c.resolveDimensionsAsTop(...u),this.correctChildPosition()):(this.viewport.constraints=u,this.viewport.resolveChildsLayout(c)),this._widthTied&&(this.width=c.dimensions[0],s=!1),this._heightTied&&(this.height=c.dimensions[1],o=!1)}s&&(this.width=Math.min(a,t)),o&&(this.height=Math.min(d,n)),this.width===0&&this.minWidth===0&&!this._widthTied&&console.warn("ViewportWidget has no minimum width and width isn't tied, therefore, it may be dimensionless. Set a minimum width and/or tie the width"),this.height===0&&this.minHeight===0&&!this._heightTied&&console.warn("ViewportWidget has no minimum height and height isn't tied, therefore, it may be dimensionless. Set a minimum height and/or tie the height")}afterPositionResolved(){this.correctChildPosition(),this.viewport===null&&(this.forceRePaint=!0)}correctChildPosition(){if(this.viewport!==null)return;let[e,t]=this.offset;this.child.resolvePosition(this.x+e,this.y+t)}handlePainting(e,t){this.viewport!==null&&this.viewport.paintToCanvas(this.child,t);let[r,n,s,o]=this.roundRect(this.x,this.y,this.width,this.height,!0),[a,d]=this.child.dimensions,[u,c]=this.offset,f=r+s,m=n+o,b=this.x+u,v=this.y+c,k=Math.min(Math.max(b,r),f),_=Math.min(Math.max(v,n),m),S=Math.min(Math.max(b+a,r),f)-k,P=Math.min(Math.max(v+d,n),m)-_;if([k,_,S,P]=this.roundRect(k,_,S,P,!0),S===0||P===0){this.viewport===null&&this.child.dryPaint(),this.forceRePaint=!1;return}let x=k-b,R=_-v;this.clearStart(e),e.rect(r,n,s,o),e.clip(),this.viewport!==null&&e.drawImage(this.viewport.canvas,x,R,S,P,k,_,S,P),e.rect(k,_,S,P),this.clearEnd(e,"evenodd"),this.viewport===null&&(e.save(),e.beginPath(),e.rect(k,_,S,P),e.clip(),this.child.paint(e,t||this.forceRePaint),e.restore()),this.forceRePaint=!1}};l(De,"ViewportWidget"),y([z],De.prototype,"minWidth",2),y([z],De.prototype,"minHeight",2);var di=(e=>(e[e.Overlay=0]="Overlay",e[e.Layout=1]="Layout",e))(di||{}),kt=class extends De{constructor(e,t=0,r=0,n=!1,s=!1,o=0,a=!1,d){super(e,t,r,n,s,a,d);this.effectiveWidth=0;this.effectiveHeight=0;this.verticalDragged=null;this.startingScroll=0;this.startingOffset=0;this.lastScroll=0;this.horizWasPainted=!1;this.vertWasPainted=!1;this._scrollbarMode=o,this.horizontalClickHelper=new q(this),this.verticalClickHelper=new q(this)}get scrollbarMode(){return this._scrollbarMode}set scrollbarMode(e){if(this._scrollbarMode!==e){let t=this.scroll;this._scrollbarMode=e,this.scroll=t,this._layoutDirty=!0,this._dirty=!0}}get offset(){return super.offset}set offset(e){let[t,r]=this.child.dimensions;super.offset=[-Math.max(Math.min(-e[0],t-this.effectiveWidth),0),-Math.max(Math.min(-e[1],r-this.effectiveHeight),0)]}get widthTied(){return super.widthTied}set widthTied(e){let t=this.scroll;super.widthTied=e,this.scroll=t}get heightTied(){return super.heightTied}set heightTied(e){let t=this.scroll;super.heightTied=e,this.scroll=t}get scroll(){let[e,t]=this.offset,[r,n]=this.child.dimensions,s=r-this.effectiveWidth,o=n-this.effectiveHeight;return[s===0?0:Math.min(Math.max(-e/s,0),1),o===0?0:Math.min(Math.max(-t/o,0),1)]}set scroll(e){let[t,r]=this.child.dimensions;this.offset=[-e[0]*(t-this.effectiveWidth),-e[1]*(r-this.effectiveHeight)]}getClickHelper(e){return e?this.verticalClickHelper:this.horizontalClickHelper}handleEventScrollbar(e,t,r,n){if(this.verticalDragged!==null&&this.verticalDragged!==e)return!1;let[s,o]=this.getScrollbarRects(e,t),a=this._scrollbarMode===0,d=a?s:o,u=[d[0],d[0]+d[2],d[1],d[1]+d[3]],c=this.getClickHelper(e);c.handleClickEvent(r,n,u);let f=c.clickState,m=c.clickStateChanged;if(m&&(this._dirty=!0),f===2){if(c.pointerPos===null||!(r instanceof T))return!0;let b=e?1:0,v=this.scroll,k=a;k||(k=c.isPointInRect(r.x,r.y,s[0],s[0]+s[2],s[1],s[1]+s[3]));let _;if(a?_=c.getNormalInRect(r.x,r.y,o[0],o[0]+o[2],o[1],o[1]+o[3])[b]:_=c.pointerPos[b],m){if(!k){let S=e?this.effectiveHeight:this.effectiveWidth,P=this.child.dimensions[b],x=S/P;v[b]=(_-x/2)/(1-x),this.scroll=v}this.startingOffset=_,this.startingScroll=v[b],this.verticalDragged=e}else{let S=e?this.effectiveHeight:this.effectiveWidth,P=this.child.dimensions[b],x=S/P,R=_-this.startingOffset;v[b]=this.startingScroll+R/(1-x),this.scroll=v}return!0}else{if(f===1)return!0;if(m)return this.verticalDragged=null,!0}return!1}clampOffset(e){let[t,r]=this.child.dimensions,n=-(t-this.effectiveWidth);n>=0?e[0]=0:e[0]<n&&(e[0]=n);let s=-(r-this.effectiveHeight);s>=0?e[1]=0:e[1]<s&&(e[1]=s)}handleWheelEvent(e){let t=this.offset,[r,n]=t;t[0]-=e.shift?e.deltaY:e.deltaX,t[1]-=e.shift?e.deltaX:e.deltaY,this.clampOffset(t),this.offset=t;let[s,o]=this.offset,a=s!==r||o!==n,d=this.lastScroll,u=new Date().getTime();return this.lastScroll=u,a?!0:e.fromDrag?!1:u-d<200}onThemeUpdated(e=null){super.onThemeUpdated(e),e==="scrollBarThickness"?(this._layoutDirty=!0,this._dirty=!0):(e==="backgroundFill"||e==="scrollBarMinPercent"||e==="scrollBarMinPixels"||e==="primaryFill"||e==="accentFill"||e==="backgroundGlowFill")&&(this._dirty=!0)}handleEvent(e){if((e instanceof F||e instanceof T)&&(e.target===null||e.target===this)){let[r,n]=this.child.dimensions,s=this._scrollbarMode===0,o=!s&&!this.widthTied&&!this.heightTied,a=r>this.width,d=n>this.height,u=!1;if(!this.widthTied&&(a||!s)&&this.handleEventScrollbar(!1,d||o,e,this.root)&&(u=!0),!this.heightTied&&(d||!s)&&this.handleEventScrollbar(!0,a||o,e,this.root)&&(u=!0),u)return e instanceof L&&this.handleWheelEvent(e),this}let t=super.handleEvent(e);return t===null&&e instanceof L&&this.handleWheelEvent(e)?this:t}handleResolveDimensions(e,t,r,n){let s=this.scrollBarThickness,o=this._scrollbarMode===1,a=o&&!this.heightTied,d=o&&!this.widthTied,u,c,f,m;a?(c=Math.max(t-s,0),u=Math.min(e,c)):(c=t,u=e),d?(m=Math.max(n-s,0),f=Math.min(r,m)):(m=n,f=r),super.handleResolveDimensions(u,c,f,m),this.effectiveWidth=this.width,this.effectiveHeight=this.height,a&&(this.width=Math.min(Math.max(this.width+s,e),t)),d&&(this.height=Math.min(Math.max(this.height+s,r),n))}handlePostLayoutUpdate(){super.handlePostLayoutUpdate();let e=this.offset;this.clampOffset(e),this.offset=e}handlePainting(e,t){let[r,n]=this.child.dimensions,s=r>this.width,o=n>this.height,a=this.scrollbarNeedsPaint(!1,s),d=this.scrollbarNeedsPaint(!0,o);(this.horizWasPainted!==a||this.vertWasPainted!==d)&&(this.horizWasPainted=a,this.vertWasPainted=d,this.forceRePaint=!0),super.handlePainting(e,t);let u=this._scrollbarMode===1&&!this.widthTied&&!this.heightTied;if(a&&this.paintScrollbar(!1,s,o||u,e),d&&this.paintScrollbar(!0,o,s||u,e),u){let c=this.scrollBarThickness;e.fillStyle=this.backgroundFill,e.fillRect(this.x+this.width-c,this.y+this.height-c,c,c)}}getScrollbarRects(e,t){let r=this._scrollbarMode===0,n=e?1:0,s=this.scroll[n],o=this.child.dimensions[n],a=e?this.effectiveHeight:this.effectiveWidth,d=this.scrollBarThickness,u=this.scrollBarMinPercent,c=this.scrollBarMinPixels,f=a;r&&(f-=t?d:0);let m=Math.min(Math.max(c,Math.max(a/o,u)*f),f),b=(f-m)*s,v,k,_,S;e?(v=this.x+this.width-d,k=this.y+b,_=d,S=m):(v=this.x+b,k=this.y+this.height-d,_=m,S=d);let P,x,R,U;return e?(P=v,x=this.y,R=d,U=f):(P=this.x,x=k,R=f,U=d),[[v,k,_,S],[P,x,R,U]]}scrollbarNeedsPaint(e,t){return!t&&this._scrollbarMode===0?!1:!(e?this.heightTied:this.widthTied)}paintScrollbar(e,t,r,n){let[s,o]=this.getScrollbarRects(e,r);if(this._scrollbarMode!==0&&(n.fillStyle=this.backgroundFill,n.fillRect(...o)),t)switch(this.getClickHelper(e).clickState){case 0:n.fillStyle=this.primaryFill;break;case 1:case 2:n.fillStyle=this.accentFill;break}else n.fillStyle=this.backgroundGlowFill;n.fillRect(...s)}};l(kt,"ScrollableViewportWidget");var nt=class extends p{constructor(e=null,t=0,r=1,n=0,s=0,o=!1,a){super(!0,!1,a);this.offsetX=0;this.offsetY=0;this.actualWidth=0;this.actualHeight=0;this.keyboardFocused=!1;if(r<t)throw new Error("Slider max value can't be smaller than minimum value");if(!isFinite(t)||isNaN(t))throw new Error("Slider min value must be a valid finite number");if(!isFinite(r)||isNaN(r))throw new Error("Slider max value must be a valid finite number");if(!isFinite(n)||isNaN(n))throw new Error("Slider increment value must be a valid finite number");if(n<0)throw new Error("Slider increment value must be greater or equal to zero");this.clickHelper=new q(this),this.variable=new de(this.clamp(s)),e&&this.variable.watch(e),this.minValue=t,this.maxValue=r,this.snapIncrement=n,this.vertical=o,this.tabFocusable=!0}set value(e){this.setValue(e)}get value(){return this.variable.value}clamp(e){return e<this.minValue?e=this.minValue:e>this.maxValue&&(e=this.maxValue),e}setValue(e,t=!0){this.snapIncrement>0&&(e=Math.round(e/this.snapIncrement)*this.snapIncrement),this.variable.setValue(this.clamp(e),t)}stepValue(e,t){let r=this.snapIncrement;r===0&&(r=.01*(this.maxValue-this.minValue)),r*=t;let n=e?1:-1;this.value=this.clamp((Math.round(this.value/r)+n)*r)}onThemeUpdated(e=null){super.onThemeUpdated(e),e===null?(this._layoutDirty=!0,this._dirty=!0):e==="sliderThickness"||e==="sliderMinLength"?(this._layoutDirty=!0,this._dirty=!0):(e==="accentFill"||e==="primaryFill"||e==="backgroundFill")&&(this._dirty=!0)}onFocusGrabbed(e){e===1&&(this.keyboardFocused=!0)}onFocusDropped(e){e===1&&(this.keyboardFocused=!1)}handleEvent(e){if(e instanceof L||!(e instanceof T||e instanceof A||e instanceof F)||e instanceof W&&e.key==="Tab")return null;if(e instanceof A){if(e instanceof W){let n=e.shift?10:1;e.key==="ArrowLeft"||e.key==="ArrowDown"?this.stepValue(!1,n):(e.key==="ArrowRight"||e.key==="ArrowUp")&&this.stepValue(!0,n)}return this}let t=this.x+this.offsetX,r=this.y+this.offsetY;if(this.clickHelper.handleClickEvent(e,this.root,[t,t+this.actualWidth,r,r+this.actualHeight]),(this.clickHelper.clickStateChanged&&this.clickHelper.wasClick||this.clickHelper.clickState==2)&&this.clickHelper.pointerPos!==null){let n=this.clickHelper.pointerPos[0];this.value=this.minValue+n*(this.maxValue-this.minValue)}return this.clickHelper.clickStateChanged&&(this._dirty=!0),this}handlePostLayoutUpdate(){this.variable.dirty&&(this._dirty=!0)}handleResolveDimensions(e,t,r,n){let s=this.sliderThickness,o=this.sliderMinLength;this.vertical?(n!=1/0?this.height=n:this.height=Math.max(o,r),this.actualHeight=this.height,this.offsetY=0,this.width=Math.min(Math.max(s,e),t),this.actualWidth=Math.min(this.width,s),this.offsetX=(this.width-this.actualWidth)/2):(t!=1/0?this.width=t:this.width=Math.max(o,e),this.actualWidth=this.width,this.offsetX=0,this.height=Math.min(Math.max(s,r),n),this.actualHeight=Math.min(this.height,s),this.offsetY=(this.height-this.actualHeight)/2)}handlePainting(e,t){let r=this.x+this.offsetX,n=this.y+this.offsetY,s=this.keyboardFocused||this.clickHelper.clickState===1||this.clickHelper.clickState===2;s?e.fillStyle=this.accentFill:e.fillStyle=this.primaryFill;let o=this.actualWidth*(this.value-this.minValue)/(this.maxValue-this.minValue);e.fillRect(r,n,o,this.actualHeight),s?e.fillStyle=this.backgroundGlowFill:e.fillStyle=this.backgroundFill;let a=this.actualWidth-o;e.fillRect(r+o,n,a,this.actualHeight)}};l(nt,"Slider"),y([ge],nt.prototype,"keyboardFocused",2);var _t=class extends he{constructor(i,e){let t=Q({},e);t.containerAlignment={horizontal:.5,vertical:"stretch"},super(i,t)}};l(_t,"TextMargin");var wt=class extends ve{constructor(e,t){super(e);this.scopeTheme=t}set inheritedTheme(e){super.inheritedTheme=this.scopeTheme}get inheritedTheme(){return this.scopeTheme}};l(wt,"ThemeScope");export{te as Alignment,pt as AltKey,ce as ArtificialConstraint,Be as BackspaceKey,ne as BaseContainer,D as BaseTheme,bt as BasicTextInput,X as BasicVirtualKey,ke as Button,le as ButtonClickHelper,yt as Center,ze as Checkbox,q as ClickHelper,j as ClickState,Ye as Column,Ve as CompoundClickHelper,he as Container,gt as ControlKey,dt as DOMKeyboardDriver,ct as DOMPointerDriver,Ae as DOMRoot,at as DOMVirtualKeyboardRoot,ft as DebugTheme,Fr as DefaultTextInputHandler,oi as DefaultTextValidator,Ke as EnterKey,Oe as EscapeKey,$ as Event,_e as FilledButton,qe as FlexAlignment,yo as FloatValidator,H as FocusType,xe as GenericClickHelper,Ie as GlyphVirtualKey,ue as Icon,vt as IconButton,xo as IntValidator,A as KeyEvent,W as KeyPress,oe as KeyRelease,Xe as KeyboardDriver,Z as Label,xt as LabelledCheckbox,Tt as LabelledRadioButton,F as Leave,po as MakeCompositeValidator,Bt as MakeDefaultTextValidatorWithCallback,ko as MakeRangeValidator,Fe as Margin,pe as ModifierEvent,ie as MultiContainer,Re as MultiParent,be as Parent,ve as PassthroughWidget,Te as PointerButtonEvent,Ce as PointerDriver,T as PointerEvent,It as PointerHint,J as PointerMove,I as PointerPress,B as PointerRelease,L as PointerWheel,je as RadioButton,mt as RayPointerDriver,w as Root,ae as Row,kt as ScrollableViewportWidget,di as ScrollbarMode,Ge as ShiftKey,re as SingleParent,nt as Slider,$e as SpaceKey,Se as Spacing,E as TabSelect,Mt as TextAlignMode,we as TextButton,C as TextHelper,me as TextInput,_t as TextMargin,se as TextPasteEvent,M as Theme,wt as ThemeScope,Qe as Variable,K as Viewport,De as ViewportWidget,N as VirtualKey,Ue as VirtualKeyRow,Pe as VirtualKeyboard,ht as VirtualKeyboardRoot,de as WatchableVariable,p as Widget,Ht as WrapMode,Ne as defaultVirtualKeyboardTemplate,Wt as flagArrayField,St as flagField,ut as getPointerEventNormPos,wr as injectDebugCode,Y as injectRandomFillFeature,g as injectStackTraceFeature,rt as injectTraceFeature,it as injectWatchflagFeature,ye as isDebugFeatureEnabled,lt as isPower2,Lt as layoutArrayField,z as layoutField,qt as listDebugFeatures,Ze as measureTextDims,Nt as multiFlagArrayField,O as multiFlagField,et as paintArrayField,ge as paintField,Et as paintLayoutArrayField,ki as paintLayoutField,ot as roundToPower2,jt as toggleDebugFeature,Dt as watchArrayField,Je as watchField};
//# sourceMappingURL=index.esm.js.map
