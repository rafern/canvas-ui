function t(t){return new Promise(((e,i)=>{function s(){document.body.removeChild(l),document.body.removeChild(h)}function n(){s(),e(a.value)}const h=document.createElement("div");h.id="textInputHandlerOverlay";const l=document.createElement("div");l.id="textInputHandler";const r=document.createElement("p");r.textContent="Change text:";const a=document.createElement("input");a.addEventListener("keyup",(function(t){13==t.keyCode&&(t.preventDefault(),n())})),a.value=t;const o=document.createElement("div"),u=document.createElement("button");u.addEventListener("click",(function(){s(),e(t)})),u.textContent="Cancel";const c=document.createElement("button");c.addEventListener("click",n),c.textContent="OK",o.appendChild(u),o.appendChild(c),l.appendChild(r),l.appendChild(a),l.appendChild(o),document.body.appendChild(h),document.body.appendChild(l),a.focus({preventScroll:!1})}))}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function e(t,e,i,s){return new(i||(i=Promise))((function(n,h){function l(t){try{a(s.next(t))}catch(t){h(t)}}function r(t){try{a(s.throw(t))}catch(t){h(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(l,r)}a((s=s.apply(t,e||[])).next())}))}function i(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function s(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i}class n{constructor(t,e=null){this.properties=t,this.fallback=e}getProperty(t){let e=this.properties.get(t);if(void 0===e){if(null===this.fallback)throw new Error(`Theme property ${t} is not available`);e=this.fallback.getProperty(t)}return e}getString(t){const e=this.getProperty(t);if("string"!=typeof e)throw new Error(`Theme property ${t} is not a string`);return e}getNumber(t){const e=this.getProperty(t);if("number"!=typeof e)throw new Error(`Theme property ${t} is not a number`);return e}getPadding(t){return this.getProperty(t)}getAlignment(t){return this.getProperty(t)}getAlignment2D(t){return this.getProperty(t)}getFill(t){return this.getString(t)}getFont(t){return this.getString(t)}getSize(t){return this.getNumber(t)}}var h,l;!function(t){t[t.CanvasFill=0]="CanvasFill",t[t.ContainerPadding=1]="ContainerPadding",t[t.ContainerSpacing=2]="ContainerSpacing",t[t.ContainerAlignment=3]="ContainerAlignment",t[t.PrimaryFill=4]="PrimaryFill",t[t.AccentFill=5]="AccentFill",t[t.BackgroundFill=6]="BackgroundFill",t[t.BackgroundGlowFill=7]="BackgroundGlowFill",t[t.SliderFlexRatio=8]="SliderFlexRatio",t[t.SliderMainBasis=9]="SliderMainBasis",t[t.SliderCrossBasis=10]="SliderCrossBasis",t[t.BodyTextFont=11]="BodyTextFont",t[t.BodyTextFill=12]="BodyTextFill",t[t.LabelMinWidth=13]="LabelMinWidth",t[t.LabelMinAscent=14]="LabelMinAscent",t[t.LabelMinDescent=15]="LabelMinDescent",t[t.CheckboxLength=16]="CheckboxLength",t[t.CheckboxInnerPadding=17]="CheckboxInnerPadding",t[t.InputBackgroundFill=18]="InputBackgroundFill",t[t.InputTextFont=19]="InputTextFont",t[t.InputTextFill=20]="InputTextFill",t[t.InputTextFillDisabled=21]="InputTextFillDisabled",t[t.InputTextFillInvalid=22]="InputTextFillInvalid",t[t.InputTextFlexRatio=23]="InputTextFlexRatio",t[t.InputTextMinWidth=24]="InputTextMinWidth",t[t.InputTextMinAscent=25]="InputTextMinAscent",t[t.InputTextMinDescent=26]="InputTextMinDescent",t[t.BlinkRate=27]="BlinkRate",t[t.CursorPadding=28]="CursorPadding",t[t.CursorThickness=29]="CursorThickness",t[t.ScrollBarThickness=30]="ScrollBarThickness"}(h||(h={})),function(t){t[t.Stretch=0]="Stretch",t[t.Start=1]="Start",t[t.Center=2]="Center",t[t.End=3]="End"}(l||(l={}));const r=new n(new Map([[h.CanvasFill,"rgba(0,0,0,0.5)"],[h.ContainerPadding,{left:4,right:4,top:4,bottom:4}],[h.ContainerAlignment,{horizontal:l.Start,vertical:l.Start}],[h.ContainerSpacing,4],[h.PrimaryFill,"rgb(0,127,255)"],[h.AccentFill,"rgb(0,195,255)"],[h.BackgroundFill,"rgb(32,32,32)"],[h.BackgroundGlowFill,"rgb(48,48,48)"],[h.SliderFlexRatio,1],[h.SliderMainBasis,100],[h.SliderCrossBasis,10],[h.BodyTextFont,"16px sans"],[h.BodyTextFill,"white"],[h.LabelMinWidth,0],[h.LabelMinAscent,0],[h.LabelMinDescent,3],[h.CheckboxLength,12],[h.CheckboxInnerPadding,2],[h.InputBackgroundFill,"white"],[h.InputTextFont,"16px mono"],[h.InputTextFill,"black"],[h.InputTextFillDisabled,"grey"],[h.InputTextFillInvalid,"red"],[h.InputTextFlexRatio,1],[h.InputTextMinWidth,100],[h.InputTextMinAscent,16],[h.InputTextMinDescent,3],[h.BlinkRate,.8],[h.CursorPadding,2],[h.CursorThickness,2],[h.ScrollBarThickness,10]]));var a,o,u,c,d,p,g,v,f,y,m;!function(t){t[t.Pointer=0]="Pointer",t[t.Keyboard=1]="Keyboard"}(a||(a={}));class x{constructor(t,e,i){this.target=t,this.focusType=e,this.needsFocus=i}}class b extends x{constructor(t=null){super(t,a.Pointer,!0)}cloneWithTarget(t){return new b(t)}}class w{constructor(t,e,i){this.hBasis=0,this.vBasis=0,this.hFlex=0,this.vFlex=0,this.sizeChanged=!1,this.maxWidth=t,this.maxHeight=e,this.vertical=i}clone(){const t=new w(this.maxWidth,this.maxHeight,this.vertical);return t.hBasis=this.hBasis,t.vBasis=this.vBasis,t.hFlex=this.hFlex,t.vFlex=this.vFlex,t}addBasis(t,e){this.vertical?(this.vBasis+=e,t>this.hBasis&&(this.hBasis=t)):(this.hBasis+=t,e>this.vBasis&&(this.vBasis=e))}}function k(t,e=!0){const i=e?Math.ceil:Math.floor;return Math.pow(2,i(Math.log2(t)))}class C{constructor(t=64,e=64){o.set(this,[0,0]),u.set(this,!1),this.vertical=!0,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e;const i=this.canvas.getContext("2d",{alpha:!0});if(null===i)throw"Failed to get canvas context";this.context=i}get canvasDimensions(){return[this.canvas.width,this.canvas.height]}set maxDimensions(t){i(this,o)[0]===t[0]&&i(this,o)[1]===t[1]||(i(this,o)[0]=t[0],i(this,o)[1]=t[1],s(this,u,!0))}get maxDimensions(){return[i(this,o)[0],i(this,o)[1]]}populateChildsLayout(t){if(i(this,u)&&(s(this,u,!1),t.forceLayoutDirty()),!t.layoutDirty)return null;const e=new w(i(this,o)[0],i(this,o)[1],this.vertical);return t.populateLayout(e),e}resolveChildsLayout(t,e){if(!t.layoutDirty||null===e)return!1;const i=t.resolvedWidth,s=t.resolvedHeight;t.resolveLayout(e);const n=t.resolvedWidth,h=t.resolvedHeight;let l=!1;if(n!==i||h!==s){const t=k(n);t>this.canvas.width&&(this.canvas.width=t);const e=k(h);e>this.canvas.height&&(this.canvas.height=e),l=!0}return(e.sizeChanged||l)&&t.forceLayoutDirty(),l}paintToCanvas(t){const e=t.dirty;return e&&t.paint(0,0,t.resolvedWidth,t.resolvedHeight,this.context),e}}o=new WeakMap,u=new WeakMap;class L{constructor(t,e=null,i=r){this.drivers=new Set,this._enabled=!0,this.pointerStyle="default",this._currentPointerStyle="default",this._foci=new Map([[a.Keyboard,null],[a.Pointer,null]]),this._fociCapturers=new Map([[a.Keyboard,null],[a.Pointer,null]]),this.textInputHandler=null,this._mobileTextInUse=!1,this.viewport=new C,this.child=t,this.pointerStyleHandler=e,this.child.inheritTheme(i)}get maxDimensions(){return this.viewport.maxDimensions}set maxDimensions(t){this.viewport.maxDimensions=t}get canvasDimensions(){return this.viewport.canvasDimensions}get dimensions(){return[this.child.resolvedWidth,this.child.resolvedHeight]}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t)if(this._enabled=t,t)for(const t of this.drivers)t.onEnable(this);else{for(const t of this.drivers)t.onDisable(this);this.updatePointerStyle("default");for(const t of this._foci.keys())this.clearFocus(t)}}get canvas(){return this.viewport.canvas}resolveLayout(){if(!this.enabled)return!1;const t=this.viewport.populateChildsLayout(this.child);return this.viewport.resolveChildsLayout(this.child,t)}paint(){return!!this.enabled&&this.viewport.paintToCanvas(this.child)}dispatchEvent(t){var e;if(!this.enabled)return;if(null!==t.focusType&&null===t.target){let e=this._foci.get(t.focusType);if(void 0===e&&(e=null),t.needsFocus&&null===e)return;t=t.cloneWithTarget(e)}this.pointerStyle="default";const[i,s]=this.dimensions,n=this.child.dispatchEvent(t,i,s,this);if(null===n&&null!==t.focusType&&this.clearFocus(t.focusType),null===t.focusType)return;const h=null!==(e=this._fociCapturers.get(t.focusType))&&void 0!==e?e:null;if(h!==n){t.focusType===a.Pointer&&null!==h&&this.child.dispatchEvent(new b(h),i,s,this),this._fociCapturers.set(t.focusType,n);for(const e of this.drivers)e.onFocusCapturerChanged(this,t.focusType,h,n)}}preLayoutUpdate(){if(this.enabled){for(const t of this.drivers)t.update(this);this.child.preLayoutUpdate(this)}}postLayoutUpdate(){this.enabled&&(this.child.postLayoutUpdate(this),this.updatePointerStyle())}updatePointerStyle(t=null){null!==t&&(this.pointerStyle=t),this.pointerStyle!==this._currentPointerStyle&&(this._currentPointerStyle=this.pointerStyle,null!==this.pointerStyleHandler&&this.pointerStyleHandler(this._currentPointerStyle))}requestFocus(t,e){if(null!==e){if(e!==this._foci.get(t)){this.clearFocus(t),this._foci.set(t,e);for(const i of this.drivers)i.onFocusChanged(this,t,e)}}}dropFocus(t,e){e===this._foci.get(t)&&this.clearFocus(t)}clearFocus(t){const e=this._foci.get(t);if(null!=e){e.onFocusDropped&&e.onFocusDropped(t,this),this._foci.set(t,null);for(const e of this.drivers)e.onFocusChanged(this,t,null)}}getFocus(t){var e;return null!==(e=this._foci.get(t))&&void 0!==e?e:null}getFocusCapturer(t){var e;return null!==(e=this._fociCapturers.get(t))&&void 0!==e?e:null}registerDriver(t){this.drivers.has(t)||(this.drivers.add(t),this._enabled&&t.onEnable&&t.onEnable(this))}unregisterDriver(t){this.drivers.delete(t)&&this._enabled&&t.onDisable&&t.onDisable(this)}clearDrivers(){if(this._enabled)for(const t of this.drivers)this.unregisterDriver(t)}get hasMobileTextInput(){return null!==this.textInputHandler&&!this._mobileTextInUse}get usingMobileTextInput(){return this._mobileTextInUse}getTextInput(t=""){return e(this,void 0,void 0,(function*(){if(null!==this.textInputHandler&&!this._mobileTextInUse){this._mobileTextInUse=!0;const e=yield this.textInputHandler(t);return this._mobileTextInUse=!1,e}return null}))}}class M extends L{constructor(t,e=r){super(t,null,e),c.set(this,void 0),this.domElem=document.createElement("canvas"),this.domElem.tabIndex=1,[this.domElem.width,this.domElem.height]=this.dimensions;const i=this.domElem.getContext("2d",{alpha:!0});if(null===i)throw"Failed to get DOM canvas context";s(this,c,i),this.pointerStyleHandler=t=>{this.domElem.style.cursor=t}}update(){this.enabled?(this.domElem.style.removeProperty("display"),this.preLayoutUpdate(),this.resolveLayout()&&([this.domElem.width,this.domElem.height]=this.dimensions),this.postLayoutUpdate(),this.paint()&&(i(this,c).globalCompositeOperation="copy",i(this,c).drawImage(this.canvas,0,0))):this.domElem.style.display="none"}}c=new WeakMap;class B extends x{constructor(t,e,i=null,s=null){super(i,s,!1),this.x=t,this.y=e}}class F extends B{constructor(t,e,i=null){super(t,e,i,a.Pointer)}correctOffset(t,e){return new F(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new F(this.x,this.y,t)}}class D extends B{constructor(t,e,i=null){super(t,e,i)}correctOffset(t,e){return new D(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new D(this.x,this.y,t)}}function T(t){return class extends t{constructor(){super(...arguments),this.lastClickState=d.Released,this.clickState=d.Released,this.clickStateChanged=!1,this.wasClick=!1,this.pointerPos=null,this.startingPointerPos=null}getNormalInRect(t,e,i,s,n,h){return[(t-i)/(s-i),(e-n)/(h-n)]}isPointInRect(t,e,i,s,n,h){return t>=i&&t<s&&e>=n&&e<h}isNormalInRect(t,e){return t>=0&&t<1&&e>=0&&e<1}setClickState(t,e){this.clickState!==t?(this.lastClickState=this.clickState,this.clickState=t,this.wasClick=e&&this.lastClickState===d.Hold,this.clickStateChanged=!0):this.clickStateChanged=!1}handleClickEvent(t,e,i){if(t instanceof b)return e.dropFocus(a.Pointer,this),this.pointerPos=null,this.setClickState(d.Released,!1);if(t instanceof B){this.pointerPos=this.getNormalInRect(t.x,t.y,...i);const s=this.isNormalInRect(...this.pointerPos);if(s)e.pointerStyle="pointer";else if(null===t.target)return e.dropFocus(a.Pointer,this),this.setClickState(d.Released,!1);return t instanceof D?(this.startingPointerPos=this.pointerPos,e.requestFocus(a.Pointer,this),this.setClickState(d.Hold,s)):t instanceof F?(e.dropFocus(a.Pointer,this),s?this.setClickState(d.Hover,s):this.setClickState(d.Released,s)):null===t.target?this.setClickState(d.Hover,s):this.setClickState(d.Hold,s)}this.clickStateChanged=!1}}}function P(t){return class extends t{constructor(){super(...arguments),this.children=[]}updateInheritedTheme(){const t=this.getInheritedTheme();if(null!==t)for(const e of this.children)e.inheritTheme(t)}forceLayoutDirty(){if(super.forceLayoutDirty(),this.enabled&&null!==this.children)for(const t of this.children)t.forceLayoutDirty()}}}!function(t){t[t.Released=0]="Released",t[t.Hover=1]="Hover",t[t.Hold=2]="Hold"}(d||(d={}));class S{constructor(t,e,i){p.set(this,!0),this.dirty=!0,this.layoutDirty=!0,g.set(this,void 0),v.set(this,null),f.set(this,null),this.resolvedWidth=0,this.resolvedHeight=0,this.needsClear=e,this.propagatesEvents=i,s(this,g,t)}updateInheritedTheme(){}updateTheme(){null===i(this,g)?s(this,v,i(this,f)):(i(this,g).fallback=i(this,f),s(this,v,i(this,g)))}get theme(){if(null===i(this,v))throw"Widget theme is not ready";return i(this,v)}get enabled(){return i(this,p)}enable(){i(this,p)||(s(this,p,!0),this.layoutDirty=!0,this.dirty=!0)}disable(){i(this,p)&&(s(this,p,!1),this.layoutDirty=!0,this.dirty=!1)}setThemeOverride(t){i(this,g)!==t&&(s(this,g,t),this.updateTheme(),i(this,p)&&(this.layoutDirty=!0,this.dirty=!0))}getThemeOverride(){return i(this,g)}inheritTheme(t){i(this,f)!==t&&(s(this,f,t),this.updateInheritedTheme(),this.updateTheme(),i(this,p)&&(this.layoutDirty=!0,this.dirty=!0))}getInheritedTheme(){return i(this,f)}onFocusDropped(t,e){}handleEvent(t,e,i,s){return t.target===this||t instanceof B&&null===t.target?this:null}dispatchEvent(t,e,s,n){if(!i(this,p))return null;if(null===t.target){if(t instanceof B&&(t.x<0||t.y<0||t.x>=e||t.y>=s))return null}else if(t.target!==this&&!this.propagatesEvents)return null;return this.handleEvent(t,e,s,n)}handlePreLayoutUpdate(t){}preLayoutUpdate(t){i(this,p)&&this.handlePreLayoutUpdate(t)}handlePopulateLayout(t){throw new Error("Widget.handlePopulateLayout not implemented")}handleResolveLayout(t){throw new Error("Widget.handleResolveLayout not implemented")}populateLayout(t){i(this,p)&&this.handlePopulateLayout(t)}resolveLayout(t){if(!i(this,p))return this.resolvedWidth=0,this.resolvedHeight=0,void(this.layoutDirty=!1);if(this.layoutDirty){const e=this.resolvedWidth,i=this.resolvedHeight;this.handleResolveLayout(t),this.layoutDirty=!1,e===this.resolvedWidth&&i===this.resolvedHeight||(this.dirty=!0)}}forceLayoutDirty(){i(this,p)&&(this.layoutDirty=!0,this.dirty=!0)}handlePostLayoutUpdate(t){}postLayoutUpdate(t){i(this,p)&&this.handlePostLayoutUpdate(t)}clear(t,e,i,s,n){n.save(),n.globalCompositeOperation="copy",n.fillStyle=this.theme.getFill(h.CanvasFill),n.beginPath(),n.rect(Math.trunc(t),Math.trunc(e),Math.ceil(i),Math.ceil(s)),n.clip(),n.fill(),n.restore()}handlePainting(t,e,i,s,n){}paint(t,e,s,n,h){this.dirty&&(i(this,p)&&(this.needsClear&&this.clear(t,e,s,n,h),h.save(),this.handlePainting(t,e,s,n,h),h.restore()),this.dirty=!1)}}p=new WeakMap,g=new WeakMap,v=new WeakMap,f=new WeakMap;class W extends(P(S)){constructor(t,e,i,s){super(t,e,i);for(const t of s)this.children.push(t)}}class E extends W{constructor(t,e,i,s){super(t,e,i,[s])}getChild(){return this.children[0]}}class I extends E{constructor(t,e,i=null){super(i,!1,e,t),this.backgroundDirty=!0}handleEvent(t,e,i,s){const[n,h,l,r]=this.calcChildViewport(0,0,e,i);return t instanceof B&&(t=t.correctOffset(n,l)),this.getChild().dispatchEvent(t,h-n,r-l,s)}handlePreLayoutUpdate(t){const e=this.getChild();e.preLayoutUpdate(t),e.layoutDirty&&(this.layoutDirty=!0)}handlePostLayoutUpdate(t){const e=this.getChild();e.postLayoutUpdate(t),e.dirty&&(this.dirty=!0)}forceLayoutDirty(){this.backgroundDirty=!0,super.forceLayoutDirty()}handlePopulateLayout(t){const e=this.theme.getPadding(h.ContainerPadding);let i=t.maxWidth;const s=e.left+e.right;t.vertical&&(i-=s);let n=t.maxHeight;const l=e.top+e.bottom;t.vertical||(n-=l);const r=new w(i,n,t.vertical);this.getChild().populateLayout(r),t.addBasis(r.hBasis+s,r.vBasis+l),t.hFlex+=r.hFlex,t.vFlex+=r.vFlex;const a=r.hBasis+s;a>t.maxWidth&&(t.maxWidth=a);const o=r.vBasis+l;o>t.maxHeight&&(t.maxHeight=o)}handleResolveLayout(t){const e=this.theme.getPadding(h.ContainerPadding),i=e.left+e.right;let s=t.maxWidth;t.vertical&&(s-=i);const n=e.top+e.bottom;let l=t.maxHeight;t.vertical||(l-=n);const r=t.clone();r.maxWidth=s,r.maxHeight=l;const a=this.getChild();a.resolveLayout(r);const o=a.resolvedWidth,u=a.resolvedHeight;if(isNaN(o)||isNaN(u)||o<0||u<0)throw console.error("Child resolved to invalid dimensions:",o,u,a),new Error("Child resolved to invalid dimensions");r.sizeChanged&&(t.sizeChanged=!0);const c=this.resolvedWidth,d=this.resolvedHeight;this.resolvedWidth=o+i,this.resolvedHeight=u+n,c===this.resolvedWidth&&d===this.resolvedHeight||(this.backgroundDirty=!0)}handlePainting(t,e,i,s,n){this.backgroundDirty&&this.clear(t,e,i,s,n),this.backgroundDirty=!1;const[h,l,r,a]=this.calcChildViewport(t,e,i,s);this.getChild().paint(h,r,l-h,a-r,n)}calcChildViewport(t,e,i,s){const n=this.theme.getPadding(h.ContainerPadding);let r=t+n.left,a=t+i-n.right,o=e+n.top,u=e+s-n.bottom;if(r>a||o>u)return console.warn("Not enough space for padding in Container widget! Falling back to using no padding"),[t,e,i,s];const c=this.theme.getAlignment2D(h.ContainerAlignment);if(c.horizontal!==l.Stretch){const t=a-r-this.resolvedWidth;if(t>0)switch(c.horizontal){case l.Start:a-=t;break;case l.Center:r+=t/2,a-=t/2;break;case l.End:r+=t}}if(c.vertical!==l.Stretch){const t=u-o-this.resolvedHeight;if(t>0)switch(c.vertical){case l.Start:u-=t;break;case l.Center:o+=t/2,u-=t/2;break;case l.End:o+=t}}return[r,a,o,u]}}class H extends(T(I)){constructor(t,e=null,i=null){super(t,!1,i),this.callback=e}handleEvent(t,e,i,s){if(null===this.callback)return this.clickStateChanged=!1,this;if(this.handleClickEvent(t,s,[0,e,0,i]),this.clickStateChanged&&this.wasClick)try{this.callback()}catch(t){console.error("Exception in Icon callback",t)}return this}}class R extends H{constructor(){super(...arguments),y.set(this,h.BackgroundFill),m.set(this,!1)}updateBackground(){var t;if(i(this,m))s(this,y,h.PrimaryFill);else switch(this.clickState){case d.Hold:s(this,y,h.AccentFill);break;case d.Hover:s(this,y,h.BackgroundGlowFill);break;default:s(this,y,h.BackgroundFill)}const e=this.theme.getFill(i(this,y)),l=new n(new Map([[h.CanvasFill,e]]),null===(t=this.getInheritedTheme())||void 0===t?void 0:t.fallback);super.inheritTheme(l),this.backgroundDirty=!0}set forced(t){t!==i(this,m)&&(s(this,m,t),this.updateBackground())}get forced(){return i(this,m)}setThemeOverride(t){if(this.backgroundDirty=!0,null===t)return super.setThemeOverride(null);try{const e=t.getFill(i(this,y,"f")),s=new n(new Map([[h.CanvasFill,e]]));super.setThemeOverride(s)}catch(t){return super.setThemeOverride(null)}}inheritTheme(t){this.backgroundDirty=!0;const e=t.getFill(i(this,y)),s=new n(new Map([[h.CanvasFill,e]]),t);super.inheritTheme(s)}handlePostLayoutUpdate(t){super.handlePostLayoutUpdate(t),this.dirty&&(this.backgroundDirty=!0)}handleEvent(t,e,i,s){const n=super.handleEvent(t,e,i,s);return this.clickStateChanged&&this.updateBackground(),n}}y=new WeakMap,m=new WeakMap;let _=null;const U=new Map;function A(t,e){if(""===t)return[0,0,0];if(null===_){const t=document.createElement("canvas");if(_=t.getContext("2d"),null===_)throw"Failed to get canvas context"}let i;if(_.font=e,U.has(e))i=U.get(e);else{const t=_.measureText("-");i=Math.abs(t.actualBoundingBoxLeft)+Math.abs(t.actualBoundingBoxRight),U.set(e,i)}const s=_.measureText("-"+t+"-");return[Math.abs(s.actualBoundingBoxLeft)+Math.abs(s.actualBoundingBoxRight)-2*i,Math.abs(s.actualBoundingBoxAscent),Math.abs(s.actualBoundingBoxDescent)]}function z(t){var e,n,h,l,r;return r=class extends t{constructor(){super(...arguments),this._text="",this._font="",this._minLabelWidth=0,this._minLabelAscent=0,this._minLabelDescent=0,e.set(this,0),n.set(this,0),h.set(this,0),l.set(this,!0)}updateTextDims(){if(!i(this,l))return;const[t,r,a]=A(this._text,this._font);s(this,e,Math.max(t,this._minLabelWidth)),s(this,n,Math.max(r,this._minLabelAscent)),s(this,h,Math.max(a,this._minLabelDescent)),s(this,l,!1)}findOffsetFromIndex(t){return t<=0?0:A(this._text.substring(0,t),this._font)[0]}findIndexOffsetFromOffset(t){if(t<=0)return[0,0];let e=0,i="",s=0;for(const n of this._text){i+=n;const h=A(i,this._font)[0];if(t<(h+s)/2)return[e,s];e++,s=h}return[this._text.length,s]}setLabelDirty(){s(this,l,!0),this.layoutDirty=!0}get labelWidth(){return this.updateTextDims(),i(this,e)}get labelAscent(){return this.updateTextDims(),i(this,n)}get labelDescent(){return this.updateTextDims(),i(this,h)}get labelHeight(){return this.updateTextDims(),i(this,n)+i(this,h)}setText(t){this._text!==t&&(this._text=t,this.dirty=!0,this.setLabelDirty())}setFont(t){this._font!==t&&(this._font=t,this.dirty=!0,this.setLabelDirty())}setMinLabelWidth(t){this._minLabelWidth!==t&&(this._minLabelWidth=t,this.setLabelDirty())}setMinLabelAscent(t){this._minLabelAscent!==t&&(this._minLabelAscent=t,this.setLabelDirty())}setMinLabelDescent(t){this._minLabelDescent!==t&&(this._minLabelDescent=t,this.setLabelDirty())}},e=new WeakMap,n=new WeakMap,h=new WeakMap,l=new WeakMap,r}var O,V,N,Q,K,$,G,q,X,Y,j,J,Z;class tt extends S{constructor(){super(...arguments),O.set(this,1),V.set(this,0),N.set(this,0),Q.set(this,0),K.set(this,0),$.set(this,0),G.set(this,0),q.set(this,null),this.lastVertical=!0}get flexRatio(){return i(this,O)}set flexRatio(t){i(this,O)!==t&&(s(this,O,t),this.layoutDirty=!0)}get vertical(){return i(this,q)}set vertical(t){i(this,q)!==t&&(s(this,q,t),this.layoutDirty=!0)}get mainBasis(){return i(this,V)}set mainBasis(t){i(this,V)!==t&&(s(this,V,t),this.updateEffectiveMainBasis())}get crossBasis(){return i(this,N)}set crossBasis(t){i(this,N)!==t&&(s(this,N,t),this.updateEffectiveCrossBasis())}get internalMainBasis(){return i(this,Q)}set internalMainBasis(t){i(this,Q)!==t&&(s(this,Q,t),this.updateEffectiveMainBasis())}get internalCrossBasis(){return i(this,K)}set internalCrossBasis(t){i(this,K)!==t&&(s(this,K,t),this.updateEffectiveCrossBasis())}updateEffectiveMainBasis(){const t=Math.max(i(this,V),i(this,Q));i(this,$)!==t&&(s(this,$,t),this.layoutDirty=!0)}updateEffectiveCrossBasis(){const t=Math.max(i(this,N),i(this,K));i(this,G)!==t&&(s(this,G,t),this.layoutDirty=!0)}handlePopulateLayout(t){var e;const s=null!==(e=this.vertical)&&void 0!==e?e:t.vertical;this.lastVertical=s,t.vertical===s?s?(i(this,O)>0&&(t.vFlex+=i(this,O)),t.vBasis+=i(this,$),i(this,G)>t.hBasis&&(t.hBasis=i(this,G))):(i(this,O)>0&&(t.hFlex+=i(this,O)),t.hBasis+=i(this,$),i(this,G)>t.vBasis&&(t.vBasis=i(this,G))):s?(t.hBasis+=i(this,G),i(this,$)>t.vBasis&&(t.vBasis=i(this,$))):(t.vBasis+=i(this,G),i(this,$)>t.hBasis&&(t.hBasis=i(this,$)))}handleResolveLayout(t){var e;let s;const n=null!==(e=this.vertical)&&void 0!==e?e:t.vertical;t.vertical!==n?s=i(this,O)>0?n?t.maxHeight:t.maxWidth:i(this,$):i(this,O)>0?(s=n?(t.maxHeight-t.vBasis)*i(this,O)/t.vFlex:(t.maxWidth-t.hBasis)*i(this,O)/t.hFlex,s=i(this,$)+Math.max(0,s)):s=i(this,$),n?(this.resolvedWidth=i(this,G),this.resolvedHeight=s):(this.resolvedWidth=s,this.resolvedHeight=i(this,G))}}O=new WeakMap,V=new WeakMap,N=new WeakMap,Q=new WeakMap,K=new WeakMap,$=new WeakMap,G=new WeakMap,q=new WeakMap;class et extends(z(tt)){constructor(t,e=null){super(e,!0,!1),X.set(this,null),this.text=t,this.flexRatio=0,this.vertical=!1}set text(t){t instanceof Function?s(this,X,t):this.setText(t)}get text(){return null!==i(this,X)?i(this,X):this._text}get currentText(){return this._text}handlePreLayoutUpdate(t){null!==i(this,X)&&this.setText(i(this,X).call(this)),this.setFont(this.theme.getFont(h.BodyTextFont)),this.setMinLabelWidth(this.theme.getSize(h.LabelMinWidth)),this.setMinLabelAscent(this.theme.getSize(h.LabelMinAscent)),this.setMinLabelDescent(this.theme.getSize(h.LabelMinDescent)),this.internalMainBasis=this.labelWidth,this.internalCrossBasis=this.labelHeight}handlePainting(t,e,i,s,n){n.font=this._font,n.fillStyle=this.theme.getFill(h.BodyTextFill),n.fillText(this._text,t,e+s-this.labelDescent)}}function it(t,e=null,i=null){return new R(new et(t,i),e,i)}function st(t,e,i,s=null){return it(t,(()=>i.callback(e)),s)}function nt(t,e=null){return st("Backspace","Backspace",t,e)}function ht(t,e=null){return st("Esc","Escape",t,e)}function lt(t,e=null){return st("Enter","Enter",t,e)}function rt(t,e=null){const i=it("Shift",(()=>{t.shift=!t.shift,i.forced=t.shift,t.callback("Shift")}),e);return i.forced=t.shift,i}function at(t,e=null){return st("Space"," ",t,e)}function ot(t,e=null,i,s=null){function n(){return i.shift?null===e?t:e:t}return null===e&&(e=t),it(n,(()=>i.callback(n())),s)}X=new WeakMap;class ut extends W{constructor(t,e,i,s){super(t,e,i,s)}add(t){if(Array.isArray(t))for(const e of t)this.children.push(e);else this.children.push(t);return this.updateInheritedTheme(),this.layoutDirty=!0,this.dirty=!0,this}remove(t){if(Array.isArray(t))for(const e of t){const t=this.children.indexOf(e);-1!==t&&this.children.splice(t,1)}else{const e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1)}return this.updateInheritedTheme(),this.layoutDirty=!0,this.dirty=!0,this}clearChildren(){return this.children.length=0,this.layoutDirty=!0,this.dirty=!0,this}getChildCount(){return this.children.length}}class ct extends ut{constructor(t,e=null){super(e,!1,!0,[]),Y.set(this,!0),j.set(this,void 0),J.set(this,null),s(this,j,t)}handleEvent(t,e,s,n){const l=this.theme.getSize(h.ContainerSpacing);for(const h of this.children){if(!h.enabled)continue;const r=i(this,j)?h.resolvedHeight:h.resolvedWidth;let a,o;i(this,j)?(a=e,o=r):(a=r,o=s);const u=h.dispatchEvent(t,a,o,n);if(null!==u)return u;t instanceof B&&(t=i(this,j)?t.correctOffset(0,r+l):t.correctOffset(r+l,0))}return null}handlePreLayoutUpdate(t){let e=!1;for(const i of this.children)i.preLayoutUpdate(t),i.layoutDirty&&(e=!0);e&&this.forceLayoutDirty()}handlePostLayoutUpdate(t){for(const e of this.children)e.postLayoutUpdate(t),e.dirty&&(this.dirty=!0)}forceLayoutDirty(){s(this,Y,!0),super.forceLayoutDirty()}handlePopulateLayout(t){const e=i(this,j)===t.vertical;let n;e?n=t:(s(this,J,new w(t.maxWidth,t.maxHeight,i(this,j))),n=i(this,J));for(const t of this.children)t.populateLayout(n);const l=this.children.length,r=this.theme.getSize(h.ContainerSpacing);if(l>1&&r>0){const t=r*(l-1);n.vertical?n.vBasis+=t:n.hBasis+=t}e||t.addBasis(n.hBasis,n.vBasis),n.hBasis>t.maxWidth&&(t.maxWidth=n.hBasis),n.vBasis>t.maxHeight&&(t.maxHeight=n.vBasis)}handleResolveLayout(t){const e=i(this,j)===t.vertical;let n;if(e)n=t;else{if(n=i(this,J),null===n)throw"Unexpected null innerContext";t.maxWidth>n.maxWidth&&(n.maxWidth=t.maxWidth),t.maxHeight>n.maxHeight&&(n.maxHeight=t.maxHeight)}let l=0,r=0,a=0,o=0,u=0;for(const t of this.children){if(!t.enabled){t.resolveLayout(n);continue}u++;const e=t.resolvedWidth,s=t.resolvedHeight;t.resolveLayout(n);const h=t.resolvedWidth,c=t.resolvedHeight;if(isNaN(h)||isNaN(c)||h<0||c<0)throw console.error("Child resolved to invalid dimensions:",h,c,t),new Error("Child resolved to invalid dimensions");i(this,j)?c!==s&&(n.sizeChanged=!0):h!==e&&(n.sizeChanged=!0),a+=h,h>l&&(l=h),o+=c,c>r&&(r=c)}!e&&n.sizeChanged&&(t.sizeChanged=!0),s(this,J,null);const c=this.theme.getSize(h.ContainerSpacing);let d=0;u>1&&c>0&&(d=c*(u-1)),i(this,j)?(this.resolvedWidth=l,this.resolvedHeight=o+d):(this.resolvedWidth=a+d,this.resolvedHeight=r)}handlePainting(t,e,n,l,r){const a=this.theme.getSize(h.ContainerSpacing);i(this,Y)&&a>0&&this.clear(t,e,n,l,r),s(this,Y,!1);const o=i(this,j)?e+l:t+n;for(const s of this.children){if(!s.enabled)continue;let h,u,c=!1;i(this,j)?(h=n,u=s.resolvedHeight,e+u>o&&(c=!0,u=o-e)):(h=s.resolvedWidth,u=l,t+h>o&&(c=!0,h=o-t)),s.paint(t,e,h,u,r),c&&console.warn("MultiContainer overflow, children may be painted with 0 length"),i(this,j)?e+=u+a:t+=h+a}}}function dt(t=null){return new ct(!1,t)}function pt(t,e,i=null){const s=dt(i);for(const n of t)if("function"==typeof n){const t=n;s.add(t(e,i))}else{if("string"!=typeof n[0]||"string"!=typeof n[1])throw new Error(`Unknown virtual key row template format for entry: ${n}`);{const t=n[0],h=n[1];for(let n=0;n<t.length;n++){let l=null;n<h.length&&(l=h[n]),s.add(ot(t[n],l,e,i))}}}return s}Y=new WeakMap,j=new WeakMap,J=new WeakMap;const gt=[[["`1234567890-=","~!@#$%^&*()_+"]],[["qwertyuiop[]\\","QWERTYUIOP{}|"]],[["asdfghjkl;'",'ASDFGHJKL:"'],lt],[rt,["zxcvbnm,./","ZXCVBNM<>?"]],[nt,at,ht]];class vt extends ct{constructor(t,e=null,n=null){super(!0,n),Z.set(this,void 0),s(this,Z,{callback:e=>{t.keyPress(e)},shift:!1}),null===e&&(e=gt);for(const t of e)this.add(pt(t,i(this,Z),n))}}var ft,yt,mt,xt,bt,wt,kt,Ct,Lt,Mt,Bt,Ft,Dt,Tt,Pt,St,Wt;Z=new WeakMap;class Et extends M{constructor(t,e=null,i=r){super(new vt(t,e),i),ft.set(this,void 0),s(this,ft,t)}update(){this.enabled=null!==i(this,ft).getFocusedRoot(),super.update()}}ft=new WeakMap;class It extends L{constructor(t,e=null,i=null,n=r){super(new vt(t,e),i,n),yt.set(this,void 0),s(this,yt,t)}updateVisibility(){this.enabled=null!==i(this,yt).getFocusedRoot()}}yt=new WeakMap;class Ht extends x{constructor(t,e){super(e,a.Keyboard,!0),this.key=t}}class Rt extends Ht{cloneWithTarget(t){return new Rt(this.key,t)}}class _t extends Ht{cloneWithTarget(t){return new _t(this.key,t)}}class Ut{constructor(){this.eventQueues=new Map,this.keysDown=new Set,this.focus=null}getEventQueue(t){if(null===t)return null;const e=this.eventQueues.get(t);return void 0===e?null:e}_changeFocusedRoot(t){null!==this.focus&&this.focus.clearFocus(a.Keyboard),this.focus=t,this.keysDown.clear()}getFocusedRoot(){return this.focus}clearFocus(){this._changeFocusedRoot(null)}keyDown(t){this.keysDown.add(t);const e=this.getEventQueue(this.focus);null!==e&&e.push(new _t(t,null))}keyUp(t){if(this.keysDown.delete(t)){const e=this.getEventQueue(this.focus);null!==e&&e.push(new Rt(t,null))}}keyPress(t){const e=this.isKeyDown(t);this.keyDown(t),e||this.keyUp(t)}isKeyDown(t){return this.keysDown.has(t)}onEnable(t){this.eventQueues.has(t)||this.eventQueues.set(t,[])}onDisable(t){this.eventQueues.has(t)&&(this.eventQueues.delete(t),t===this.focus&&this._changeFocusedRoot(null))}update(t){const e=this.getEventQueue(t);if(null!==e){for(const i of e)t.dispatchEvent(i);e.length=0}}onFocusChanged(t,e,i){e===a.Keyboard&&(t==this.focus?null===i&&this._changeFocusedRoot(null):null!==i&&this._changeFocusedRoot(t))}onFocusCapturerChanged(t,e,i,s){}}class At extends Ut{constructor(){super(...arguments),mt.set(this,new Set)}bindDOMElem(t,e=!0){i(this,mt).has(t)||(i(this,mt).add(t),e&&(t.addEventListener("keydown",(t=>{t.preventDefault(),this.keyDown(t.key)})),t.addEventListener("keyup",(t=>{t.preventDefault(),this.keyUp(t.key)}))),t.addEventListener("blur",(t=>{this.shouldClearFocus(t.relatedTarget)&&this.clearFocus()})))}shouldClearFocus(t){return null===t||!i(this,mt).has(t)}}mt=new WeakMap;class zt extends B{constructor(t,e,i=null){super(t,e,i,a.Pointer)}correctOffset(t,e){return new zt(this.x-t,this.y-e,this.target)}cloneWithTarget(t){return new zt(this.x,this.y,t)}}class Ot{constructor(){this._states=new Map,xt.set(this,0)}registerPointer(){var t;return s(this,xt,1+(t=+i(this,xt))),t}unregisterPointer(t){for(const[e,i]of this._states)i.pointer===t&&(i.pointer=null,i.hovering&&i.eventQueue.push(new b(e.getFocusCapturer(a.Pointer))),i.hovering=!1,i.pressing=!1)}movePointer(t,e,i,s,n=null){const h=this._states.get(t);if(void 0===h)return;null===h.pointer&&(h.pointer=e),null===n&&(n=h.pressing);if(!(h.pointer===e)&&(!n||h.pressing))return;const[l,r]=t.dimensions,o=i*l,u=s*r;let c;n!==h.pressing?(c=n?new D(o,u):new F(o,u),h.pressing=n,n&&h.pointer!==e&&(h.eventQueue.push(new b(t.getFocusCapturer(a.Pointer))),h.pointer=e)):c=new zt(o,u),h.eventQueue.push(c),h.hovering=!0}leavePointer(t,e){const i=this._states.get(t);void 0!==i&&i.hovering&&i.pointer==e&&(i.hovering=!1,i.eventQueue.push(new b(t.getFocusCapturer(a.Pointer))))}onEnable(t){this._states.set(t,{eventQueue:[],pointer:null,pressing:!1,hovering:!1})}onDisable(t){t.dispatchEvent(new b),this._states.delete(t)}update(t){const e=this._states.get(t);if(void 0!==e){for(const i of e.eventQueue)t.dispatchEvent(i);e.eventQueue.length=0}}onFocusChanged(t,e,i){}onFocusCapturerChanged(t,e,i,s){}}function Vt(t,e){const i=e.getBoundingClientRect();return[(t.clientX-i.left)/i.width,(t.clientY-i.top)/i.height]}xt=new WeakMap;class Nt extends Ot{constructor(){super(),bt.set(this,new WeakMap),wt.set(this,void 0),s(this,wt,this.registerPointer())}bindDOMElem(t,e){let s=i(this,bt).get(t);void 0!==s?this.removeListeners(s):(s={domElem:e,pointermoveListen:null,pointerdownListen:null,pointerupListen:null,pointerleaveListen:null},i(this,bt).set(t,s)),t.enabled&&this.addListeners(t,s)}addListeners(t,e){const s=e.domElem;e.pointermoveListen=e=>{e.isPrimary&&this.movePointer(t,i(this,wt),...Vt(e,s))},e.pointerdownListen=e=>{e.isPrimary&&this.movePointer(t,i(this,wt),...Vt(e,s),!0)},e.pointerupListen=e=>{e.isPrimary&&this.movePointer(t,i(this,wt),...Vt(e,s),!1)},e.pointerleaveListen=e=>{e.isPrimary&&this.leavePointer(t,i(this,wt))},s.addEventListener("pointermove",e.pointermoveListen),s.addEventListener("pointerdown",e.pointerdownListen),s.addEventListener("pointerup",e.pointerupListen),s.addEventListener("pointerleave",e.pointerleaveListen)}removeListeners(t){null!==t.pointermoveListen&&(t.domElem.removeEventListener("pointermove",t.pointermoveListen),t.pointermoveListen=null),null!==t.pointerdownListen&&(t.domElem.removeEventListener("pointerdown",t.pointerdownListen),t.pointerdownListen=null),null!==t.pointerupListen&&(t.domElem.removeEventListener("pointerup",t.pointerupListen),t.pointerupListen=null),null!==t.pointerleaveListen&&(t.domElem.removeEventListener("pointerleave",t.pointerleaveListen),t.pointerleaveListen=null)}onEnable(t){super.onEnable(t);const e=i(this,bt).get(t);void 0!==e&&this.addListeners(t,e)}onDisable(t){super.onDisable(t);const e=i(this,bt).get(t);void 0!==e&&this.removeListeners(e)}}function Qt(t,e){var n,h;return h=class extends t{constructor(){super(...arguments),this.callback=null,n.set(this,e)}get value(){return i(this,n)}set value(t){this.setValue(t)}setValue(t,e=!0){if(i(this,n)!==t&&(s(this,n,t),this.dirty=!0,e&&null!==this.callback))try{this.callback(t)}catch(t){console.error("Exception in Variable callback",t)}}},n=new WeakMap,h}bt=new WeakMap,wt=new WeakMap;class Kt extends I{constructor(t,e=null){super(t,!0,e)}}function $t(t){const e=new n(new Map([[h.ContainerAlignment,{horizontal:l.Center,vertical:l.Center}],[h.ContainerPadding,{left:0,right:0,top:0,bottom:0}]]));return new Kt(t,e)}function Gt(t=null){return new ct(!0,t)}class qt extends S{constructor(){super(...arguments),kt.set(this,0),Ct.set(this,0)}get boxWidth(){return i(this,kt)}set boxWidth(t){i(this,kt)!==t&&(s(this,kt,t),this.layoutDirty=!0)}get boxHeight(){return i(this,Ct)}set boxHeight(t){i(this,Ct)!==t&&(s(this,Ct,t),this.layoutDirty=!0)}handlePopulateLayout(t){t.addBasis(i(this,kt),i(this,Ct))}handleResolveLayout(t){this.resolvedWidth=i(this,kt),this.resolvedHeight=i(this,Ct)}}kt=new WeakMap,Ct=new WeakMap;class Xt extends(T(Qt(qt,!1))){constructor(t=null,e=!1,i=null){super(i,!0,!1),this.callback=t,this.setValue(e,!1)}getBoxRect(t,e,i,s){const n=this.theme.getSize(h.CheckboxLength),l=Math.min(n,i,s),r=t+(i-l)/2,a=e+(s-l)/2;return[r,r+l,a,a+l]}handleEvent(t,e,i,s){const n=this.getBoxRect(0,0,e,i);return this.handleClickEvent(t,s,n),this.clickStateChanged&&this.wasClick&&(this.value=!this.value),this}handlePreLayoutUpdate(t){const e=this.theme.getSize(h.CheckboxLength);this.boxWidth=e,this.boxHeight=e}handlePainting(t,e,i,s,n){const[l,r,a,o]=this.getBoxRect(t,e,i,s),u=r-l,c=[d.Hover,d.Hold].includes(this.clickState);if(n.fillStyle=c?this.theme.getFill(h.BackgroundGlowFill):this.theme.getFill(h.BackgroundFill),n.fillRect(l,a,u,u),this.value){n.fillStyle=c?this.theme.getFill(h.AccentFill):this.theme.getFill(h.PrimaryFill);const t=this.theme.getSize(h.CheckboxInnerPadding),e=u-2*t;e<=0?n.fillRect(l,a,u,u):n.fillRect(l+t,a+t,e,e)}}}class Yt extends tt{constructor(t=1,e=0,i=0,s=null,n=null){super(n,!0,!1),this.flexRatio=t,this.mainBasis=e,this.crossBasis=i,this.vertical=s}}function jt(t,e=null,i=!1,s=null){return dt(s).add([new et(t,s),new Yt(1,0,0,!1,s),new Xt(e,i,s)])}function Jt(t){const e=new n(new Map([[h.ContainerAlignment,{horizontal:l.Center,vertical:l.Center}]]));return new Kt(t,e)}class Zt extends(z(Qt(tt,""))){constructor(t,e="",n=null){var h,l;super(n,!1,!1),Lt.set(this,0),Mt.set(this,null),Bt.set(this,0),Ft.set(this,0),Dt.set(this,!1),Tt.set(this,!0),Pt.set(this,!1),St.set(this,void 0),Wt.set(this,void 0),this.setValue(e,!1),h=this,l=this,[{set value(t){s(h,St,t)}}.value,{set value(t){s(l,Wt,t)}}.value]=t(e),this.callback=e=>{const[n,h]=t(e);n&&s(this,Wt,h),n!==i(this,St)&&(s(this,St,n),this.dirty=!0)},this.vertical=!1}get blinkOn(){if(0===i(this,Lt))return null;const t=this.theme.getSize(h.BlinkRate);return 0===Math.trunc((Date.now()-i(this,Lt))/(500*t)%2)}get editingEnabled(){return i(this,Tt)}set editingEnabled(t){i(this,Tt)!==t&&(s(this,Tt,t),t||(s(this,Lt,0),this.moveCursorTo(0)),this.dirty=!0)}get hideText(){return i(this,Pt)}set hideText(t){i(this,Pt)!==t&&(s(this,Pt,t),s(this,Dt,!0),this.dirty=!0)}get text(){return i(this,Pt)?"●".repeat(this.value.length):this.value}get valid(){return i(this,St)}get validValue(){return i(this,Wt)}moveCursorTo(t){s(this,Bt,Math.min(Math.max(t,0),this.value.length)),s(this,Dt,!0),this.dirty=!0}moveCursor(t){this.moveCursorTo(i(this,Bt)+t)}insertText(t){this.value=this.value.substring(0,i(this,Bt))+t+this.value.substring(i(this,Bt)),this.moveCursor(t.length)}deleteText(t){t>0?this.value=this.value.substring(0,i(this,Bt))+this.value.substring(i(this,Bt)+t):t<0&&(this.value=this.value.substring(0,i(this,Bt)+t)+this.value.substring(i(this,Bt)),this.moveCursor(t))}onFocusDropped(t,e){t===a.Keyboard&&s(this,Lt,0)}handleEvent(t,e,n,h){var l,r;if(!i(this,Tt))return this;if(t instanceof B)return h.pointerStyle="text",t instanceof D?(l=this,r=this,[{set value(t){s(l,Bt,t)}}.value,{set value(t){s(r,Ft,t)}}.value]=this.findIndexOffsetFromOffset(t.x),s(this,Lt,Date.now()),this.dirty=!0,h.requestFocus(a.Keyboard,this)):t instanceof F&&h.hasMobileTextInput&&h.getTextInput(this.value).then((t=>{null!==t&&this.value!==t&&(this.value=t,this.moveCursorTo(t.length))})),this;if(t instanceof _t){if(1===t.key.length)this.insertText(t.key);else if("Backspace"===t.key)this.deleteText(-1);else if("Delete"===t.key)this.deleteText(1);else if("ArrowLeft"===t.key)this.moveCursor(-1);else if("ArrowRight"===t.key)this.moveCursor(1);else if("Home"===t.key)this.moveCursorTo(0);else{if("End"!==t.key)return"Escape"===t.key?(h.dropFocus(a.Keyboard,this),this):this;this.moveCursorTo(this.value.length)}s(this,Lt,Date.now())}return this}handlePreLayoutUpdate(t){this.editingEnabled||t.dropFocus(a.Keyboard,this),this.blinkOn!==i(this,Mt)&&(this.dirty=!0);const e=this.theme.getSize(h.CursorPadding)+this.theme.getSize(h.CursorThickness);this.setText(this.text),this.setFont(this.theme.getFont(h.InputTextFont)),this.setMinLabelWidth(this.theme.getSize(h.InputTextMinWidth)-e),this.setMinLabelAscent(this.theme.getSize(h.InputTextMinAscent)),this.setMinLabelDescent(this.theme.getSize(h.InputTextMinDescent)),i(this,Dt)&&(s(this,Ft,this.findOffsetFromIndex(i(this,Bt))),s(this,Dt,!1)),this.flexRatio=this.theme.getSize(h.InputTextFlexRatio),this.internalMainBasis=this.labelWidth+e,this.internalCrossBasis=this.labelHeight}handlePainting(t,e,n,l,r){r.fillStyle=this.theme.getFill(h.InputBackgroundFill),r.fillRect(t,e,n,l),r.font=this.theme.getFont(h.InputTextFont),i(this,Tt)?i(this,St)?r.fillStyle=this.theme.getFill(h.InputTextFill):r.fillStyle=this.theme.getFill(h.InputTextFillInvalid):r.fillStyle=this.theme.getFill(h.InputTextFillDisabled),r.fillText(this.text,t,e+l-this.labelDescent);const a=this.blinkOn;if(s(this,Mt,a),!a)return;const o=this.theme.getSize(h.CursorPadding),u=this.theme.getSize(h.CursorThickness);r.fillRect(t+i(this,Ft),e+o,u,l-2*o)}}function te(t){return[!0,t]}function ee(t=null){return null===t?te:e=>(t(e),[!0,e])}function ie(t=null,e="",i=null){const s=ee(t);return new Zt(s,e,i)}Lt=new WeakMap,Mt=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Dt=new WeakMap,Tt=new WeakMap,Pt=new WeakMap,St=new WeakMap,Wt=new WeakMap;class se extends n{constructor(t){super(new Map,t)}getFill(t){return super.getFill(t),"#"+Math.floor(16777215*Math.random()).toString(16)}}function ne(t,e,i=null){return s=>{let n=!0,h=s;for(const i of t)if([n,h]=i(h),!n)return[!1,e];if(null!==i)try{i(h)}catch(t){console.warn("Exception in CompositeValidator callback:",t)}return[!0,h]}}const he=/^-?(\.\d+|\d+(\.(\d+)?)?)(e\d+)?$/;function le(t){return he.test(t)?[!0,parseFloat(t)]:[!1,NaN]}const re=/^-?\d+$/;function ae(t){return re.test(t)?[!0,parseInt(t)]:[!1,NaN]}function oe(t,e){return i=>i<t||i>e?[!1,i]:[!0,i]}var ue,ce,de,pe,ge,ve,fe,ye,me,xe,be,we,ke,Ce,Le,Me;class Be extends(T(qt)){constructor(t,e=null,i=null,n=null,h=null,l=null){super(l,!0,!1),ue.set(this,void 0),ce.set(this,null),de.set(this,0),s(this,ue,t),this.width=e,this.height=i,this.viewBox=n,this.callback=h,this.updateDimensions()}updateDimensions(){let t=this.width;null===t&&(t=null===this.viewBox?i(this,ue).width:this.viewBox[2]),this.boxWidth!==t&&(this.boxWidth=t);let e=this.height;null===e&&(e=null===this.viewBox?i(this,ue).height:this.viewBox[3]),this.boxHeight!==e&&(this.boxHeight=e)}setImage(t){t!==i(this,ue)&&(s(this,ue,t),s(this,ce,null))}getIconRect(t,e,i,s){const n=i/this.boxWidth,h=s/this.boxHeight,l=Math.min(n,h),r=this.boxWidth*l,a=this.boxHeight*l;return[t+(i-r)/2,e+(s-a)/2,r,a]}handleEvent(t,e,i,s){if(null===this.callback)return s.dropFocus(a.Pointer,this),this;const[n,h,l,r]=this.getIconRect(0,0,e,i);if(this.handleClickEvent(t,s,[n,n+l,h,h+r]),this.clickStateChanged&&this.wasClick)try{this.callback()}catch(t){console.error("Exception in Icon callback",t)}return this}handlePreLayoutUpdate(t){var e,s;(null===(e=i(this,ue))||void 0===e?void 0:e.src)!==i(this,ce)&&(null===(s=i(this,ue))||void 0===s?void 0:s.complete)&&(this.dirty=!0),this.updateDimensions()}get rotation(){return i(this,de)}set rotation(t){t!==i(this,de)&&(s(this,de,t),this.dirty=!0)}handlePainting(t,e,n,h,l){var r;if(!(null===(r=i(this,ue))||void 0===r?void 0:r.complete))return void s(this,ce,null);s(this,ce,i(this,ue).src);const[a,o,u,c]=this.getIconRect(t,e,n,h);let d=a,p=o;0!==this.rotation&&(l.save(),l.translate(a+u/2,o+c/2),d=-u/2,p=-c/2,l.rotate(this.rotation)),null===this.viewBox?l.drawImage(i(this,ue),d,p,u,c):l.drawImage(i(this,ue),...this.viewBox,d,p,u,c),0!==this.rotation&&l.restore()}}ue=new WeakMap,ce=new WeakMap,de=new WeakMap;class Fe extends E{constructor(t,e=null){super(e,!1,!0,t)}handleEvent(t,e,i,s){return this.getChild().dispatchEvent(t,e,i,s)}handlePreLayoutUpdate(t){const e=this.getChild();e.preLayoutUpdate(t),e.layoutDirty&&(this.layoutDirty=!0)}handlePostLayoutUpdate(t){const e=this.getChild();e.postLayoutUpdate(t),e.dirty&&(this.dirty=!0)}handlePopulateLayout(t){this.getChild().populateLayout(t)}handleResolveLayout(t){const e=this.getChild();e.resolveLayout(t),this.resolvedWidth=e.resolvedWidth,this.resolvedHeight=e.resolvedHeight}handlePainting(t,e,i,s,n){this.getChild().paint(t,e,i,s,n)}}class De extends(P(tt)){constructor(t,e=!1,i=!1,n=null){super(n,!1,!0),pe.set(this,void 0),ge.set(this,[0,0]),ve.set(this,null),this.maxDimensions=[0,0],this.lastViewportDims=[0,0],s(this,pe,new C),this.mainBasisTied=e,this.crossBasisTied=i,this.children.push(t)}get canvasDimensions(){return i(this,pe).canvasDimensions}get offset(){return[...i(this,ge)]}set offset(t){i(this,ge)[0]===t[0]&&i(this,ge)[1]===t[1]||(s(this,ge,t),this.dirty=!0)}get dimensions(){const t=this.getChild();return[t.resolvedWidth,t.resolvedHeight]}getChildMainBasis(t){if(null===i(this,ve))return 0;const e=t?i(this,ve).vBasis:i(this,ve).hBasis;return isNaN(e)?0:e}getChildCrossBasis(t){return this.getChildMainBasis(!t)}getMaxMainBasis(t){return t?this.maxDimensions[1]:this.maxDimensions[0]}getMaxCrossBasis(t){return this.getMaxMainBasis(!t)}handleEvent(t,e,i,s){if(null===t.target&&!(t instanceof B))return null;const[n,h]=this.dimensions,l=this.offset[0],r=l+n,a=this.offset[1],o=a+h;if(t instanceof B){if(null===t.target){if(t.x<l)return null;if(t.x>=r)return null;if(t.y<a)return null;if(t.y>=o)return null}t=t.correctOffset(l,a)}return this.getChild().dispatchEvent(t,r-l,o-a,s)}handlePreLayoutUpdate(t){let e=this.vertical;null===e&&(e=!0);const n=this.getChild();if(e!==i(this,pe).vertical&&(i(this,pe).vertical=e,n.layoutDirty=!0,n.dirty=!0),n.preLayoutUpdate(t),n.layoutDirty){if(this.layoutDirty=!0,s(this,ve,i(this,pe).populateChildsLayout(n)),this.mainBasisTied){let t=this.getChildMainBasis(e);const i=this.getMaxMainBasis(e);0!==i&&t>i&&(t=i),this.internalMainBasis=t}else this.internalMainBasis=0;if(this.crossBasisTied){let t=this.getChildCrossBasis(e);const i=this.getMaxCrossBasis(e);0!==i&&t>i&&(t=i),this.internalCrossBasis=t}else this.internalCrossBasis=0}}handlePostLayoutUpdate(t){const e=this.getChild();if(null!==i(this,ve)){let[t,n]=[...this.maxDimensions];(i(this,pe).vertical?this.crossBasisTied:this.mainBasisTied)&&(0===t||this.resolvedWidth<t)&&(t=this.resolvedWidth),(i(this,pe).vertical?this.mainBasisTied:this.crossBasisTied)&&(0===n||this.resolvedHeight<n)&&(n=this.resolvedHeight),i(this,pe).maxDimensions=[t,n],i(this,ve).maxWidth=t,i(this,ve).maxHeight=n,i(this,pe).resolveChildsLayout(e,i(this,ve)),s(this,ve,null)}e.postLayoutUpdate(t),e.dirty&&(this.dirty=!0)}handlePainting(t,e,s,n,l){this.lastViewportDims=[s,n],i(this,pe).paintToCanvas(this.getChild()),l.save();const r=new Path2D;r.rect(Math.trunc(t),Math.trunc(e),Math.ceil(s),Math.ceil(n)),l.clip(r),l.globalCompositeOperation="copy",l.fillStyle=this.theme.getFill(h.CanvasFill),l.fill(r);const[a,o]=this.dimensions,[u,c]=this.offset,d=t+u,p=e+c,g=new Path2D;g.rect(Math.trunc(d),Math.trunc(p),Math.ceil(a),Math.ceil(o)),l.clip(g),l.drawImage(i(this,pe).canvas,0,0,a,o,d,p,a,o),l.restore()}getChild(){return this.children[0]}}pe=new WeakMap,ge=new WeakMap,ve=new WeakMap;class Te extends(T(Qt(tt,0))){constructor(t=null,e=100,i=100,n=0,h=null){super(h,!0,!1),fe.set(this,void 0),ye.set(this,void 0),me.set(this,void 0),this.callback=t,this.setValue(n,!1),s(this,fe,e),s(this,ye,i),s(this,me,n)}get end(){return i(this,fe)}set end(t){i(this,fe)!==t&&(s(this,fe,t),this.dirty=!0)}get barLength(){return i(this,ye)}set barLength(t){i(this,ye)!==t&&(s(this,ye,t),this.dirty=!0)}setValue(t,e=!0){super.setValue(Math.max(Math.min(i(this,fe)-i(this,ye),t),0),e)}getBarRect(t,e,i,s){if(this.lastVertical){const n=Math.min(this.crossBasis,i),h=t+(i-n)/2;return[h,h+n,e,e+s]}{const n=Math.min(this.crossBasis,s),h=e+(s-n)/2;return[t,t+i,h,h+n]}}handleEvent(t,e,n,h){if(this.handleClickEvent(t,h,this.getBarRect(0,0,e,n)),this.clickState==d.Hold&&null!==this.pointerPos)if(this.clickStateChanged){let t;t=this.lastVertical?this.pointerPos[1]*i(this,fe):this.pointerPos[0]*i(this,fe);let e=this.value;null===e&&(e=0),(t<e||t>=e+i(this,ye))&&(e=t-i(this,ye)/2,this.value=e),s(this,me,e)}else if(null!==this.startingPointerPos){let t;t=this.lastVertical?this.pointerPos[1]-this.startingPointerPos[1]:this.pointerPos[0]-this.startingPointerPos[0],this.value=i(this,me)+t*i(this,fe)}return this.clickStateChanged&&(this.dirty=!0),this}handlePreLayoutUpdate(t){this.flexRatio=0,this.crossBasis=this.theme.getSize(h.ScrollBarThickness)}handlePainting(t,e,s,n,l){const[r,a,o,u]=this.getBarRect(t,e,s,n),[c,p]=[a-r,u-o];let g=this.value;null===g&&(g=0);const v=g/i(this,fe),f=i(this,ye)/i(this,fe);l.fillStyle=this.theme.getFill(h.BackgroundFill),l.fillRect(r,o,c,p);if([d.Hover,d.Hold].includes(this.clickState)?l.fillStyle=this.theme.getFill(h.AccentFill):l.fillStyle=this.theme.getFill(h.PrimaryFill),this.lastVertical){let t=f*p;t>p&&(t=p),l.fillRect(r,o+v*p,c,t)}else{let t=f*c;t>c&&(t=c),l.fillRect(r+v*c,o,t,p)}}}fe=new WeakMap,ye=new WeakMap,me=new WeakMap;class Pe extends Fe{constructor(t,e,n=!1,h=!1,l=null){super(Gt(l),l),xe.set(this,void 0),be.set(this,void 0),we.set(this,void 0);const r=new De(t,n,h,l);r.vertical=e;const a=new Te(null,0,0,0,l);a.vertical=!0;const o=dt(l).add([r,a]),u=new Te(null,0,0,0,l);u.vertical=!1;this.getChild().add([o,u]),s(this,xe,r),s(this,be,a),s(this,we,u),this.vScrollHide=!1,this.hScrollHide=!1,u.callback=t=>{null===t&&(t=0),i(this,xe).offset=[-t,i(this,xe).offset[1]]},a.callback=t=>{null===t&&(t=0),i(this,xe).offset=[i(this,xe).offset[0],-t]}}get maxDimensions(){return i(this,xe).maxDimensions}set maxDimensions(t){i(this,xe).maxDimensions=t}get flexRatio(){return i(this,xe).flexRatio}set flexRatio(t){i(this,xe).flexRatio=t}get mainBasis(){return i(this,xe).mainBasis}set mainBasis(t){i(this,xe).mainBasis=t}get crossBasis(){return i(this,xe).crossBasis}set crossBasis(t){i(this,xe).crossBasis=t}get containedChild(){return i(this,xe).getChild()}resetScroll(){i(this,we).value=0,i(this,be).value=0}handlePreLayoutUpdate(t){const[e,s]=i(this,xe).dimensions;i(this,xe).resolvedWidth<e&&!this.hScrollHide?i(this,we).enable():(i(this,we).value=0,i(this,we).disable()),i(this,xe).resolvedHeight<s&&!this.vScrollHide?i(this,be).enable():(i(this,be).value=0,i(this,be).disable()),super.handlePreLayoutUpdate(t)}handlePostLayoutUpdate(t){[i(this,we).end,i(this,be).end]=i(this,xe).dimensions,i(this,we).barLength=i(this,xe).lastViewportDims[0],i(this,be).barLength=i(this,xe).lastViewportDims[1],super.handlePostLayoutUpdate(t)}}xe=new WeakMap,be=new WeakMap,we=new WeakMap;class Se extends(T(Qt(tt,0))){constructor(t=null,e=0,i=1,n=0,h=0,l=null){super(l,!0,!1),ke.set(this,void 0),Ce.set(this,void 0),Le.set(this,void 0),this.callback=t,this.setValue(h,!1),s(this,ke,e),s(this,Ce,i),s(this,Le,n),this.vertical=!1}getSliderRect(t,e,i,s){const n=Math.min(this.crossBasis,s),h=e+(s-n)/2;return[t,t+i,h,h+n]}handleEvent(t,e,s,n){if(this.handleClickEvent(t,n,this.getSliderRect(0,0,e,s)),(this.clickStateChanged&&this.wasClick||this.clickState==d.Hold)&&null!==this.pointerPos){const t=this.pointerPos[0];let e=i(this,ke)+t*(i(this,Ce)-i(this,ke));i(this,Le)>0&&(e=Math.round(e/i(this,Le))*i(this,Le)),e<i(this,ke)?e=i(this,ke):e>i(this,Ce)&&(e=i(this,Ce)),this.value=e}return this.clickStateChanged&&(this.dirty=!0),this}handlePreLayoutUpdate(t){this.flexRatio=this.theme.getSize(h.SliderFlexRatio),this.mainBasis=this.theme.getSize(h.SliderMainBasis),this.crossBasis=this.theme.getSize(h.SliderCrossBasis)}handlePainting(t,e,s,n,l){const[r,a,o,u]=this.getSliderRect(t,e,s,n),[c,p]=[a-r,u-o];let g=this.value;null===g&&(g=0);const v=(g-i(this,ke))/(i(this,Ce)-i(this,ke));[d.Hover,d.Hold].includes(this.clickState)?l.fillStyle=this.theme.getFill(h.AccentFill):l.fillStyle=this.theme.getFill(h.PrimaryFill);const f=v*c;l.fillRect(r,o,f,p),l.fillStyle=this.theme.getFill(h.BackgroundFill);const y=c-f;l.fillRect(r+f,o,y,p)}}ke=new WeakMap,Ce=new WeakMap,Le=new WeakMap;class We extends Fe{constructor(t,e){super(t,null),Me.set(this,void 0),s(this,Me,e)}setThemeOverride(t){s(this,Me,t),super.inheritTheme(i(this,Me))}inheritTheme(t){super.inheritTheme(i(this,Me))}}Me=new WeakMap;export{l as Alignment,nt as BackspaceKey,I as BaseContainer,st as BasicKey,ie as BasicTextInput,qt as BoxWidget,H as Button,$t as Center,Xt as Checkbox,d as ClickState,T as Clickable,Gt as Column,Kt as Container,At as DOMKeyboardDriver,Nt as DOMPointerDriver,M as DOMRoot,Et as DOMVirtualKeyboardRoot,se as DebugTheme,t as DefaultTextInputHandler,te as DefaultTextValidator,lt as EnterKey,ht as EscapeKey,x as Event,R as FilledButton,tt as FlexWidget,le as FloatValidator,a as FocusType,ot as GlyphKey,Be as Icon,ae as IntValidator,Ht as KeyEvent,_t as KeyPress,Rt as KeyRelease,pt as KeyRow,Ut as KeyboardDriver,et as Label,z as Labelable,jt as LabelledCheckbox,w as LayoutContext,b as Leave,ne as MakeCompositeValidator,ee as MakeDefaultTextValidatorWithCallback,oe as MakeRangeValidator,Jt as Margin,ct as MultiContainer,ut as MultiParentWidget,P as Parent,W as ParentWidget,Fe as PassthroughWidget,Ot as PointerDriver,B as PointerEvent,zt as PointerMove,D as PointerPress,F as PointerRelease,L as Root,dt as Row,Te as ScrollBar,Pe as ScrollableViewportWidget,rt as ShiftKey,E as SingleParentWidget,Se as Slider,at as SpaceKey,Yt as Spacing,it as TextButton,Zt as TextInput,n as Theme,h as ThemeProperty,We as ThemeScope,Qt as Variable,C as Viewport,De as ViewportWidget,vt as VirtualKeyboard,It as VirtualKeyboardRoot,S as Widget,r as defaultTheme,A as measureTextDims};
